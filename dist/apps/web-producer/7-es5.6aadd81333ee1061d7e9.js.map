{"version":3,"sources":["webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/Subscriber.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/Subscription.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/symbol/iterator.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/symbol/rxSubscriber.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/isArray.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/observable/fromArray.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/pipe.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/subscribeToIterable.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/canReportError.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/subscribeToObservable.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/config.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/identity.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/isArrayLike.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/toSubscriber.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/UnsubscriptionError.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/isObject.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/isScheduler.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/InnerSubscriber.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/OuterSubscriber.js","webpack:///src/app/features/quoting/components/emission/emission.component.html","webpack:///src/app/features/quoting/components/emission/emission.component.ts","webpack:///src/app/features/quoting/components/emission/services/flow-route-emission.service.ts","webpack:///src/app/features/quoting/components/motor/components/others/others.component.html","webpack:///src/app/features/quoting/components/motor/components/others/others.component.ts","webpack:///src/app/features/quoting/components/emission/components/details/details.component.html","webpack:///src/app/features/quoting/components/emission/components/details/details.component.ts","webpack:///src/app/features/quoting/components/emission/components/emission-questions/emission-questions.component.html","webpack:///src/app/features/quoting/components/emission/components/emission-questions/emission-questions.component.ts","webpack:///src/app/features/quoting/components/emission/components/validity/validity.component.html","webpack:///src/app/features/quoting/components/emission/components/validity/validity.component.ts","webpack:///src/app/features/quoting/components/emission/components/paymentmethod/paymentmethod.component.html","webpack:///src/app/features/quoting/components/emission/components/paymentmethod/paymentmethod.component.ts","webpack:///src/app/features/client/components/client-data/client-data.component.html","webpack:///src/app/features/client/components/client-data/client-data.component.ts","webpack:///home/diego/SURA/Portales/node_modules/rxjs/_esm2015/internal/operators/toArray.js","webpack:///src/app/features/client/components/client-residence/client-residence.component.html","webpack:///src/app/features/client/components/client-residence/client-residence.component.ts","webpack:///home/diego/SURA/Portales/node_modules/rxjs/_esm2015/internal/operators/reduce.js","webpack:///src/app/features/client/components/client-tax-condition/client-tax-condition.component.html","webpack:///src/app/features/client/components/client-tax-condition/client-tax-condition.component.ts","webpack:///src/app/features/quoting/components/emission/services/quote.resolver.ts","webpack:///src/app/features/quoting/components/emission/emission-routing.routing.ts","webpack:///src/app/features/quoting/components/emission/emission.module.ts","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/subscribeTo.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/symbol/observable.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/subscribeToResult.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/subscribeToPromise.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/Observable.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/subscribeToArray.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/hostReportError.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/scheduled/scheduleArray.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/Observer.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/isFunction.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/util/isPromise.js","webpack:///home/diego/SURA/Portales/node_modules/rxjs/internal/observable/combineLatest.js"],"names":["extendStatics","__extends","this","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","isFunction_1","Observer_1","Subscription_1","rxSubscriber_1","config_1","hostReportError_1","Subscriber","_super","destinationOrNext","error","complete","_this","call","syncErrorValue","syncErrorThrown","syncErrorThrowable","isStopped","arguments","length","destination","empty","add","SafeSubscriber","rxSubscriber","next","subscriber","value","_next","err","_error","_complete","unsubscribe","closed","_unsubscribeAndRecycle","_parentOrParents","Subscription","exports","_parentSubscriber","observerOrNext","context","isFunction","bind","_context","config","useDeprecatedSynchronousErrorHandling","__tryOrSetError","__tryOrUnsub","hostReportError","wrappedComplete","fn","parent","Error","_unsubscribe","isArray_1","isObject_1","UnsubscriptionError_1","flattenUnsubscriptionErrors","errors","reduce","errs","concat","UnsubscriptionError","_subscriptions","remove","index","e","isArray","len","sub","isObject","push","teardown","subscription","EMPTY","tmp","indexOf","subscriptions","subscriptionIndex","splice","getSymbolIterator","Symbol","iterator","$$iterator","Math","random","$$rxSubscriber","x","Observable_1","subscribeToArray_1","scheduleArray_1","fromArray","input","scheduler","scheduleArray","Observable","subscribeToArray","identity_1","pipeFromArray","fns","identity","prev","pipe","_i","iterator_1","subscribeToIterable","iterable","item","done","Subscriber_1","canReportError","observer","observable_1","subscribeToObservable","obj","obs","observable","subscribe","TypeError","_enable_super_gross_mode_that_will_cause_bad_things","Promise","console","warn","stack","log","isArrayLike","toSubscriber","nextOrObserver","UnsubscriptionErrorImpl","message","map","i","toString","join","name","isScheduler","schedule","InnerSubscriber","outerValue","outerIndex","notifyNext","notifyError","notifyComplete","OuterSubscriber","apply","innerValue","innerIndex","innerSub","EmissionComponent","FlowRouteEmissionService","router","storeQuote","storeEmission","storePolicy","discountService","quotingService","policyAdapter","super","modalCupos","routes","policy","discounts","loadingCosts","newCost","emissionSubscription","policySubscription","discountSubscription","lottieConfig","path","combineLatest","select","visited","dispatch","group","motor","vehicles","find","v","number","packages","selected","data","routerConf","r","forEach","element","dataElement","String","replace","question","show","disabled","shortName","visible","line","debounceTime","tap","switchMap","jobNumberFromQuotes","some","getAvailableDiscounts","job","of","first","res","applied","total","options","backdrop","keyboard","openModal","discount","adapted","adapt","getCosts","catchError","throwError","resp","costVehicles","currentCostVehicle","cv","currentCostPackage","currentPackage","externalid","costs","premiums","closeModal","BaseComponent","nextRouteWithoutValue","filter","split","navigateByUrl","route","OthersMotorComponent","fb","carService","flowRouteEmissionService","patentBlackListService","patentUseService","bondHolderService","loop","autoplay","showGNC","disabledValidate","_CODE_GNC","_CODE_SUMMA_GNC","_CODE_EXPIRATION","hiddenFormPatent","loadingPatent$","Subject","currentBlackList","loadingPatent","buttonLabel","bondHoldersQuotesQuantity","openedModalPatentInUse","maxLength","patentPattern","clientType","params","id","Number","policyQuoteSubscription","take","quote","currentPolicy","currentMotor","c","activeMotor","applyBondHolderFlag","bondholder","type","chasis","driver","clientIsDriver","client","firstname","lastname","_dateFromStoreVigencia","period","start","dateGNC","year","parseInt","substring","month","day","minDateGNC","gncNotRequired","distinctUntilKeyChanged","initializeForms","emissionRoutesSubscription","bondHoldersTypes$","getBondHolders","code","description","approved","approvedEmission","disabledByRetrieve","form","get","disable","formClient","gnc","Validators","required","creditorPrendario","patent","license","pattern","bondHolderType","bondHolderQuotas","quotas","engineNumber","minLength","chassisNumber","driverName","driverLastName","op","jk","gncCov","coverages","ik","valueSumma","terms","_dateFromStore","formGNC","summa","expiration","patchValue","onlySelf","emitEvent","unsubscribeForm","patentInputSubscription","valueChanges","setValue","clearValidators","clientIsDriverCheckSubscription","gncCheckSubscription","openModalNoGNC","expirationInputSubscription","isoDate","Date","toISOString","current","creditorPrendarioInputSubscription","setValidators","updateValueAndValidity","reset","getCar","vehicleData","buttonAnimated","playSegments","setTimeout","checkBlackList","startDatecurrentPolicy","startDate","getDate","getMonth","slice","getFullYear","setMonth","endDate","validePatentInUse","fixedid","openModalPatentInUse","continuePatentValidate","validePatent","blacklist","modalUW","chassis","markAllAsTouched","valid","validatePatent","pkg","enableRoute","toUpperCase","cov","changeRouteTitleValue","aditionalRoute","includes","modalNoGNC","pckCode","animationItem","modalPatentInUse","action","closeModalNoGNC","redirectCoverage","closeModalPatentInUse","closeUWModal","DetailsComponent","producerService","fiscalConditionService","notificationService","quoteIssueAdapter","paymentMethodService","paymentPlansService","producerStore","storeProducer","child_component","uwEmision","vehicleDetails","modalEditCoverage","packageSelected","mechanicalAssistance","isFromRetrieve","fromRetrieve","issueError$","subject","loadingIssue$","loadingFromRetrieve$","vehicles$","packageSelectedWithAssistance$","brandModelPrizeCar$","rebillingPeriod$","fiscalCondition$","additionals$","discountAndCommission$","campaign$","installments$","payment$","formsValid$","expandedDetail","getQuoteApproved","paymentMethod$","paymentPlan$","emissionStoreSubscription","emissionStoreSubscriptionRetrieve","policyStoreProducerSubscription","producerServiceSubscription","policyStoreSubscription","producerStoreSubscription","isApprovedEmission","formCampaign","FormControl","updateCostSubscription","producerSubscription","currentproducer","documentNumber","store","producer","getProfile","f","payment","paymentValidation","PaymentValidations","completeModel","validatePayment","pk","assistance","currentCost","package","cost","additionalsLenght","additionals","additionalsList","startsWith","category","brand","model","prize","statedamount","statementamount","periodMethod","method","getAllFiscalCondition","fiscalCondition","fiscalcondition","commission","campaign","paymentTerm","maximumnumberofinstallments","share","emission","getAllPaymentMethods","ps","getAllPaymentPlans","end","pp","currentPlan","plan","issuePolicy","emitPolicy","issueSuccess","issueError","reasonClose","currentCode","a","VehicleNumber","closeVehicleDetails","inspection","status","policynumber","zerokm","UNDERWRITER","notify","vehicle","currentAssistance","additionalsGroups","additionalExcludeCodes","ad","checkUW","goQuote","EmissionQuestionsComponent","routeActive","event","ValidityComponent","isLessThatToday$","retroactiveVigence","formValidaty","beginningValidity","today","moment","date","momentTodayForMinDate","subtract","momentTodayForMaxDate","minDate","maxDate","dateFromStore","dateForInput","rebillingMonths","rebillingCode","_date","toDateString","momentDate","diff","periodData","format","disabledByRetrieve$","onEnter","PaymentMethodComponent","paymentInstrument","activeTab","arrPaymentMethods","formDebit","formCredit","arrCardsStored","paymentInstruments$","paymentMethods$","activePaymentMethodId","newPaymentWay","digitalPolicy","initSlice","endSlice","arrayCardsLength","arrayCbusLength","expirationDateMask","numberMask","paymentSelectedByRetrieve","currentServerDate","disabledByRetrieveSubscription","serverDataSubscription","paymentDataSubscription","paymentTermSubscription","policyDataSubscription","creditCardSubscription","cardExpirationSubcription","debitCardSubscription","email","hj","legend","accountnumber","getPaymentInstruments","u","o","expirationdate","owner","getCreditCards","cc","creditcard","_expirationDate","dateServer","cbu","conduit","pi","setPaymentMethod","tab","displayname","lastIndexOf","expirationCard","toLowerCase","trim","cbuNumber","match","exec","array","lengthArray","img","target","src","height","ClientDataComponent","genderService","identificationService","accountService","nationalityService","maritalStatusService","_clientNService","utilService","contactService","provinceService","suraLoaderConfig","documentSelect","modalClient","modalNoClient","modalMobility","modalNewCosts","accounts","disabledFields","fiscalConditions$","iibb$","isValidateDocument","client$","clientFromEmission$","searchClient$","isLegalPerson","loadingData","formPhysicalPerson","formLegalPerson","genders$","maritalStatus$","documents$","nationalities$","documentDescription","currentAccount","showForms","clientBaseN$","accountReset","accountResetSubscription","provincesFromApi","resetResidenceValues","state","city","postalcode","street","streetnumber","apartment","floor","clarification","hasMobility","MOBILITY_CODE","newQuote","callCostsSubscription","motorConfig","snapshot","getAllProvinces","provs","getCurrentServerDate","currentDate","datetime","currentDateForMinDateTime","maxDateClient","minDateTime","minDateClient","initState","getGenders","getMaritalStatus","currentPkg","document","documentType","getDocumentTypes","getNationalities","nationatiliesFromServer","argentino","g","j","birth","nationality","maritalstatus","gender","prefix","phone","exposedPerson","_birthDate","companyname","consortium","officialorganism","cellphone","area","politicallyexposed","openModalMobility","workphone","checkClienteN","address","insured","requestAccount","officialid","requestContact","getAccounts","getContacts","fromAccount","fromContact","typePerson","primaryaddress","fromContactAddress","_address","openModalNoClient","officialId","validateClientN","ctl","blackList","officialids","primary","formData","getRawValue","contactid","workPhone","vhc","vehicleType","newCosts","externalId","productcode","newPackage","costVehicle","invoice","parseFloat","toFixed","validateDocumentNumber","animationCreated","closeModalNoClient","closeModalMobility","continueIsLegalPerson","closeModalNewCosts","toArrayReducer","arr","ClientResidenceComponent","locationService","_addressTypeService","zipCode","formClientResidence","provinces$","policyclientaddress$","primaryClientAddress$","provinceDescription","locations$","residences$","addressType$","defaultAddressType","dataByPostalCodeSubscriber","dataByPostalCode$","arrProvinces","addressIdSelected","filledQuestion","loadingPostalCode","clientIsEditable","getClientFromStore$","editable","getAddressType","ty","loadAddressSave","idd","arrayAddress","addAddress","selectAddress","getLocations","province","validatePostalCode","callCost","getLocationAndProvince","locations","zx","groupBy","mergeMap","key","accumulator","seed","source","scan","takeLast","defaultIfEmpty","acc","distinctCodes","from","Set","codeProvince","zg","ClientTaxConditionComponent","fiscalService","iibbService","fiscalConditionSelect","iibbSelect","modalFiscal","formClienTax","arrayFiscalCondition","clientData","firstTimeFiscalCondition","showCertified","showIIBB","showiibbNumber","firstTimeFiscalConditionChangeValue","CONSUMIDOR_FINAL","NORESPONSABLE","arrCondFiscalOriginal","currentTime","now","iibb","iibbNumber","endingValidity","getAllCrudIncome","xa","itemsFiscalConditionMandatory","itemsFiscalCondition","arrayConditionFiscal","noCode","afc","activateCertifiedDates","activateIIBB","activateIIBBnumber","fiscalConditionForm","iibbType","acf","dateInit","updateCrudIncomeType","getValue","updateConditionFiscal","certificate","_dateInitFromStore","_dateInit","_dateEndFromStore","_dateEnd","iibbSavedContinue","iibbNumberSavedContinue","dateEnd","isoDatebeginningValidity","isoDateendingValidity","iibbDescription","QuoteResolver","EmissionRoutingModule","quotesService","serverDate","jobFromPolicy","jobFromEmission","getQuote","retrieve","fillPolicyAttributes","getAccountInfo","alias","populatePeriod","fleet","sort","abs","findVehicleGroup","originalcostnew","finish","firstinstallmentdue","pkgDescription","pkgs","rej","account","addresses","conf","types","methodName","methodMonths","toDate","clone","rate","component","resolve","children","forChild","forFeature","playerFactory","EmissionModule","GenderService","IdentificationService","DocumentationService","AccountService","NationalityService","PeriodMethodPipe","CardNumberPipe","AddressTypeService","MaritalStatusService","ClienteNService","PatentBlackListService","QuotesService","PatentUseService","BondholderService","forRoot","player","subscribeToPromise_1","subscribeToIterable_1","subscribeToObservable_1","isArrayLike_1","isPromise_1","subscribeTo","result","isPromise","subscribeToPromise","InnerSubscriber_1","subscribeTo_1","subscribeToResult","outerSubscriber","innerSubscriber","promise","then","canReportError_1","toSubscriber_1","pipe_1","getPromiseCtor","promiseCtor","_isScalar","_subscribe","lift","operator","sink","_trySubscribe","reject","operations","toPromise","isScheduler_1","OuterSubscriber_1","subscribeToResult_1","fromArray_1","NONE","observables","resultSelector","pop","CombineLatestOperator","CombineLatestSubscriber","active","values","toRespond","unused","_tryResultSelector"],"mappings":"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yCACE,0CACE,qC,qCAMF,8BAEA,2CACE,2CAA2B,0BAAiC,8BAC5D,2CACE,0BACF,8BACF,8BACF,8BACF,8BACF,+B,oDAfU,2KAQyB,8GAEzB,0H,sBAyIA,0CAIE,0CACE,uCAMA,uCACA,4CACE,gDACF,8BACF,8BACF,+B,sBACA,0CACE,0CACE,uCAMA,uCACA,4CACE,iCACF,8BACF,8BACF,+B,yBAKF,0CACE,0CACE,0CACE,0CACE,yCAAO,sDAA0B,8BACjC,4C,iCAaF,8BACF,8BACA,0CACE,yCACE,qCACA,wCAAK,8BAAC,8BACR,8BACA,6CAaF,8BACF,8BACF,+B,2CAxCiC,uDAOvB,mHAAmC,cAAnC,CAAmC,iBAoBrC,2FAAmC,cAAnC,CAAmC,kB,iEAiB3C,0CAUE,0CACE,kDAGE,0IAOD,8BACH,8BACA,0CACE,kDAGE,0IAOD,8BACH,8BACF,8B,8CAnCE,uDAA2B,0BAgBvB,yEAaA,0E,iEAUN,0CAME,0CACE,kDAGE,0IAOD,8BACH,8BACA,0CACE,yDAIE,0IAED,8BACH,8BACF,8B,8CA3BE,uDAA2B,uBAWvB,qEAAiB,oCASjB,+E,iEA/Qd,0CACE,0CAKE,yCACE,0CACE,yCACE,0CACE,2CACE,qC,qCAKF,8BACF,8BACF,8BACA,yCACE,2CACE,4CACE,0BAEF,8BACF,8BACF,8BACA,0CACE,2CACE,4CACE,0BACF,8BACF,8BACF,8BACA,0CACE,2CACE,4CACE,0BACF,8BACF,8BACF,8BACF,8BAEA,2CACE,2CACE,2CACE,mDAKE,8IAGD,8BACH,8BACA,2CAEE,8CAQE,yIAEA,iDAGE,wJAID,8BACD,6CACE,0BACF,8BAEF,8BACF,8BACF,8BACA,2CACE,2CACE,mDAGE,0IAOD,8BACH,8BACA,2CACE,mDAGE,0IAOD,8BACH,8BACF,8BAGA,2CACE,2CACE,2CACE,wCAMA,wCAIA,6CACE,iDACF,8BACF,8BACF,8BACA,6CAiBA,6CAcF,8BAIA,8CA4CA,8CAwCA,8CAgCA,2CACE,2CACE,yCACE,8CAQE,mIAKA,wCACF,8BACF,8BACA,4CACE,+C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B,oCAgdSvC,GACZ,IAAMmF,EAA0CnF,EAAMoF,OACtDD,EAAIE,IAAM,oCACVF,EAAIG,OAAS,OAndV,GAAqC,EAAA3W,gB,oCAA/B+S,IAAsB,gR,oDAAtBA,GAAsB,w7EDhDnC,2CACE,yCACE,yCACE,2C,iCAiCF,8BACF,8BACA,4C,iCA2KA,yCACE,6CA2CA,8CA6BF,8BACA,0CACE,0CAeE,2CACE,2EACF,8BACF,8BACF,8BACF,+B,MA3SQ,gHAiCwB,oHA8K1B,0GA2CA,6G,4mEE1KJ,uC,uBAwNM,2CAQE,qCAAG,8FAA4D,8BACjE,+B,iEA9NN,0CAOE,yCACE,yCACE,yCACE,oCACA,uCAAK,6BAAC,8BACR,8BACF,8BACA,0CACE,yCACE,sCACA,wCAAK,8BAAC,8BACR,8BACF,8BACA,2CACE,0CACE,kDACA,wCAAK,8BAAC,8BACR,8BACF,8BACF,8BACA,0CACE,2CACE,8C,oEAYF,8BACA,2CACE,8C,kCAWF,8BACA,2CACE,qD,kCASF,8BACF,8BACA,0CACE,0CACE,0CACE,2CACA,wCAAK,8BAAC,8BACR,8BACF,8BACA,2CACE,0CACE,2CACA,wCAAK,8BAAC,8BACR,8BACF,8BACA,2CACE,0CACE,mCACA,wCAAK,8BAAC,8BACR,8BACF,8BACF,8BACA,0CACE,2CACE,6C,kCAcF,8BACA,2CACE,6C,kCAcF,8BACA,2CACE,6C,kCAcF,8BACF,8BACA,0CACE,2CACE,0CACE,8CACA,wCAAK,8BAAC,8BACR,8BACF,8BACA,0CACE,0CACE,0CACA,wCAAK,8BAAC,8BACR,8BACF,8BACA,2CACE,0CACE,mCACA,wCAAK,8BAAC,8BACR,8BACF,8BACF,8BACA,0CACE,2CACE,8C,kCAgBF,8BACA,2CACE,8C,kCAkBF,8BACA,2CACE,8C,kCAgBA,+CAUF,8BACA,2CACE,2CACE,4CAIE,wCAQA,wCACA,6CACE,6DACF,8BACF,8BACF,8BACF,8BACF,8BACA,0CACE,2CACE,yCACE,8CAGE,mIAGA,wCACF,8BACF,8BACF,8BACF,8BACF,8B,4/BAnQE,4DA8BM,qEAA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","file":"x","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar isFunction_1 = require(\"./util/isFunction\");\nvar Observer_1 = require(\"./Observer\");\nvar Subscription_1 = require(\"./Subscription\");\nvar rxSubscriber_1 = require(\"../internal/symbol/rxSubscriber\");\nvar config_1 = require(\"./config\");\nvar hostReportError_1 = require(\"./util/hostReportError\");\nvar Subscriber = (function (_super) {\n    __extends(Subscriber, _super);\n    function Subscriber(destinationOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        _this.syncErrorValue = null;\n        _this.syncErrorThrown = false;\n        _this.syncErrorThrowable = false;\n        _this.isStopped = false;\n        switch (arguments.length) {\n            case 0:\n                _this.destination = Observer_1.empty;\n                break;\n            case 1:\n                if (!destinationOrNext) {\n                    _this.destination = Observer_1.empty;\n                    break;\n                }\n                if (typeof destinationOrNext === 'object') {\n                    if (destinationOrNext instanceof Subscriber) {\n                        _this.syncErrorThrowable = destinationOrNext.syncErrorThrowable;\n                        _this.destination = destinationOrNext;\n                        destinationOrNext.add(_this);\n                    }\n                    else {\n                        _this.syncErrorThrowable = true;\n                        _this.destination = new SafeSubscriber(_this, destinationOrNext);\n                    }\n                    break;\n                }\n            default:\n                _this.syncErrorThrowable = true;\n                _this.destination = new SafeSubscriber(_this, destinationOrNext, error, complete);\n                break;\n        }\n        return _this;\n    }\n    Subscriber.prototype[rxSubscriber_1.rxSubscriber] = function () { return this; };\n    Subscriber.create = function (next, error, complete) {\n        var subscriber = new Subscriber(next, error, complete);\n        subscriber.syncErrorThrowable = false;\n        return subscriber;\n    };\n    Subscriber.prototype.next = function (value) {\n        if (!this.isStopped) {\n            this._next(value);\n        }\n    };\n    Subscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            this.isStopped = true;\n            this._error(err);\n        }\n    };\n    Subscriber.prototype.complete = function () {\n        if (!this.isStopped) {\n            this.isStopped = true;\n            this._complete();\n        }\n    };\n    Subscriber.prototype.unsubscribe = function () {\n        if (this.closed) {\n            return;\n        }\n        this.isStopped = true;\n        _super.prototype.unsubscribe.call(this);\n    };\n    Subscriber.prototype._next = function (value) {\n        this.destination.next(value);\n    };\n    Subscriber.prototype._error = function (err) {\n        this.destination.error(err);\n        this.unsubscribe();\n    };\n    Subscriber.prototype._complete = function () {\n        this.destination.complete();\n        this.unsubscribe();\n    };\n    Subscriber.prototype._unsubscribeAndRecycle = function () {\n        var _parentOrParents = this._parentOrParents;\n        this._parentOrParents = null;\n        this.unsubscribe();\n        this.closed = false;\n        this.isStopped = false;\n        this._parentOrParents = _parentOrParents;\n        return this;\n    };\n    return Subscriber;\n}(Subscription_1.Subscription));\nexports.Subscriber = Subscriber;\nvar SafeSubscriber = (function (_super) {\n    __extends(SafeSubscriber, _super);\n    function SafeSubscriber(_parentSubscriber, observerOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        _this._parentSubscriber = _parentSubscriber;\n        var next;\n        var context = _this;\n        if (isFunction_1.isFunction(observerOrNext)) {\n            next = observerOrNext;\n        }\n        else if (observerOrNext) {\n            next = observerOrNext.next;\n            error = observerOrNext.error;\n            complete = observerOrNext.complete;\n            if (observerOrNext !== Observer_1.empty) {\n                context = Object.create(observerOrNext);\n                if (isFunction_1.isFunction(context.unsubscribe)) {\n                    _this.add(context.unsubscribe.bind(context));\n                }\n                context.unsubscribe = _this.unsubscribe.bind(_this);\n            }\n        }\n        _this._context = context;\n        _this._next = next;\n        _this._error = error;\n        _this._complete = complete;\n        return _this;\n    }\n    SafeSubscriber.prototype.next = function (value) {\n        if (!this.isStopped && this._next) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (!config_1.config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n                this.__tryOrUnsub(this._next, value);\n            }\n            else if (this.__tryOrSetError(_parentSubscriber, this._next, value)) {\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            var _parentSubscriber = this._parentSubscriber;\n            var useDeprecatedSynchronousErrorHandling = config_1.config.useDeprecatedSynchronousErrorHandling;\n            if (this._error) {\n                if (!useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n                    this.__tryOrUnsub(this._error, err);\n                    this.unsubscribe();\n                }\n                else {\n                    this.__tryOrSetError(_parentSubscriber, this._error, err);\n                    this.unsubscribe();\n                }\n            }\n            else if (!_parentSubscriber.syncErrorThrowable) {\n                this.unsubscribe();\n                if (useDeprecatedSynchronousErrorHandling) {\n                    throw err;\n                }\n                hostReportError_1.hostReportError(err);\n            }\n            else {\n                if (useDeprecatedSynchronousErrorHandling) {\n                    _parentSubscriber.syncErrorValue = err;\n                    _parentSubscriber.syncErrorThrown = true;\n                }\n                else {\n                    hostReportError_1.hostReportError(err);\n                }\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.complete = function () {\n        var _this = this;\n        if (!this.isStopped) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (this._complete) {\n                var wrappedComplete = function () { return _this._complete.call(_this._context); };\n                if (!config_1.config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n                    this.__tryOrUnsub(wrappedComplete);\n                    this.unsubscribe();\n                }\n                else {\n                    this.__tryOrSetError(_parentSubscriber, wrappedComplete);\n                    this.unsubscribe();\n                }\n            }\n            else {\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.__tryOrUnsub = function (fn, value) {\n        try {\n            fn.call(this._context, value);\n        }\n        catch (err) {\n            this.unsubscribe();\n            if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n                throw err;\n            }\n            else {\n                hostReportError_1.hostReportError(err);\n            }\n        }\n    };\n    SafeSubscriber.prototype.__tryOrSetError = function (parent, fn, value) {\n        if (!config_1.config.useDeprecatedSynchronousErrorHandling) {\n            throw new Error('bad call');\n        }\n        try {\n            fn.call(this._context, value);\n        }\n        catch (err) {\n            if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n                parent.syncErrorValue = err;\n                parent.syncErrorThrown = true;\n                return true;\n            }\n            else {\n                hostReportError_1.hostReportError(err);\n                return true;\n            }\n        }\n        return false;\n    };\n    SafeSubscriber.prototype._unsubscribe = function () {\n        var _parentSubscriber = this._parentSubscriber;\n        this._context = null;\n        this._parentSubscriber = null;\n        _parentSubscriber.unsubscribe();\n    };\n    return SafeSubscriber;\n}(Subscriber));\nexports.SafeSubscriber = SafeSubscriber;\n//# sourceMappingURL=Subscriber.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar isArray_1 = require(\"./util/isArray\");\nvar isObject_1 = require(\"./util/isObject\");\nvar isFunction_1 = require(\"./util/isFunction\");\nvar UnsubscriptionError_1 = require(\"./util/UnsubscriptionError\");\nvar Subscription = (function () {\n    function Subscription(unsubscribe) {\n        this.closed = false;\n        this._parentOrParents = null;\n        this._subscriptions = null;\n        if (unsubscribe) {\n            this._unsubscribe = unsubscribe;\n        }\n    }\n    Subscription.prototype.unsubscribe = function () {\n        var errors;\n        if (this.closed) {\n            return;\n        }\n        var _a = this, _parentOrParents = _a._parentOrParents, _unsubscribe = _a._unsubscribe, _subscriptions = _a._subscriptions;\n        this.closed = true;\n        this._parentOrParents = null;\n        this._subscriptions = null;\n        if (_parentOrParents instanceof Subscription) {\n            _parentOrParents.remove(this);\n        }\n        else if (_parentOrParents !== null) {\n            for (var index = 0; index < _parentOrParents.length; ++index) {\n                var parent_1 = _parentOrParents[index];\n                parent_1.remove(this);\n            }\n        }\n        if (isFunction_1.isFunction(_unsubscribe)) {\n            try {\n                _unsubscribe.call(this);\n            }\n            catch (e) {\n                errors = e instanceof UnsubscriptionError_1.UnsubscriptionError ? flattenUnsubscriptionErrors(e.errors) : [e];\n            }\n        }\n        if (isArray_1.isArray(_subscriptions)) {\n            var index = -1;\n            var len = _subscriptions.length;\n            while (++index < len) {\n                var sub = _subscriptions[index];\n                if (isObject_1.isObject(sub)) {\n                    try {\n                        sub.unsubscribe();\n                    }\n                    catch (e) {\n                        errors = errors || [];\n                        if (e instanceof UnsubscriptionError_1.UnsubscriptionError) {\n                            errors = errors.concat(flattenUnsubscriptionErrors(e.errors));\n                        }\n                        else {\n                            errors.push(e);\n                        }\n                    }\n                }\n            }\n        }\n        if (errors) {\n            throw new UnsubscriptionError_1.UnsubscriptionError(errors);\n        }\n    };\n    Subscription.prototype.add = function (teardown) {\n        var subscription = teardown;\n        if (!teardown) {\n            return Subscription.EMPTY;\n        }\n        switch (typeof teardown) {\n            case 'function':\n                subscription = new Subscription(teardown);\n            case 'object':\n                if (subscription === this || subscription.closed || typeof subscription.unsubscribe !== 'function') {\n                    return subscription;\n                }\n                else if (this.closed) {\n                    subscription.unsubscribe();\n                    return subscription;\n                }\n                else if (!(subscription instanceof Subscription)) {\n                    var tmp = subscription;\n                    subscription = new Subscription();\n                    subscription._subscriptions = [tmp];\n                }\n                break;\n            default: {\n                throw new Error('unrecognized teardown ' + teardown + ' added to Subscription.');\n            }\n        }\n        var _parentOrParents = subscription._parentOrParents;\n        if (_parentOrParents === null) {\n            subscription._parentOrParents = this;\n        }\n        else if (_parentOrParents instanceof Subscription) {\n            if (_parentOrParents === this) {\n                return subscription;\n            }\n            subscription._parentOrParents = [_parentOrParents, this];\n        }\n        else if (_parentOrParents.indexOf(this) === -1) {\n            _parentOrParents.push(this);\n        }\n        else {\n            return subscription;\n        }\n        var subscriptions = this._subscriptions;\n        if (subscriptions === null) {\n            this._subscriptions = [subscription];\n        }\n        else {\n            subscriptions.push(subscription);\n        }\n        return subscription;\n    };\n    Subscription.prototype.remove = function (subscription) {\n        var subscriptions = this._subscriptions;\n        if (subscriptions) {\n            var subscriptionIndex = subscriptions.indexOf(subscription);\n            if (subscriptionIndex !== -1) {\n                subscriptions.splice(subscriptionIndex, 1);\n            }\n        }\n    };\n    Subscription.EMPTY = (function (empty) {\n        empty.closed = true;\n        return empty;\n    }(new Subscription()));\n    return Subscription;\n}());\nexports.Subscription = Subscription;\nfunction flattenUnsubscriptionErrors(errors) {\n    return errors.reduce(function (errs, err) { return errs.concat((err instanceof UnsubscriptionError_1.UnsubscriptionError) ? err.errors : err); }, []);\n}\n//# sourceMappingURL=Subscription.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction getSymbolIterator() {\n    if (typeof Symbol !== 'function' || !Symbol.iterator) {\n        return '@@iterator';\n    }\n    return Symbol.iterator;\n}\nexports.getSymbolIterator = getSymbolIterator;\nexports.iterator = getSymbolIterator();\nexports.$$iterator = exports.iterator;\n//# sourceMappingURL=iterator.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.rxSubscriber = (function () {\n    return typeof Symbol === 'function'\n        ? Symbol('rxSubscriber')\n        : '@@rxSubscriber_' + Math.random();\n})();\nexports.$$rxSubscriber = exports.rxSubscriber;\n//# sourceMappingURL=rxSubscriber.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isArray = (function () { return Array.isArray || (function (x) { return x && typeof x.length === 'number'; }); })();\n//# sourceMappingURL=isArray.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Observable_1 = require(\"../Observable\");\nvar subscribeToArray_1 = require(\"../util/subscribeToArray\");\nvar scheduleArray_1 = require(\"../scheduled/scheduleArray\");\nfunction fromArray(input, scheduler) {\n    if (!scheduler) {\n        return new Observable_1.Observable(subscribeToArray_1.subscribeToArray(input));\n    }\n    else {\n        return scheduleArray_1.scheduleArray(input, scheduler);\n    }\n}\nexports.fromArray = fromArray;\n//# sourceMappingURL=fromArray.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar identity_1 = require(\"./identity\");\nfunction pipe() {\n    var fns = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        fns[_i] = arguments[_i];\n    }\n    return pipeFromArray(fns);\n}\nexports.pipe = pipe;\nfunction pipeFromArray(fns) {\n    if (fns.length === 0) {\n        return identity_1.identity;\n    }\n    if (fns.length === 1) {\n        return fns[0];\n    }\n    return function piped(input) {\n        return fns.reduce(function (prev, fn) { return fn(prev); }, input);\n    };\n}\nexports.pipeFromArray = pipeFromArray;\n//# sourceMappingURL=pipe.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar iterator_1 = require(\"../symbol/iterator\");\nexports.subscribeToIterable = function (iterable) { return function (subscriber) {\n    var iterator = iterable[iterator_1.iterator]();\n    do {\n        var item = void 0;\n        try {\n            item = iterator.next();\n        }\n        catch (err) {\n            subscriber.error(err);\n            return subscriber;\n        }\n        if (item.done) {\n            subscriber.complete();\n            break;\n        }\n        subscriber.next(item.value);\n        if (subscriber.closed) {\n            break;\n        }\n    } while (true);\n    if (typeof iterator.return === 'function') {\n        subscriber.add(function () {\n            if (iterator.return) {\n                iterator.return();\n            }\n        });\n    }\n    return subscriber;\n}; };\n//# sourceMappingURL=subscribeToIterable.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Subscriber_1 = require(\"../Subscriber\");\nfunction canReportError(observer) {\n    while (observer) {\n        var _a = observer, closed_1 = _a.closed, destination = _a.destination, isStopped = _a.isStopped;\n        if (closed_1 || isStopped) {\n            return false;\n        }\n        else if (destination && destination instanceof Subscriber_1.Subscriber) {\n            observer = destination;\n        }\n        else {\n            observer = null;\n        }\n    }\n    return true;\n}\nexports.canReportError = canReportError;\n//# sourceMappingURL=canReportError.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar observable_1 = require(\"../symbol/observable\");\nexports.subscribeToObservable = function (obj) { return function (subscriber) {\n    var obs = obj[observable_1.observable]();\n    if (typeof obs.subscribe !== 'function') {\n        throw new TypeError('Provided object does not correctly implement Symbol.observable');\n    }\n    else {\n        return obs.subscribe(subscriber);\n    }\n}; };\n//# sourceMappingURL=subscribeToObservable.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar _enable_super_gross_mode_that_will_cause_bad_things = false;\nexports.config = {\n    Promise: undefined,\n    set useDeprecatedSynchronousErrorHandling(value) {\n        if (value) {\n            var error = new Error();\n            console.warn('DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \\n' + error.stack);\n        }\n        else if (_enable_super_gross_mode_that_will_cause_bad_things) {\n            console.log('RxJS: Back to a better error behavior. Thank you. <3');\n        }\n        _enable_super_gross_mode_that_will_cause_bad_things = value;\n    },\n    get useDeprecatedSynchronousErrorHandling() {\n        return _enable_super_gross_mode_that_will_cause_bad_things;\n    },\n};\n//# sourceMappingURL=config.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction identity(x) {\n    return x;\n}\nexports.identity = identity;\n//# sourceMappingURL=identity.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isArrayLike = (function (x) { return x && typeof x.length === 'number' && typeof x !== 'function'; });\n//# sourceMappingURL=isArrayLike.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Subscriber_1 = require(\"../Subscriber\");\nvar rxSubscriber_1 = require(\"../symbol/rxSubscriber\");\nvar Observer_1 = require(\"../Observer\");\nfunction toSubscriber(nextOrObserver, error, complete) {\n    if (nextOrObserver) {\n        if (nextOrObserver instanceof Subscriber_1.Subscriber) {\n            return nextOrObserver;\n        }\n        if (nextOrObserver[rxSubscriber_1.rxSubscriber]) {\n            return nextOrObserver[rxSubscriber_1.rxSubscriber]();\n        }\n    }\n    if (!nextOrObserver && !error && !complete) {\n        return new Subscriber_1.Subscriber(Observer_1.empty);\n    }\n    return new Subscriber_1.Subscriber(nextOrObserver, error, complete);\n}\nexports.toSubscriber = toSubscriber;\n//# sourceMappingURL=toSubscriber.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar UnsubscriptionErrorImpl = (function () {\n    function UnsubscriptionErrorImpl(errors) {\n        Error.call(this);\n        this.message = errors ?\n            errors.length + \" errors occurred during unsubscription:\\n\" + errors.map(function (err, i) { return i + 1 + \") \" + err.toString(); }).join('\\n  ') : '';\n        this.name = 'UnsubscriptionError';\n        this.errors = errors;\n        return this;\n    }\n    UnsubscriptionErrorImpl.prototype = Object.create(Error.prototype);\n    return UnsubscriptionErrorImpl;\n})();\nexports.UnsubscriptionError = UnsubscriptionErrorImpl;\n//# sourceMappingURL=UnsubscriptionError.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction isObject(x) {\n    return x !== null && typeof x === 'object';\n}\nexports.isObject = isObject;\n//# sourceMappingURL=isObject.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction isScheduler(value) {\n    return value && typeof value.schedule === 'function';\n}\nexports.isScheduler = isScheduler;\n//# sourceMappingURL=isScheduler.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Subscriber_1 = require(\"./Subscriber\");\nvar InnerSubscriber = (function (_super) {\n    __extends(InnerSubscriber, _super);\n    function InnerSubscriber(parent, outerValue, outerIndex) {\n        var _this = _super.call(this) || this;\n        _this.parent = parent;\n        _this.outerValue = outerValue;\n        _this.outerIndex = outerIndex;\n        _this.index = 0;\n        return _this;\n    }\n    InnerSubscriber.prototype._next = function (value) {\n        this.parent.notifyNext(this.outerValue, value, this.outerIndex, this.index++, this);\n    };\n    InnerSubscriber.prototype._error = function (error) {\n        this.parent.notifyError(error, this);\n        this.unsubscribe();\n    };\n    InnerSubscriber.prototype._complete = function () {\n        this.parent.notifyComplete(this);\n        this.unsubscribe();\n    };\n    return InnerSubscriber;\n}(Subscriber_1.Subscriber));\nexports.InnerSubscriber = InnerSubscriber;\n//# sourceMappingURL=InnerSubscriber.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Subscriber_1 = require(\"./Subscriber\");\nvar OuterSubscriber = (function (_super) {\n    __extends(OuterSubscriber, _super);\n    function OuterSubscriber() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    OuterSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        this.destination.next(innerValue);\n    };\n    OuterSubscriber.prototype.notifyError = function (error, innerSub) {\n        this.destination.error(error);\n    };\n    OuterSubscriber.prototype.notifyComplete = function (innerSub) {\n        this.destination.complete();\n    };\n    return OuterSubscriber;\n}(Subscriber_1.Subscriber));\nexports.OuterSubscriber = OuterSubscriber;\n//# sourceMappingURL=OuterSubscriber.js.map","<router-outlet></router-outlet>\n\n<sxf-modal #modalCupos>\n  <div class=\"modal-header modal-header-items\">\n    <h4 class=\"modal-title\" id=\"modal-basic-title\">\n      {{ loadingCosts ? 'Recotizando' : 'Descuento comercial no disponible' }}\n    </h4>\n  </div>\n  <div class=\"modal-body modal-body-items\">\n    <h3\n      *ngIf=\"!loadingCosts; else stillLoadingCost\"\n      style=\"padding-top: 1.5rem;\"\n    >\n      El cupón de descuento aplicado en la cotización no se encuentra disponible\n      actualmente.\n    </h3>\n  </div>\n\n  <div *ngIf=\"!loadingCosts\" class=\"modal-footer\">\n    <div class=\"row\">\n      <div class=\"col-lg-4 offset-lg-8 pl-0\">\n        <button\n          type=\"button\"\n          class=\"btn btn-primary btn-lg btn-block\"\n          (click)=\"callCostWithoutDiscounts()\"\n          [disabled]=\"loadingCosts\"\n        >\n          Recotizar\n        </button>\n      </div>\n    </div>\n  </div>\n</sxf-modal>\n\n<ng-template #stillLoadingCost>\n  <div class=\"row\" style=\"padding: 1rem 0;\">\n    <div class=\"col-12 text-center\">\n      <ng-lottie\n        [options]=\"lottieConfig\"\n        width=\"8.75rem\"\n        height=\"6.25rem\"\n      ></ng-lottie>\n    </div>\n  </div>\n</ng-template>\n","import {\n  Component,\n  OnInit,\n  ChangeDetectionStrategy,\n  OnDestroy,\n  ViewChild\n} from '@angular/core';\nimport { BaseComponent } from '@sura-platform/core';\nimport { Router, Route } from '@angular/router';\nimport { Store } from '@ngrx/store';\nimport * as fromQuote from '../quote/state/index';\nimport * as fromQuoteActions from '../quote/state/quote.actions';\nimport * as fromEmissionReducer from './state/emission.reducer';\nimport * as fromEmissionActions from './state/emission.actions';\nimport * as fromEmission from './state';\nimport * as fromPolicyActions from '../../state/policy/policy.actions';\nimport * as fromPolicy from '../../state/policy';\nimport { IRoutes } from '@sura-platform/web/core/models/question/routes.interface';\nimport {\n  DiscountService,\n  IDiscount,\n  QuotingService,\n  IPolicy,\n  IVehicle,\n  IPackage\n} from '@sura-platform/features';\nimport { ModalComponent } from '@sura-platform/web';\nimport { AnimationOptions } from 'ngx-lottie';\nimport { Subscription, of, combineLatest, throwError } from 'rxjs';\nimport {\n  switchMap,\n  tap,\n  first,\n  catchError,\n  debounceTime\n} from 'rxjs/operators';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { PolicyAdapter } from '../../adapters/policy.adapter';\n\n@Component({\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  selector: 'sxf-emission',\n  templateUrl: './emission.component.html',\n  styleUrls: ['./emission.component.scss']\n})\nexport class EmissionComponent extends BaseComponent\n  implements OnInit, OnDestroy {\n  @ViewChild('modalCupos') modalCupos: ModalComponent = <ModalComponent>{};\n\n  /**\n   * Current routes\n   */\n  routes: IRoutes[] = [];\n\n  /**\n   * Current policy\n   */\n  policy: IPolicy = <IPolicy>{};\n\n  /**\n   * Discounts to be modified to get new costs\n   */\n  discounts: IDiscount[] = [];\n\n  /**\n   * Flag used to check if costs request is loading\n   */\n  loadingCosts = false;\n\n  /**\n   * Flag used to detect if the quote has new costs\n   */\n  newCost = false;\n\n  emissionSubscription: Subscription = new Subscription();\n  policySubscription: Subscription = new Subscription();\n  discountSubscription: Subscription = new Subscription();\n\n  lottieConfig: AnimationOptions = {\n    path: '/assets/loadings/sura-loader.json'\n  };\n\n  constructor(\n    private router: Router,\n    private storeQuote: Store<fromQuote.State>,\n    private storeEmission: Store<fromEmissionReducer.EmissionState>,\n    private storePolicy: Store<fromPolicy.State>,\n    private discountService: DiscountService,\n    private quotingService: QuotingService,\n    private policyAdapter: PolicyAdapter\n  ) {\n    super();\n  }\n\n  ngOnInit() {\n    combineLatest([\n      this.storeEmission.select(fromEmission.getEmissionHasVisited),\n      this.storePolicy.select(fromPolicy.getPolicyData)\n    ])\n      .subscribe(([visited, policy]) => {\n        if (!visited) {\n          this.storeQuote.dispatch(\n            new fromQuoteActions.SetCurrentMotorAction(1)\n          );\n\n          const group = policy?.motor?.vehicles\n            ?.find((v) => v.number === 1)\n            ?.packages?.find((p) => p.selected)?.group;\n\n          this.storeQuote.dispatch(\n            new fromQuoteActions.SetGroupCoverage(<string>group)\n          );\n        }\n      })\n      .unsubscribe();\n\n    this.storeEmission.dispatch(\n      new fromEmissionActions.SetEmissionVisited(true)\n    );\n\n    this.emissionSubscription = this.storeEmission\n      .select(fromEmission.getRoutes)\n      .subscribe((data: IRoutes[]) => {\n        if (data.length < 1) {\n          let routerConf: any = {};\n          routerConf = this.router?.config?.find((x) => x.path === 'quoting');\n          if (routerConf) {\n            routerConf['_loadedConfig']['routes'][0]['children']\n              .find((r: any) => r.path === 'emission')\n              ['_loadedConfig']['routes'][0]['children'][0]['children'].forEach(\n                (element: Route) => {\n                  const path = String(element.path).replace(':id', String(1));\n                  let dataElement: any = {};\n                  dataElement = element;\n                  this.routes.push({\n                    path: path,\n                    question: dataElement['data']['question'],\n                    show: dataElement['data']['show'],\n                    disabled: dataElement['data']['disabled'],\n                    value: dataElement['data']['value'],\n                    shortName: dataElement['data']['shortName'],\n                    visible: dataElement['data']['visible'],\n                    line: dataElement['data']['line']\n                  });\n                }\n              );\n\n            this.storeEmission.dispatch(\n              new fromEmissionActions.SetRoutes(this.routes)\n            );\n            this.storeEmission.dispatch(\n              new fromEmissionActions.SetActiveRoute('client')\n            );\n          }\n        }\n      });\n\n    this.policySubscription = this.storePolicy\n      .select(fromPolicy.getPolicyData)\n      .subscribe((policy) => (this.policy = cloneDeep(policy)));\n\n    //this.checkDiscount();\n  }\n\n  /**\n   * Check if quote has discount and there\n   * are no discount available\n   *\n   * @memberof EmissionComponent\n   */\n  checkDiscount() {\n    this.discountSubscription = combineLatest([\n      this.storeEmission.select(fromEmission.getEmission),\n      this.storePolicy.select(fromPolicy.getPolicyData)\n    ])\n      .pipe(\n        debounceTime(500),\n        tap((x) => {\n          this.discounts = cloneDeep(x[1].motor.discounts);\n        }),\n        switchMap((x) => {\n          const emission = x[0];\n          const policy = x[1];\n\n          if (\n            !emission.jobNumberFromQuotes ||\n            !policy.motor.discounts.some((d) => d.value > 0)\n          ) {\n            return of(null);\n          }\n\n          return this.discountService.getAvailableDiscounts({\n            job: {\n              number: policy.job.number\n            }\n          });\n        }),\n        first()\n      )\n      .subscribe((res: any) => {\n        if (!res || res.applied < res.total) {\n          return;\n        }\n\n        this.modalCupos.options.backdrop = 'static';\n        this.modalCupos.options.keyboard = false;\n        this.modalCupos.openModal();\n      });\n  }\n\n  /**\n   * get cost when there are no discounts\n   *\n   * @memberof EmissionComponent\n   */\n  callCostWithoutDiscounts() {\n    this.newCost = false;\n    this.loadingCosts = true;\n\n    this.discounts.forEach(\n      (discount) => (discount.value = <number>(discount.value ? 0 : null))\n    );\n    this.storePolicy.dispatch(\n      new fromPolicyActions.SetCurrentDiscountAction(this.discounts)\n    );\n\n    const adapted = this.policyAdapter.adapt(this.policy);\n    this.quotingService\n      .getCosts(adapted)\n      .pipe(\n        catchError((e) => {\n          this.loadingCosts = false;\n          return throwError(e);\n        })\n      )\n      .subscribe((resp) => {\n        const costVehicles = resp.motor.vehicles as IVehicle[];\n        const vehicles = this.policy.motor.vehicles;\n\n        vehicles.forEach((v) => {\n          const currentCostVehicle = costVehicles.find(\n            (cv) => cv.number === v.number\n          );\n          if (!currentCostVehicle) {\n            return;\n          }\n\n          let currentCostPackage = <IPackage>{};\n          if (\n            currentCostVehicle &&\n            currentCostVehicle.packages &&\n            currentCostVehicle.packages.length > 0\n          ) {\n            currentCostPackage = <IPackage>currentCostVehicle?.packages[0];\n          }\n\n          const currentPackage = v?.packages?.find(\n            (p) => p.externalid === currentCostPackage.externalid\n          );\n\n          if (!currentPackage) {\n            return;\n          }\n          //console.log('//diego ojo..', currentPackage);\n          currentPackage.costs = currentCostPackage.costs;\n          currentPackage.premiums = currentCostPackage.premiums;\n        });\n\n        this.storePolicy.dispatch(\n          new fromPolicyActions.UpdateVehicleAction(vehicles)\n        );\n\n        this.loadingCosts = false;\n        this.newCost = true;\n        this.modalCupos.closeModal();\n      });\n  }\n\n  ngOnDestroy() {\n    if (this.emissionSubscription) this.emissionSubscription.unsubscribe();\n    if (this.discountSubscription) this.discountSubscription.unsubscribe();\n    if (this.policySubscription) this.policySubscription.unsubscribe();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport * as fromEmission from '../state';\nimport * as fromEmissionActions from '../state/emission.actions';\nimport { Store } from '@ngrx/store';\nimport { Router } from '@angular/router';\nimport { IRoutes } from '@sura-platform/web/core/models/question/routes.interface';\n\n@Injectable()\nexport class FlowRouteEmissionService {\n  constructor(\n    private storeEmission: Store<fromEmission.State>,\n    private router: Router\n  ) {}\n\n  /**\n   *\n   * This method is created for handle routing when patent is valid, the idea is avoid DRY (Don´t repeat yourself);\n   * @param {IVehicle} currentMotor\n   * @param {IRoutes[]} routes\n   * @returns\n   * @memberof FlowRouteService\n   */\n  goToNextStep(routes: IRoutes[]) {\n    const nextRouteWithoutValue = routes\n      .filter((p) => p.value === '' || p.value === null)[0]\n      .path.split('/')[2];\n\n    routes.forEach((element) => {\n      if (element.path === nextRouteWithoutValue) {\n        element.disabled = false;\n      }\n    });\n\n    this.storeEmission.dispatch(new fromEmissionActions.SetRoutes(routes));\n\n    this.storeEmission.dispatch(\n      new fromEmissionActions.SetActiveRoute(nextRouteWithoutValue)\n    );\n\n    return this.router.navigateByUrl(\n      'quoting/emission/questions/' + nextRouteWithoutValue + ''\n    );\n  }\n\n  enableRoute(routes: IRoutes[], route: string) {\n    routes.forEach((element) => {\n      if (element.path === route) {\n        element.disabled = false;\n        element.value = null;\n      }\n    });\n\n    this.storeEmission.dispatch(new fromEmissionActions.SetActiveRoute(route));\n\n    this.router.navigateByUrl('quoting/emission/questions/' + route);\n\n    this.storeEmission.dispatch(new fromEmissionActions.SetRoutes(routes));\n  }\n}\n","<div *ngFor=\"let vehicle of vehicles; index as i\">\n  <div *ngIf=\"i + 1 < currentMotor.number\" class=\"row pb-4\">\n    <div class=\"col-lg-5 px-0 btn-vehicle\">\n      <div class=\"row\">\n        <div class=\"col-lg-12 text-right\">\n          <span class=\"circle-ok\">\n            <sxf-icon\n              type=\"ok\"\n              class=\"icon-white\"\n              style=\"cursor: none !important;\"\n            ></sxf-icon>\n          </span>\n        </div>\n      </div>\n      <div class=\"row\">\n        <div class=\"col-lg-4 icon\">\n          <img\n            src=\"/assets/icons/TYPE_{{ vehicle.group | uppercase }}.svg\"\n            alt=\"vehicle\"\n            class=\"icon-vehicle\"\n            width=\"64px\"\n          />\n        </div>\n\n        <div class=\"col-lg-8 pl-0 text-left\" style=\"margin-top: -15px;\">\n          <div class=\"title-primary\">{{ vehicle?.brand?.description }}</div>\n          <div class=\"title-secondary\">\n            {{ vehicle?.shortModel }} {{ vehicle?.year }}\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div *ngIf=\"currentMotor.number === i + 1\" class=\"row pb-4\">\n    <div\n      [formGroup]=\"form\"\n      class=\"col-lg-12 py-4\"\n      style=\"border: 0.5px solid #00aec7;\"\n    >\n      <div class=\"row\">\n        <div class=\"col-lg-4\">\n          <div class=\"row\">\n            <div class=\"col-lg-12\">\n              <span class=\"vehicle-type\">\n                <img\n                  src=\"/assets/icons/TYPE_{{ vehicle.group | uppercase }}.svg\"\n                  alt=\"vehicle icon\"\n                  width=\"64px;\"\n                />\n              </span>\n            </div>\n          </div>\n          <div class=\"row\">\n            <div class=\"col-lg-12\">\n              <span class=\"brand-span\">\n                {{ currentMotor.brand.description }}\n                {{ currentMotor?.shortModel }}\n              </span>\n            </div>\n          </div>\n          <div class=\"row\">\n            <div class=\"col-lg-12\">\n              <span class=\"model-span\">\n                {{ currentMotor.model.description }}\n              </span>\n            </div>\n          </div>\n          <div class=\"row\">\n            <div class=\"col-lg-12\">\n              <span class=\"year-span\">\n                {{ currentMotor.year }}\n              </span>\n            </div>\n          </div>\n        </div>\n        <!-- Formulario -->\n        <div class=\"col-lg-8 pt-3\">\n          <div class=\"row mb-4\">\n            <div class=\"col-lg-6\">\n              <sxf-textbox\n                type=\"text\"\n                formControlName=\"patent\"\n                label=\"Patente *\"\n                placeholder=\"Ingresá la patente\"\n                (keyup.enter)=\"onEnterPatent()\"\n                [maxLength]=\"maxLength\"\n                [disabled]=\"disabledByRetrieve\"\n              ></sxf-textbox>\n            </div>\n            <div class=\"col-lg-5\">\n              <!-- <span> -->\n              <button\n                [disabled]=\"\n                  (currentMotor.license &&\n                    (currentMotor.chasis || currentMotor.motor)) ||\n                  !form.get('patent').valid ||\n                  disabledValidate\n                \"\n                class=\"btn btn-primary btn-block\"\n                (click)=\"validatePatent()\"\n              >\n                <ng-lottie\n                  [hidden]=\"!loadingPatent\"\n                  [options]=\"lottieConfig\"\n                  (animationCreated)=\"animationCreated($event)\"\n                  height=\"32px\"\n                  width=\"32px\"\n                  class=\"mr-2\"\n                ></ng-lottie>\n                <label class=\"label-btn\">\n                  {{ buttonLabel }}\n                </label>\n                <!-- Validar -->\n              </button>\n            </div>\n          </div>\n          <div class=\"row mb-2\" [hidden]=\"hiddenFormPatent\">\n            <div class=\"col-lg-6\">\n              <sxf-textbox\n                type=\"text\"\n                formControlName=\"engineNumber\"\n                (keydown.enter)=\"onEnter()\"\n                label=\"Número de motor *\"\n                placeholder=\"Número de motor\"\n                [minLength]=\"8\"\n                [maxLength]=\"20\"\n                [helpFeedback]=\"''\"\n                [disabled]=\"disabledByRetrieve\"\n              ></sxf-textbox>\n            </div>\n            <div class=\"col-lg-6\">\n              <sxf-textbox\n                type=\"text\"\n                formControlName=\"chassisNumber\"\n                (keydown.enter)=\"onEnter()\"\n                label=\"Número de chasis *\"\n                placeholder=\"\"\n                [minLength]=\"10\"\n                [maxLength]=\"17\"\n                [helpFeedback]=\"''\"\n                [disabled]=\"disabledByRetrieve\"\n              ></sxf-textbox>\n            </div>\n          </div>\n\n          <!-- checkbox -->\n          <div class=\"row mb-4\" [hidden]=\"hiddenFormPatent\">\n            <div class=\"col-lg-4\">\n              <div class=\"form-checkbox\">\n                <input\n                  type=\"checkbox\"\n                  class=\"form-checkbox-input\"\n                  id=\"creditorPrendario\"\n                  formControlName=\"creditorPrendario\"\n                />\n                <label\n                  class=\"form-checkbox-label\"\n                  for=\"creditorPrendario\"\n                ></label>\n                <label class=\"label-checkbox\">\n                  Acreedor Prendario\n                </label>\n              </div>\n            </div>\n            <div\n              class=\"col-lg-4\"\n              *ngIf=\"currentPolicy.client.type === 'Person'\"\n            >\n              <div class=\"form-checkbox\">\n                <input\n                  type=\"checkbox\"\n                  class=\"form-checkbox-input\"\n                  id=\"driveCustomer\"\n                  formControlName=\"clientIsDriver\"\n                />\n                <label class=\"form-checkbox-label\" for=\"driveCustomer\"></label>\n                <label class=\"label-checkbox\">\n                  Conduce el cliente\n                </label>\n              </div>\n            </div>\n            <div class=\"col-lg-4\" *ngIf=\"!gncNotRequired\">\n              <div class=\"form-checkbox\">\n                <input\n                  type=\"checkbox\"\n                  class=\"form-checkbox-input\"\n                  id=\"gnc\"\n                  formControlName=\"gnc\"\n                />\n                <label class=\"form-checkbox-label\" for=\"gnc\"></label>\n                <label class=\"label-checkbox\">\n                  GNC\n                </label>\n              </div>\n            </div>\n          </div>\n          <!-- Fin checkbox-->\n\n          <!-- Acreedor prendario-->\n          <div *ngIf=\"applyBondHolderFlag\" [hidden]=\"hiddenFormPatent\">\n            <div class=\"row mb-4\">\n              <div class=\"col-lg-6\">\n                <div class=\"form-group\">\n                  <label>Tipo de acreedor prendario</label>\n                  <sxf-select\n                    formControlName=\"bondHolderType\"\n                    [items]=\"bondHoldersTypes$ | async\"\n                    bindLabel=\"description\"\n                    bindValue=\"code\"\n                    [multiple]=\"false\"\n                    [helpFeedback]=\"\"\n                    class=\"custom\"\n                    [searchable]=\"true\"\n                    placeholder=\"Seleccione el tipo\"\n                    dropdownPosition=\"bottom\"\n                    name=\"bondHolderType\"\n                  ></sxf-select>\n                </div>\n              </div>\n              <div class=\"col-lg-6\">\n                <label>\n                  Cuotas\n                  <sup>*</sup>\n                </label>\n                <sxf-select\n                  formControlName=\"bondHolderQuotas\"\n                  [items]=\"bondHoldersQuotesQuantity\"\n                  bindLabel=\"description\"\n                  bindValue=\"code\"\n                  [multiple]=\"false\"\n                  [helpFeedback]=\"\"\n                  class=\"custom\"\n                  [searchable]=\"true\"\n                  placeholder=\"Seleccione las cuotas\"\n                  dropdownPosition=\"bottom\"\n                  name=\"bondHoldersQuotesQuantity\"\n                ></sxf-select>\n              </div>\n            </div>\n          </div>\n          <!-- Fin acreedor prendario -->\n\n          <!-- Conductor -->\n          <div\n            [hidden]=\"hiddenFormPatent\"\n            *ngIf=\"\n              (!currentMotor.driver.clientIsDriver &&\n                clientType !== 'Company') ||\n              clientType == 'Company'\n            \"\n            [formGroup]=\"formClient\"\n            class=\"row mt-4\"\n          >\n            <div class=\"col-lg-6\">\n              <sxf-textbox\n                type=\"text\"\n                formControlName=\"driverName\"\n                (keydown.enter)=\"onEnter()\"\n                label=\"Nombre *\"\n                placeholder=\"Ingresá el nombre del conductor\"\n                [helpFeedback]=\"''\"\n                placement=\"bottom\"\n                messageTooltips=\"Nombre\"\n                name=\"driverNameEmission\"\n              ></sxf-textbox>\n            </div>\n            <div class=\"col-lg-6\">\n              <sxf-textbox\n                type=\"text\"\n                formControlName=\"driverLastName\"\n                (keydown.enter)=\"onEnter()\"\n                label=\"Apellido *\"\n                placeholder=\"Ingresá el apellido del conductor\"\n                [helpFeedback]=\"''\"\n                placement=\"bottom\"\n                messageTooltips=\"Apellido\"\n                name=\"driverLastNameEmission\"\n              ></sxf-textbox>\n            </div>\n          </div>\n          <!-- Fin conductor -->\n\n          <!-- GNC -->\n          <div\n            [hidden]=\"hiddenFormPatent\"\n            *ngIf=\"currentMotor.gnc || showGNC\"\n            [formGroup]=\"formGNC\"\n            class=\"row mb-3\"\n          >\n            <div class=\"col-lg-6\">\n              <sxf-textbox\n                type=\"text\"\n                formControlName=\"summa\"\n                (keydown.enter)=\"onEnter()\"\n                label=\"Suma asegurada de equipo de GNC *\"\n                [disabled]=\"true\"\n                [helpFeedback]=\"'No es modificable'\"\n                placement=\"bottom\"\n                messageTooltips=\"Suma asegurada\"\n                name=\"summaGNCEmission\"\n              ></sxf-textbox>\n            </div>\n            <div class=\"col-lg-6\">\n              <sxf-datetimepicker\n                [minDate]=\"minDateGNC\"\n                label=\"Vencimiento de equipo de GNC *\"\n                formControlName=\"expiration\"\n                (keydown.enter)=\"onEnter()\"\n                name=\"expirationGNCEmission\"\n              ></sxf-datetimepicker>\n            </div>\n          </div>\n          <!-- Fin GNC -->\n\n          <!-- Botón -->\n          <div class=\"row mt-4\">\n            <div class=\"col-lg-8\">\n              <span>\n                <button\n                  [disabled]=\"\n                    form.invalid ||\n                    (formClient.invalid &&\n                      ((!currentMotor.driver.clientIsDriver &&\n                        clientType !== 'Company') ||\n                        clientType == 'Company'))\n                  \"\n                  (click)=\"continue()\"\n                  class=\"btn btn-primary btn-heft\"\n                  name=\"continueEmissionOthers\"\n                  style=\"width: 10rem;\"\n                >\n                  Siguiente\n                </button>\n              </span>\n              <span class=\"press-enter ml-3 mr-4\">\n                o presiona ENTER\n              </span>\n            </div>\n          </div>\n          <!-- Fin botón -->\n        </div>\n        <!-- Fin formulario -->\n      </div>\n    </div>\n  </div>\n  <div *ngIf=\"i + 1 > currentMotor.number\" class=\"row pb-4\">\n    <div class=\"col-lg-5 px-0 btn-vehicle\">\n      <div class=\"row\">\n        <div class=\"col-lg-12 text-right\">\n          <span class=\"circle-ok\" style=\"visibility: hidden;\">\n            <sxf-icon\n              type=\"ok\"\n              class=\"icon-white\"\n              style=\"cursor: none !important;\"\n            ></sxf-icon>\n          </span>\n        </div>\n      </div>\n      <div class=\"row\">\n        <div class=\"col-lg-4 icon\">\n          <img\n            src=\"/assets/icons/TYPE_{{ vehicle.group | uppercase }}.svg\"\n            alt=\"vehicle\"\n            class=\"icon-vehicle\"\n            width=\"64px\"\n          />\n        </div>\n\n        <div class=\"col-lg-8 pl-0 text-left\" style=\"margin-top: -15px;\">\n          <div class=\"title-primary\">{{ vehicle?.brand?.description }}</div>\n          <div class=\"title-secondary\">\n            {{ vehicle?.shortModel }} {{ vehicle?.year }}\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n<sxf-modal #modalNoGNC>\n  <div class=\"modal-header modal-header-items\">\n    <button\n      type=\"button\"\n      class=\"close\"\n      aria-label=\"Close\"\n      (click)=\"closeModalNoGNC()\"\n      name=\"closeModalNoGNCBtn\"\n    >\n      <span aria-hidden=\"true\">&times;</span>\n    </button>\n  </div>\n  <div class=\"modal-body modal-body-items\">\n    <h3>El equipo de GNC es solo a modo</h3>\n    <h3>declarativo ¿Desea asegurar el equipo?</h3>\n  </div>\n  <div class=\"modal-footer\">\n    <div class=\"row\">\n      <div class=\"col-lg-4 offset-lg-3 pl-0\">\n        <button\n          type=\"button\"\n          class=\"btn btn-modal btn-lg btn-block\"\n          (click)=\"closeModalNoGNC()\"\n          name=\"closeModalNoGNCBtn\"\n        >\n          No solictar\n        </button>\n      </div>\n      <div class=\"col-lg-5 pl-0\">\n        <button\n          type=\"button\"\n          class=\"btn btn-primary btn-lg btn-block\"\n          (click)=\"redirectCoverage()\"\n          name=\"redirectCoverageGNCBtn\"\n        >\n          Asegurar el equipo de GNC\n        </button>\n      </div>\n    </div>\n  </div>\n</sxf-modal>\n\n<sxf-modal #modalPatentInUse (closed)=\"closeModalPatentInUse()\">\n  <div class=\"modal-header modal-header-items\">\n    <h4 class=\"modal-title\" id=\"modal-basic-title\">\n      Patente asociada a otra póliza\n    </h4>\n    <button\n      type=\"button\"\n      class=\"close\"\n      aria-label=\"Close\"\n      (click)=\"closeModalPatentInUse()\"\n      name=\"closeModalPatentInUseBtn\"\n    >\n      <span aria-hidden=\"true\">&times;</span>\n    </button>\n  </div>\n  <div class=\"modal-body modal-body-items\">\n    <p>\n      La patente está asociada a una póliza o solicitud activa y actualmente no\n      podrá ser asegurada. Comunicate con tu Ejecutivo de Cuenta para más\n      información.\n    </p>\n  </div>\n\n  <div class=\"modal-footer\">\n    <div class=\"row\">\n      <div class=\"col-lg-4 offset-lg-8 pl-0\">\n        <button\n          type=\"button\"\n          class=\"btn btn-primary btn-lg btn-block\"\n          (click)=\"closeModalPatentInUse()\"\n          name=\"closeModalPatentInUseBtn\"\n        >\n          Volver\n        </button>\n      </div>\n    </div>\n  </div>\n</sxf-modal>\n\n<sxf-modal #modalUW (closed)=\"closeUWModal()\">\n  <div class=\"modal-header\" style=\"padding: 1rem 2rem;\">\n    <button\n      type=\"button\"\n      class=\"close\"\n      aria-label=\"Close\"\n      (click)=\"closeUWModal('Cross click')\"\n    >\n      <span aria-hidden=\"true\">&times;</span>\n    </button>\n  </div>\n  <div class=\"modal-body\">\n    <h4>\n      La presente emisión va a requerir autorización de la compañía.\n    </h4>\n    <h4>¿Desea solicitar autorización?</h4>\n  </div>\n  <div class=\"modal-footer\">\n    <div class=\"row\">\n      <div class=\"col-lg-4 offset-lg-3 pl-0\">\n        <button\n          type=\"button\"\n          class=\"btn btn-modal btn-lg btn-block\"\n          (click)=\"closeUWModal()\"\n        >\n          Cancelar\n        </button>\n      </div>\n      <div class=\"col-lg-5 pl-0\">\n        <button\n          type=\"button\"\n          class=\"btn btn-primary btn-lg btn-block\"\n          (click)=\"closeUWModal('continue')\"\n        >\n          Continuar\n        </button>\n      </div>\n    </div>\n  </div>\n</sxf-modal>\n","import { Component, OnInit, ViewChild, OnDestroy } from '@angular/core';\nimport { BaseComponent } from '@sura-platform/core';\nimport { combineLatest, of, Subject, Subscription, Observable } from 'rxjs';\n\nimport * as fromPolicy from '../../../../state/policy';\nimport * as fromPolicyActions from '../../../../state/policy/policy.actions';\nimport * as fromQuote from '../../../quote/state/index';\nimport * as fromQuoteActions from '../../../quote/state/quote.actions';\nimport * as fromEmission from '../../../emission/state';\nimport * as fromEmissionActions from '../../../emission/state/emission.actions';\nimport { AnimationOptions } from 'ngx-lottie';\nimport { AnimationItem } from 'lottie-web';\n\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { Store } from '@ngrx/store';\nimport {\n  IVehicle,\n  CarService,\n  DomainSearch,\n  IPolicy,\n  PatentBlackListService,\n  PatentUseService,\n  IBondholder,\n  BondholderService\n} from '@sura-platform/features';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { FlowRouteEmissionService } from '../../../emission/services/flow-route-emission.service';\nimport { IRoutes } from '@sura-platform/web/core/models/question/routes.interface';\nimport { catchError, take, distinctUntilKeyChanged } from 'rxjs/operators';\nimport { ModalComponent } from '@sura-platform/web';\nimport {\n  patentPatternAutos,\n  patentPatternMotos,\n  patentPatternOtros\n} from '../../components/patent/patent.component';\n\n@Component({\n  selector: 'sxf-others-motor',\n  templateUrl: './others.component.html',\n  styleUrls: ['./others.component.scss']\n})\nexport class OthersMotorComponent extends BaseComponent\n  implements OnInit, OnDestroy {\n  lottieConfig: AnimationOptions = {\n    path: '/assets/loadings/data-validation-loader.json',\n    loop: false,\n    autoplay: false\n  };\n  @ViewChild('modalNoGNC', { static: true }) modalNoGNC: ModalComponent;\n\n  @ViewChild('modalPatentInUse', { static: true })\n  modalPatentInUse: ModalComponent;\n\n  @ViewChild('modalUW', { static: true }) modalUW: ModalComponent;\n\n  form: FormGroup;\n\n  formClient: FormGroup;\n\n  formGNC: FormGroup;\n\n  vehicles: IVehicle[];\n\n  currentMotor: IVehicle;\n\n  routes: IRoutes[];\n\n  currentPolicy: IPolicy;\n\n  showGNC = false;\n  minDateGNC: any;\n  disabledValidate = false;\n\n  _CODE_GNC = 'SURA_CA7_EquipodeGNCCov';\n  _CODE_SUMMA_GNC = 'SURA_CA7_EquipodeGNCLim';\n  _CODE_EXPIRATION = 'SURA_CA7_EquipodeGNCFecVencLim';\n\n  hiddenFormPatent = true;\n  loadingPatent$: Subject<boolean> = new Subject();\n  currentBlackList = false;\n  loadingPatent = false;\n  buttonLabel = 'Validar';\n  buttonAnimated: any;\n  applyBondHolderFlag: boolean;\n  bondHoldersQuotesQuantity = [];\n  bondHoldersTypes$: Observable<IBondholder[]>;\n  openedModalPatentInUse = false;\n  maxLength = 11;\n  /**\n   * Flag used to disable fields when\n   * policy comes from quotes list\n   *\n   * @type {boolean}\n   * @memberof OthersMotorComponent\n   */\n  disabledByRetrieve: boolean;\n\n  /**\n   * Flag used for hidde the GNC\n   * check input\n   *\n   * @type {boolean}\n   * @memberof OthersMotorComponent\n   */\n  gncNotRequired: boolean;\n\n  /**\n   * Subscription to emission store\n   *\n   * @type {Subscription}\n   * @memberof OthersMotorComponent\n   */\n  emissionSubscription: Subscription;\n\n  /**\n   * Subscription to quote store\n   *\n   * @type {Subscription}\n   * @memberof OthersMotorComponent\n   */\n  policyQuoteSubscription: Subscription;\n\n  /**\n   * Subscription to route changes on\n   * emission store\n   *\n   * @type {Subscription}\n   * @memberof OthersMotorComponent\n   */\n  emissionRoutesSubscription: Subscription;\n\n  /**\n   * Subscription to value changes on\n   * patent input\n   *\n   * @type {Subscription}\n   * @memberof OthersMotorComponent\n   */\n  patentInputSubscription: Subscription;\n\n  /**\n   * Subscription to value changes on\n   * clientIsDriver check input\n   *\n   * @type {Subscription}\n   * @memberof OthersMotorComponent\n   */\n  clientIsDriverCheckSubscription: Subscription;\n\n  /**\n   * Subscription to value changes on\n   * gnc check input\n   *\n   * @type {Subscription}\n   * @memberof OthersMotorComponent\n   */\n  gncCheckSubscription: Subscription;\n\n  /**\n   * Subscription to value changes on\n   * expiration input\n   *\n   * @type {Subscription}\n   * @memberof OthersMotorComponent\n   */\n  expirationInputSubscription: Subscription;\n\n  /**\n   * Subscription to value changes on\n   * creditor prendario check input\n   *\n   * @type {Subscription}\n   * @memberof OthersMotorComponent\n   */\n  creditorPrendarioInputSubscription: Subscription;\n\n  /**\n   * stores the pattern corresponding to the type of vehicle\n   * Default car pattern\n   * @memberof OthersMotorComponent\n   */\n  patentPattern = patentPatternAutos;\n  clientType = '';\n  constructor(\n    private fb: FormBuilder,\n    private storePolicy: Store<fromPolicy.State>,\n    private storeQuote: Store<fromQuote.State>,\n    private router: Router,\n    private route: ActivatedRoute,\n    private carService: CarService,\n    private flowRouteEmissionService: FlowRouteEmissionService,\n    private storeEmission: Store<fromEmission.State>,\n    private patentBlackListService: PatentBlackListService,\n    private patentUseService: PatentUseService,\n    private bondHolderService: BondholderService\n  ) {\n    super();\n  }\n\n  ngOnInit() {\n    this.loadingPatent$.next(false);\n\n    this.route.params.subscribe(({ id }) => {\n      this.storeQuote.dispatch(\n        new fromQuoteActions.SetCurrentMotorAction(Number(id))\n      );\n    });\n\n    this.policyQuoteSubscription = combineLatest([\n      this.storePolicy.select(fromPolicy.getPolicyData).pipe(take(1)),\n      this.storeQuote.select(fromQuote.getQuoteMotorData)\n    ]).subscribe(([policy, quote]) => {\n      console.log('Recargando data');\n\n      this.currentPolicy = policy;\n      this.currentMotor = policy.motor.vehicles.find(\n        (c) => c.number === quote.activeMotor\n      );\n      this.vehicles = policy.motor.vehicles;\n\n      this.currentMotor.bondholder.type !== null\n        ? (this.applyBondHolderFlag = true)\n        : (this.applyBondHolderFlag = false);\n\n      if (\n        this.currentMotor.chasis !== null &&\n        this.currentMotor.motor !== null\n      ) {\n        this.hiddenFormPatent = false;\n      }\n\n      if (\n        this.currentMotor.driver.clientIsDriver &&\n        this.currentPolicy.client.type === 'Person'\n      ) {\n        this.currentMotor.driver.firstname = this.currentPolicy.client.firstname;\n        this.currentMotor.driver.lastname = this.currentPolicy.client.lastname;\n      }\n\n      const _dateFromStoreVigencia = this.currentPolicy.period.start.toString();\n      const dateGNC = {\n        year: parseInt(_dateFromStoreVigencia.substring(0, 4), 0),\n        month: parseInt(_dateFromStoreVigencia.substring(5, 7), 0),\n        day: parseInt(_dateFromStoreVigencia.substring(8, 10), 0)\n      };\n\n      this.minDateGNC = dateGNC;\n\n      if (this.currentMotor.group === 'MOTO') {\n        this.gncNotRequired = true;\n        this.patentPattern = patentPatternMotos;\n      } else {\n        if (this.currentMotor.group === 'OTRO') {\n          this.patentPattern = patentPatternOtros;\n        } else {\n          this.patentPattern = patentPatternAutos;\n        }\n      }\n    });\n\n    this.storeQuote\n      .select(fromQuote.getQuoteMotorData)\n      .pipe(distinctUntilKeyChanged('activeMotor'))\n      .subscribe(() => this.initializeForms());\n\n    this.emissionRoutesSubscription = this.storeEmission\n      .select(fromEmission.getRoutes)\n      .subscribe((data) => {\n        this.routes = data;\n      });\n\n    this.bondHoldersTypes$ = this.bondHolderService.getBondHolders();\n    let index = 0;\n\n    while (index < 100) {\n      index++;\n      this.bondHoldersQuotesQuantity.push({\n        code: index,\n        description: index\n      });\n    }\n\n    this.emissionSubscription = this.storeEmission\n      .select(fromEmission.getEmission)\n      .subscribe((x) => {\n        const job = x.jobNumberFromQuotes;\n        const approved = x.approvedEmission;\n        this.clientType = x.client.type;\n        this.disabledByRetrieve = job && approved ? true : false;\n\n        if (this.disabledByRetrieve) {\n          this.form.get('gnc').disable();\n          this.form.get('creditorPrendario').disable();\n          this.form.get('clientIsDriver').disable();\n          this.formClient.disable();\n          this.form.get('bondHolderType').disable();\n          this.form.get('bondHolderQuotas').disable();\n        }\n      });\n  }\n\n  initializeForms() {\n    console.log('Inicializo los formularios');\n    // Vehicle form\n    this.form = this.fb.group({\n      gnc: [this.currentMotor.gnc, Validators.required],\n      creditorPrendario: [this.applyBondHolderFlag],\n      patent: [\n        this.currentMotor.license,\n        [Validators.required, Validators.pattern(this.patentPattern)]\n      ],\n      bondHolderType: [this.currentMotor.bondholder.type],\n      bondHolderQuotas: [this.currentMotor.bondholder.quotas],\n      engineNumber: [\n        this.currentMotor.motor,\n        [Validators.required, Validators.minLength(6), Validators.maxLength(20)]\n      ],\n      chassisNumber: [\n        this.currentMotor.chasis,\n        [\n          Validators.required,\n          // Por definicion del PO el minimo de caracteres es 10.\n          Validators.minLength(10),\n          Validators.maxLength(17)\n        ]\n      ],\n      clientIsDriver: [this.currentMotor.driver.clientIsDriver]\n    });\n\n    // Driver form\n    this.formClient = this.fb.group({\n      driverName: [this.currentMotor.driver.firstname, Validators.required],\n      driverLastName: [this.currentMotor.driver.lastname, Validators.required]\n    });\n\n    this.currentMotor.packages\n      .filter((op) => op.selected)\n      .map((jk) => {\n        //si tiene agregado GNC en accesorios\n        const gncCov = jk.coverages.filter(\n          (ik) => ik.pattern.code === this._CODE_GNC\n        );\n        if (gncCov.length === 1) {\n          const valueSumma = gncCov[0].terms.filter(\n            (op) => op.code === this._CODE_SUMMA_GNC\n          )[0].value;\n          const valueExpiration = gncCov[0].terms.filter(\n            (op) => op.code === this._CODE_EXPIRATION\n          )[0].value;\n\n          const _dateFromStore = valueExpiration.toString();\n          const dateGNC = {\n            year: parseInt(_dateFromStore.substring(0, 4), 0),\n            month: parseInt(_dateFromStore.substring(5, 7), 0),\n            day: parseInt(_dateFromStore.substring(8, 10), 0)\n          };\n\n          this.formGNC = this.fb.group({\n            summa: [valueSumma, Validators.required],\n            expiration: [dateGNC, Validators.required]\n          });\n\n          this.form.patchValue(\n            {\n              gnc: true\n            },\n            { onlySelf: true, emitEvent: false }\n          );\n          this.showGNC = true;\n        } else {\n          //no tiene GNC agregado\n          this.formGNC = this.fb.group({\n            summa: [0, Validators.required],\n            expiration: [, Validators.required]\n          });\n        }\n      });\n\n    // if (!this.hiddenFormPatent) {\n    //   this.form.markAllAsTouched();\n    // }\n\n    // Subscribe form inputs\n    this.unsubscribeForm();\n\n    this.patentInputSubscription = this.form\n      .get('patent')\n      .valueChanges.subscribe(() => {\n        this.currentBlackList = false;\n        this.hiddenFormPatent = true;\n        this.disabledValidate = false;\n        this.form.get('chassisNumber').setValue([]);\n        this.form.get('engineNumber').setValue([]);\n        this.form\n          .get('creditorPrendario')\n          .setValue(false, { emitEvent: false });\n        this.applyBondHolderFlag = false;\n        this.form.get('bondHolderType').setValue([]);\n        this.form.get('bondHolderQuotas').setValue([]);\n        this.form.get('bondHolderQuotas').clearValidators();\n        this.currentMotor.license = null;\n        this.buttonLabel = 'Validar';\n      });\n\n    this.clientIsDriverCheckSubscription = this.form\n      .get('clientIsDriver')\n      .valueChanges.subscribe((data) => {\n        if (data) {\n          this.formClient\n            .get('driverName')\n            .setValue(this.currentPolicy.client.firstname);\n          this.formClient\n            .get('driverLastName')\n            .setValue(this.currentPolicy.client.lastname);\n          this.vehicles.forEach((v) => {\n            if (v.number === this.currentMotor.number) {\n              v.driver.firstname = this.currentPolicy.client.firstname;\n              v.driver.lastname = this.currentPolicy.client.lastname;\n              v.driver.clientIsDriver = data;\n            }\n          });\n          this.storePolicy.dispatch(\n            new fromPolicyActions.UpdateVehicleAction(this.vehicles)\n          );\n        } else {\n          this.formClient\n            .get('driverName')\n            .setValue(\n              this.disabledByRetrieve\n                ? this.currentMotor.driver.firstname\n                : null\n            );\n          this.formClient\n            .get('driverLastName')\n            .setValue(\n              this.disabledByRetrieve ? this.currentMotor.driver.lastname : null\n            );\n\n          this.vehicles.forEach((v) => {\n            if (v.number === this.currentMotor.number) {\n              v.driver.firstname = this.formClient.get('driverName').value;\n              v.driver.lastname = this.formClient.get('driverLastName').value;\n              v.driver.clientIsDriver = data;\n            }\n          });\n          this.storePolicy.dispatch(\n            new fromPolicyActions.UpdateVehicleAction(this.vehicles)\n          );\n        }\n      });\n\n    this.gncCheckSubscription = this.form\n      .get('gnc')\n      .valueChanges.subscribe((data: boolean) => {\n        this.showGNC = false;\n        if (data && this.formGNC.get('summa').value === 0) {\n          //muestro modal y lo envio a coverage de nuevo\n          this.openModalNoGNC();\n        } else {\n          this.vehicles.forEach((v) => {\n            if (v.number === this.currentMotor.number) {\n              v.gnc = data;\n            }\n          });\n\n          this.storePolicy.dispatch(\n            new fromPolicyActions.UpdateVehicleAction(this.vehicles)\n          );\n        }\n      });\n\n    this.expirationInputSubscription = this.formGNC\n      .get('expiration')\n      .valueChanges.subscribe((data) => {\n        let isoDate = data.year + '-' + data.month + '-' + data.day;\n        isoDate = new Date(isoDate).toISOString();\n\n        this.vehicles.forEach((v) => {\n          if (v.number === this.currentMotor.number) {\n            v.packages\n              .filter((op) => op.selected)[0]\n              .coverages.filter((ik) => ik.pattern.code === this._CODE_GNC)[0]\n              .terms.filter(\n                (op) => op.code === this._CODE_EXPIRATION\n              )[0].value.current = isoDate;\n          }\n        });\n\n        this.storePolicy.dispatch(\n          new fromPolicyActions.UpdateVehicleAction(this.vehicles)\n        );\n      });\n\n    this.creditorPrendarioInputSubscription = this.form\n      .get('creditorPrendario')\n      .valueChanges.subscribe((value) => {\n        this.applyBondHolderFlag = value;\n        //!Si se marca el tilde, no debe poder continuar si el dato obligatorio no está cargado.\n        //!Si se cargaron datos (tipo de acreedor o cuotas) y se destilda la opción de acreedor prendario esos datos vuelven a null.\n        //! US5752 Validation.\n        if (this.applyBondHolderFlag) {\n          this.form\n            .get('bondHolderQuotas')\n            .setValidators([Validators.required]);\n          this.form.get('bondHolderQuotas').updateValueAndValidity();\n        } else {\n          this.form.get('bondHolderQuotas').clearValidators();\n          this.form.get('bondHolderQuotas').updateValueAndValidity();\n          this.form.get('bondHolderQuotas').reset();\n          this.form.get('bondHolderType').reset();\n        }\n      });\n  }\n\n  unsubscribeForm() {\n    this.patentInputSubscription?.unsubscribe();\n    this.clientIsDriverCheckSubscription?.unsubscribe();\n    this.gncCheckSubscription?.unsubscribe();\n    this.expirationInputSubscription?.unsubscribe();\n  }\n\n  ngOnDestroy() {\n    this.emissionSubscription?.unsubscribe();\n    this.policyQuoteSubscription?.unsubscribe();\n    this.emissionRoutesSubscription?.unsubscribe();\n\n    this.unsubscribeForm();\n  }\n\n  continuePatentValidate() {\n    this.carService\n      .getCar(this.form.get('patent').value)\n      .pipe(\n        catchError(() => {\n          //No existe esa petente\n          //muestro formulario\n          this.hiddenFormPatent = false;\n          this.loadingPatent$.next(false);\n          this.loadingPatent = false;\n          return of(null);\n        })\n      )\n      .subscribe((vehicleData) => {\n        this.buttonAnimated.playSegments([[120, 175]], false);\n        setTimeout(() => {\n          this.buttonLabel = 'Validado';\n        }, 2000);\n        this.hiddenFormPatent = false;\n        this.loadingPatent = false;\n        this.loadingPatent$.next(false);\n        this.checkBlackList(vehicleData);\n      });\n  }\n\n  validatePatent() {\n    this.openedModalPatentInUse = false;\n\n    this.disabledValidate = true;\n    this.loadingPatent$.next(true);\n    this.loadingPatent = true;\n    this.buttonLabel = 'Validando';\n    this.buttonAnimated.playSegments([[0, 119]], true);\n\n    const startDatecurrentPolicy = new Date(\n      this.currentPolicy.period.start.toString()\n    );\n    const startDate =\n      startDatecurrentPolicy.getDate() +\n      '-' +\n      ('0' + (startDatecurrentPolicy.getMonth() + 1)).slice(-2) +\n      '-' +\n      startDatecurrentPolicy.getFullYear();\n    startDatecurrentPolicy.setMonth(startDatecurrentPolicy.getMonth() + 3);\n    const endDate =\n      startDatecurrentPolicy.getDate() +\n      '-' +\n      ('0' + (startDatecurrentPolicy.getMonth() + 1)).slice(-2) +\n      '-' +\n      startDatecurrentPolicy.getFullYear();\n\n    this.patentUseService\n      .validePatentInUse(this.form.get('patent').value, startDate, endDate)\n      .subscribe((data) => {\n        const patentInUse = data;\n        if (\n          patentInUse !== null &&\n          patentInUse.length > 0 &&\n          patentInUse[0].fixedid !== ''\n        ) {\n          this.openModalPatentInUse();\n          this.openedModalPatentInUse = true;\n        } else {\n          this.continuePatentValidate();\n        }\n      });\n  }\n\n  checkBlackList(vehicleData: DomainSearch) {\n    this.patentBlackListService\n      .validePatent(this.form.get('patent').value)\n      .subscribe((res) => {\n        this.loadingPatent$.next(false);\n\n        this.currentBlackList = false;\n        if (res !== null && res.length > 0) {\n          this.currentBlackList = true;\n        }\n\n        this.vehicles.forEach((v) => {\n          if (v.number === this.currentMotor.number) {\n            v.blacklist = this.currentBlackList;\n          }\n        });\n\n        this.storePolicy.dispatch(\n          new fromPolicyActions.UpdateVehicleAction(this.vehicles)\n        );\n\n        if (this.currentBlackList) {\n          this.modalUW.openModal();\n        } else {\n          setTimeout(() => {\n            this.buttonLabel = 'Validado';\n          }, 2000);\n        }\n      });\n\n    if (vehicleData) {\n      this.form.get('chassisNumber').setValue(vehicleData.chassis);\n      this.form.get('engineNumber').setValue(vehicleData.motor);\n      this.form.markAllAsTouched();\n    }\n  }\n\n  onEnterPatent() {\n    if (this.form.get('patent').valid) {\n      this.validatePatent();\n    }\n  }\n\n  onEnter() {\n    if (this.form.valid) {\n      this.continue();\n    }\n  }\n\n  /**\n   * Continue to next vehicle or payment method\n   *\n   * @returns\n   * @memberof OthersMotorComponent\n   */\n  continue() {\n    const {\n      patent,\n      engineNumber,\n      chassisNumber,\n      bondHolderType,\n      bondHolderQuotas,\n      gnc\n    } = this.form.value;\n\n    const { driverLastName, driverName } = this.formClient.value;\n\n    this.currentMotor.license = patent;\n    this.currentMotor.motor = engineNumber;\n    this.currentMotor.chasis = chassisNumber;\n\n    this.currentMotor.bondholder = {\n      ...this.currentMotor.bondholder,\n      type: this.applyBondHolderFlag ? bondHolderType : null,\n      quotas: this.applyBondHolderFlag ? bondHolderQuotas : null\n    };\n\n    this.currentMotor.driver = {\n      ...this.currentMotor.driver,\n      lastname: driverLastName,\n      firstname: driverName\n    };\n\n    if (gnc) {\n      const currentPackage = this.currentMotor.packages.find(\n        (pkg) => pkg.selected\n      );\n      this.flowRouteEmissionService.enableRoute(this.routes, 'payment-method');\n\n      this.storeEmission.dispatch(\n        new fromEmissionActions.SetActiveRoute('payment-method')\n      );\n\n      this.routes.forEach((element) => {\n        if (element.path === 'aditionalauto') {\n          element.value =\n            this.form.get('chassisNumber').value.toString().toUpperCase() +\n            ' - ' +\n            this.form.get('engineNumber').value.toString().toUpperCase();\n        }\n      });\n\n      this.vehicles.forEach((v) => {\n        if (v.number === this.currentMotor.number) {\n          v.driver.lastname = this.formClient.get('driverLastName').value;\n          v.driver.firstname = this.formClient.get('driverName').value;\n          v.license = this.form.get('patent').value.toString().toUpperCase();\n          v.motor = this.form.get('engineNumber').value;\n          v.chasis = this.form.get('chassisNumber').value;\n          if (this.applyBondHolderFlag) {\n            v.bondholder.type = this.form.get('bondHolderType').value;\n            v.bondholder.quotas = this.form.get('bondHolderQuotas').value;\n          } else {\n            v.bondholder.type = null;\n            v.bondholder.quotas = null;\n          }\n        }\n      });\n\n      currentPackage.coverages = currentPackage.coverages.filter(\n        (cov) => cov.pattern.code !== this._CODE_GNC\n      );\n    }\n\n    this.storePolicy.dispatch(\n      new fromPolicyActions.UpdateVehicleAction(this.vehicles)\n    );\n\n    // En caso de no ser el último vehículo, paso al siguiente\n    if (this.currentMotor.number < this.vehicles.length) {\n      this.router.navigateByUrl(\n        `quoting/emission/questions/aditionalauto/${\n          this.currentMotor.number + 1\n        }`\n      );\n      return;\n    }\n\n    // En caso de ser el último vehículo, voy a método de pago\n    this.flowRouteEmissionService.enableRoute(this.routes, 'payment-method');\n\n    this.storeEmission.dispatch(\n      new fromEmissionActions.SetActiveRoute('payment-method')\n    );\n\n    if (this.form.valid) {\n      this.storeEmission.dispatch(\n        new fromEmissionActions.SetFormEmissionOthersIsValidAction(true)\n      );\n    }\n\n    // Cambio el nombre del título de la ruta\n    this.changeRouteTitleValue();\n\n    this.router.navigateByUrl('quoting/emission/questions/payment-method');\n  }\n\n  /**\n   * Change title for aditional route\n   *\n   * @memberof OthersMotorComponent\n   */\n  changeRouteTitleValue() {\n    const aditionalRoute = this.routes.find((route) =>\n      route.path.includes('aditionalauto')\n    );\n\n    const { license, chasis, motor } = this.currentMotor;\n\n    aditionalRoute.value = `${\n      this.vehicles.length > 0 ? license.toUpperCase() + ': ' : ''\n    }${chasis.toUpperCase()} - ${motor.toUpperCase()}`;\n  }\n\n  closeModalNoGNC() {\n    this.form.patchValue(\n      {\n        gnc: false\n      },\n      { onlySelf: true, emitEvent: true }\n    );\n    this.modalNoGNC.closeModal();\n  }\n\n  openModalNoGNC() {\n    this.modalNoGNC.openModal();\n  }\n\n  redirectCoverage() {\n    const pckCode = this.currentMotor.packages.filter((op) => op.selected)[0]\n      .code;\n    this.modalNoGNC.closeModal();\n    this.router.navigateByUrl(\n      'quoting/coverage/' + this.currentMotor.id + '/modal/' + pckCode\n    );\n  }\n  /**\n   * Control lottie animation\n   */\n  animationCreated(animationItem: AnimationItem): void {\n    this.buttonAnimated = animationItem;\n  }\n\n  closeModalPatentInUse() {\n    this.loadingPatent = false;\n    this.buttonAnimated.playSegments([[120, 175]], false);\n    this.buttonLabel = 'Validar';\n    this.modalPatentInUse.closeModal();\n  }\n\n  openModalPatentInUse() {\n    this.modalPatentInUse.openModal();\n  }\n\n  closeUWModal(action?: string) {\n    if (action === 'continue') {\n      this.modalUW.closeModal();\n      return;\n    }\n    this.loadingPatent = false;\n    this.buttonAnimated.playSegments([[120, 175]], false);\n    this.buttonLabel = 'Validar';\n\n    this.form.get('patent').setValue('');\n    this.modalUW.closeModal();\n  }\n}\n","<div class=\"details sticky-top p-3\">\n  <div class=\"row\">\n    <div class=\"row ml-0\">\n      <div class=\"col-lg-12 pt-3\">\n        <span class=\"title\" *ngIf=\"(vehicles$ | async)?.length === 1\">\n          {{ (packageSelectedWithAssistance$ | async)?.package?.description }}\n        </span>\n        <span class=\"title\" *ngIf=\"(vehicles$ | async)?.length > 1\">\n          Resumen\n        </span>\n      </div>\n    </div>\n    <div\n      class=\"col-lg-12\"\n      style=\"position: relative; height: calc(90vh - 80px);\"\n      [perfectScrollbar]=\"{ suppressScrollY: false }\"\n    >\n      <div class=\"row mt-2\" *ngIf=\"(vehicles$ | async)?.length === 1\">\n        <!-- <div class=\"col-lg-4\">\n          <a class=\"show-detail\">Ver detalle</a>\n        </div> -->\n        <div *ngIf=\"!disabledByRetrieve\" class=\"col-lg-6\">\n          <a\n            style=\"cursor: pointer;\"\n            (click)=\"goCoverage()\"\n            class=\"change-coverage\"\n          >\n            Cambio de cobertura\n          </a>\n        </div>\n        <div\n          *ngIf=\"\n            disabledByRetrieve &&\n            (vehicles$ | async)?.length < 2 &&\n            !getQuoteApproved\n          \"\n          class=\"col-lg-6\"\n        >\n          <a\n            style=\"cursor: pointer;\"\n            (click)=\"openModal()\"\n            class=\"change-coverage\"\n          >\n            Editar cotización\n          </a>\n        </div>\n      </div>\n\n      <div class=\"row mt-2\" *ngIf=\"(vehicles$ | async)?.length > 1\">\n        <div class=\"col-lg-12\">\n          <div class=\"quantityVehicles\">\n            <span>\n              {{ (vehicles$ | async)?.length }}\n              Vehículos\n            </span>\n            <a\n              style=\"cursor: pointer;\"\n              (click)=\"openVehicleDetails()\"\n              class=\"show-detail\"\n            >\n              Ver todos\n            </a>\n          </div>\n        </div>\n      </div>\n      <div class=\"row item-title mt-4\">\n        <div class=\"col-lg-6\">\n          <span>Código de Productor</span>\n        </div>\n        <div class=\"col-lg-6\">\n          <span>Productor</span>\n        </div>\n      </div>\n      <div class=\"row\">\n        <div class=\"col-lg-6\">\n          <span>\n            {{ currentproducer.code }}\n          </span>\n        </div>\n        <div class=\"col-lg-6\">\n          <span>\n            {{ currentproducer.description }}\n          </span>\n        </div>\n      </div>\n      <!-- Asistencia mecánica -->\n      <div\n        class=\"row item-title mt-4\"\n        *ngIf=\"(vehicles$ | async)?.length === 1\"\n      >\n        <div class=\"col-lg-6\">\n          <span>{{ (brandModelPrizeCar$ | async).type | titlecase }}</span>\n        </div>\n        <div class=\"col-lg-6\">\n          <span>Asistencia mecánica</span>\n        </div>\n      </div>\n      <div class=\"row\" *ngIf=\"(vehicles$ | async)?.length === 1\">\n        <div class=\"col-lg-6\">\n          <span>\n            {{ (brandModelPrizeCar$ | async)?.brand }}\n            {{ (brandModelPrizeCar$ | async)?.model }}\n          </span>\n        </div>\n        <div class=\"col-lg-6\">\n          <span>\n            {{\n              getAssistanceDescription(\n                (packageSelectedWithAssistance$ | async)?.assistance\n              ) | async\n            }}\n          </span>\n        </div>\n      </div>\n      <!-- Fin Asistencia mecánica-->\n\n      <!-- Suma asegurada 1 vehículo -->\n      <div\n        class=\"row item-title mt-4\"\n        *ngIf=\"(vehicles$ | async)?.length === 1\"\n      >\n        <div class=\"col-lg-6\">\n          <span>Suma asegurada</span>\n        </div>\n        <div class=\"col-lg-6\">\n          <span>Refacturación</span>\n        </div>\n      </div>\n      <div class=\"row\" *ngIf=\"(vehicles$ | async)?.length === 1\">\n        <div class=\"col-lg-6\">\n          <span>\n            $ {{ (brandModelPrizeCar$ | async)?.prize | number: '1.0-0' }}\n          </span>\n        </div>\n        <div class=\"col-lg-6\">\n          <span>\n            {{ rebillingPeriod$ | async }}\n          </span>\n        </div>\n      </div>\n      <!-- Fin suma asegurada 1 vehículo-->\n\n      <!-- condición fiscal 1 vehículo -->\n      <div\n        class=\"row item-title mt-4\"\n        *ngIf=\"(vehicles$ | async)?.length === 1\"\n      >\n        <div class=\"col-lg-6\">\n          <span>Condición fiscal</span>\n        </div>\n        <div class=\"col-lg-6\"></div>\n      </div>\n      <div class=\"row\" *ngIf=\"(vehicles$ | async)?.length === 1\">\n        <div class=\"col-lg-6\">\n          <span>\n            {{ fiscalCondition$ | async }}\n          </span>\n        </div>\n        <div class=\"col-lg-6\">\n          <ng-template #tipContent>\n            <table class=\"table-sm\">\n              <tbody>\n                <tr *ngFor=\"let item of (additionals$ | async)?.additionals\">\n                  <td style=\"border-bottom: solid 1px;\">\n                    {{ item.pattern.description }}\n                  </td>\n                  <td style=\"border-bottom: solid 1px;\">\n                    <b>\n                      $\n                      {{\n                        item.terms[0].value?.current || item.terms[0].value\n                          | number: '1.0-0'\n                      }}\n                    </b>\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </ng-template>\n          <div\n            class=\"input-group\"\n            [ngbTooltip]=\"\n              (additionals$ | async)?.additionalsLenght > 0 ? tipContent : ''\n            \"\n            style=\"margin-top: -15px;\"\n          >\n            <input\n              readonly\n              style=\"cursor: pointer;\"\n              type=\"text\"\n              class=\"form-control\"\n              value=\"{{\n                (additionals$ | async)?.additionalsLenght\n              }} adicionales\"\n            />\n            <div class=\"input-group-append\">\n              <span class=\"input-group-text\">\n                <sxf-icon class=\"icon-blue\" type=\"view\"></sxf-icon>\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n      <!-- Fin condición fiscal 1 vehículo -->\n\n      <!-- Condición Fiscal 2 a 4 vehículos -->\n      <div class=\"row item-title mt-4\" *ngIf=\"(vehicles$ | async)?.length > 1\">\n        <div class=\"col-lg-6\">\n          <span>Condición fiscal</span>\n        </div>\n        <div class=\"col-lg-6\">\n          <span>Refacturación</span>\n        </div>\n      </div>\n      <div class=\"row\" *ngIf=\"(vehicles$ | async)?.length > 1\">\n        <div class=\"col-lg-6\">\n          <span>\n            {{ fiscalCondition$ | async }}\n          </span>\n        </div>\n        <div class=\"col-lg-6\">\n          <span>\n            {{ rebillingPeriod$ | async }}\n          </span>\n        </div>\n      </div>\n      <!-- Fin Condición Fiscal 2 a 4 vehículos-->\n\n      <!-- Medio de pago 2 a 4 vehículos -->\n      <div class=\"row item-title mt-4\" *ngIf=\"(vehicles$ | async)?.length > 1\">\n        <div class=\"col-lg-6\">\n          <span>Medio de pago</span>\n        </div>\n        <div class=\"col-lg-6\"><span>Cuotas</span></div>\n      </div>\n      <div class=\"row\" *ngIf=\"(vehicles$ | async)?.length > 1\">\n        <div class=\"col-lg-6\">\n          <span>\n            {{ (paymentMethod$ | async)?.description }}\n          </span>\n        </div>\n        <div class=\"col-lg-6\">\n          <span>\n            {{ (paymentPlan$ | async)?.description }}\n          </span>\n        </div>\n      </div>\n      <!-- Fin Medio de pago 2 a 4 vehículos-->\n\n      <div class=\"row item-title mt-4\">\n        <div class=\"col-lg-6\">\n          <span>Dto</span>\n        </div>\n        <div class=\"col-lg-6\">\n          <span>Comisión</span>\n        </div>\n      </div>\n      <div class=\"row mb-1\">\n        <div class=\"col-lg-6\">\n          <span>{{ (discountAndCommission$ | async)?.discount || 0 }}%</span>\n        </div>\n        <div class=\"col-lg-6\">\n          <span>{{ (discountAndCommission$ | async)?.commission || 0 }}%</span>\n        </div>\n      </div>\n      <div class=\"row\" *ngIf=\"campaign$ | async as c\">\n        <div class=\"col-lg-12\">\n          <label for=\"campaign\">Campaña</label>\n          <sxf-select\n            #campaign\n            disabledOnEmpty=\"true\"\n            [formControl]=\"formCampaign\"\n            [items]=\"c\"\n            bindLabel=\"description\"\n            bindValue=\"id\"\n            [multiple]=\"false\"\n            [class]=\"'custom'\"\n            [searchable]=\"false\"\n            [placeholder]=\"'Seleccione campaña'\"\n            [dropdownPosition]=\"'bottom'\"\n            name=\"campaign\"\n          ></sxf-select>\n        </div>\n      </div>\n      <div class=\"row mt-3\">\n        <div class=\"col-lg-12\">\n          <div class=\"tsummary mb-3\">\n            <table\n              *ngIf=\"packageSelectedWithAssistance$ | async as packageSelected\"\n              class=\"table table-sm table-borderless\"\n            >\n              <tbody>\n                <tr>\n                  <td>Dcto. promocional</td>\n                  <th class=\"text-right\">\n                    ${{ packageSelected?.cost?.discount | number: '1.0-0' }}\n                  </th>\n                </tr>\n                <tr>\n                  <td>Prima Comisionable</td>\n                  <th class=\"text-right\">\n                    $\n                    {{\n                      packageSelected?.package?.premiums?.total\n                        | number: '1.0-0'\n                    }}\n                  </th>\n                </tr>\n                <tr>\n                  <td colspan=\"2\" class=\"costs-details\">\n                    <div class=\"main\">\n                      <div>Premio total</div>\n                      <sxf-icon\n                        [class]=\"\n                          expandedDetail ? 'icon-down' : 'icon-arrow-left'\n                        \"\n                        (click)=\"expandedDetail = !expandedDetail\"\n                      ></sxf-icon>\n                      <div>\n                        $ {{ packageSelected?.cost?.total | number: '1.0-0' }}\n                      </div>\n                    </div>\n                    <div class=\"childrens\" *ngIf=\"expandedDetail\">\n                      <div class=\"child\">\n                        <div>Gastos de adquisición</div>\n                        <div>\n                          $\n                          {{\n                            packageSelected?.cost?.administrativecharge\n                              | number: '1.0-0'\n                          }}\n                        </div>\n                      </div>\n                      <div class=\"child\">\n                        <div>Gastos de explotación</div>\n                        <div>\n                          $\n                          {{\n                            packageSelected?.cost?.submissionfee +\n                              packageSelected?.package?.premiums?.assistance\n                              | number: '1.0-0'\n                          }}\n                        </div>\n                      </div>\n                      <div class=\"child\">\n                        <div>Prima total (GWP)</div>\n                        <div>\n                          $\n                          {{\n                            packageSelected?.package?.premiums?.total +\n                              packageSelected?.cost?.submissionfee +\n                              packageSelected?.package?.premiums?.assistance +\n                              packageSelected?.cost?.administrativecharge\n                              | number: '1.0-0'\n                          }}\n                        </div>\n                      </div>\n                      <div class=\"child\">\n                        <div>Regargo financiero</div>\n                        <div>\n                          $\n                          {{\n                            packageSelected?.cost?.financial | number: '1.0-0'\n                          }}\n                        </div>\n                      </div>\n                      <div class=\"child\">\n                        <div>Impuestos internos</div>\n                        <div>\n                          $\n                          {{\n                            packageSelected?.cost?.internaltax | number: '1.0-0'\n                          }}\n                        </div>\n                      </div>\n                      <div class=\"child\">\n                        <div>Tasa SSN</div>\n                        <div>\n                          $\n                          {{ packageSelected?.cost?.ssnrate | number: '1.0-0' }}\n                        </div>\n                      </div>\n                      <div class=\"child\">\n                        <div>Servicios sociales</div>\n                        <div>\n                          $\n                          {{\n                            packageSelected?.cost?.socialservice\n                              | number: '1.0-0'\n                          }}\n                        </div>\n                      </div>\n                      <div class=\"child\">\n                        <div>Seguridad vial</div>\n                        <div>\n                          $\n                          {{\n                            packageSelected?.cost?.vialrate | number: '1.0-0'\n                          }}\n                        </div>\n                      </div>\n                      <div class=\"child\">\n                        <div>Sellados</div>\n                        <div>\n                          $\n                          {{\n                            packageSelected?.cost?.sellado?.total\n                              | number: '1.0-0'\n                          }}\n                        </div>\n                      </div>\n                      <div class=\"child\">\n                        <div>IVA</div>\n                        <div>\n                          $\n                          {{\n                            packageSelected?.cost?.iva?.total | number: '1.0-0'\n                          }}\n                        </div>\n                      </div>\n                    </div>\n                  </td>\n                </tr>\n                <tr>\n                  <td>Cuota</td>\n                  <th class=\"text-right\">\n                    $ {{ packageSelected?.cost?.invoice | number: '1.0-0' }}\n                  </th>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div\n    class=\"row py-3\"\n    style=\"\n      box-shadow: 0px -1px 4px rgba(0, 0, 0, 0.18);\n      position: fixed;\n      bottom: 0;\n      width: 25%;\n      height: auto;\n      background: #ffffff;\n      z-index: 2000;\n    \"\n  >\n    <div class=\"col-lg-12\">\n      <button\n        [disabled]=\"\n          (formsValid$ | async) || (payment$ | async) || (loadingIssue$ | async)\n        \"\n        (click)=\"checkUW()\"\n        class=\"continue btn btn-primary btn-lg btn-block btn-next-screen\"\n      >\n        <span *ngIf=\"(loadingIssue$ | async) !== true\">Contratar</span>\n        <span *ngIf=\"loadingIssue$ | async\">\n          Contratando\n          <ng-lottie\n            [options]=\"lottieConfig\"\n            width=\"4.75rem\"\n            height=\"2.25rem\"\n          ></ng-lottie>\n        </span>\n      </button>\n    </div>\n  </div>\n</div>\n\n<sxf-modal #childComp>\n  <div class=\"modal-header\">\n    <h4 class=\"modal-title\" id=\"modal-basic-title\">\n      Error\n    </h4>\n    <button\n      type=\"button\"\n      class=\"close\"\n      aria-label=\"Close\"\n      (click)=\"closeModal()\"\n    >\n      <span aria-hidden=\"true\">&times;</span>\n    </button>\n  </div>\n  <div class=\"modal-body\">\n    <p>{{ (issueError$ | async)?.description }}</p>\n  </div>\n  <div class=\"modal-footer\" *ngIf=\"issueError$ | async as issue\">\n    <div class=\"offset-8 col-4\">\n      <button\n        type=\"button\"\n        class=\"btn btn-primary btn-lg btn-block\"\n        (click)=\"issue.code === 105 ? goThankYouPage() : closeModal()\"\n      >\n        Aceptar\n      </button>\n    </div>\n  </div>\n</sxf-modal>\n\n<sxf-modal #vehicleDetails [options]=\"{ size: 'xl' }\">\n  <div class=\"modal-header modal-header-items\">\n    <div class=\"modal-vehicle-title\" id=\"modal-basic-title\">\n      Autos a asegurar\n    </div>\n    <button\n      type=\"button\"\n      class=\"close\"\n      aria-label=\"Close\"\n      (click)=\"closeVehicleDetails()\"\n      name=\"closeModalBtn\"\n    >\n      <span aria-hidden=\"true\">&times;</span>\n    </button>\n  </div>\n  <br />\n  <div class=\"modal-body modal-body-items\">\n    <table\n      class=\"details-table\"\n      id=\"details-table\"\n      style=\"max-width: 100%; min-width: 100%; width: 100%;\"\n    >\n      <tr *ngFor=\"let vehicles of vehicles$ | async\">\n        <td width=\"17%\">\n          <b>{{ vehicles.brand.description }} {{ vehicles.year }}</b>\n          <br />\n          {{ vehicles.model.description }}\n        </td>\n        <td width=\"17%\">\n          Suma asegurada\n          <br />\n          <b>\n            $\n            {{\n              vehicles.statedamount || vehicles.model.statementamount\n                | number: '1.0-0'\n            }}\n          </b>\n        </td>\n        <td width=\"17%\">\n          Cobertura\n          <br />\n          <b>{{ getSelectedPackage(vehicles) }}</b>\n        </td>\n        <td width=\"17%\">\n          Asistencia mecánica\n          <br />\n          <b>{{ getSelectedMechanicalAssistance(vehicles) }}</b>\n        </td>\n        <td width=\"15%\">\n          <ng-template #tooltipContent>\n            <table class=\"additional-table\">\n              <tbody>\n                <tr *ngFor=\"let item of getSelectedAdditionals(vehicles)\">\n                  <td>\n                    {{ item.pattern.description }}\n                  </td>\n                  <td>\n                    <b>\n                      $\n                      {{\n                        item.terms[0].value?.current || item.terms[0].value\n                          | number: '1.0-0'\n                      }}\n                    </b>\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </ng-template>\n          <div class=\"input-group\">\n            <input\n              readonly\n              style=\"cursor: pointer;\"\n              type=\"text\"\n              class=\"form-control\"\n              value=\"{{ getSelectedAdditionals(vehicles).length }} adicionales\"\n            />\n            <div class=\"input-group-append\" id=\"detail-tooltip\">\n              <span\n                class=\"input-group-text\"\n                [ngbTooltip]=\"\n                  getSelectedAdditionals(vehicles).length > 0\n                    ? tooltipContent\n                    : ''\n                \"\n                placement=\"bottom\"\n              >\n                <sxf-icon class=\"icon-green\" type=\"view\"></sxf-icon>\n              </span>\n            </div>\n          </div>\n        </td>\n        <td width=\"17%\" class=\"text-center\" *ngIf=\"!disabledByRetrieve\">\n          <a\n            class=\"edit-vehicle-coverage\"\n            (click)=\"goCoverageVehicles(vehicles.id)\"\n          >\n            Editar\n          </a>\n        </td>\n      </tr>\n    </table>\n  </div>\n</sxf-modal>\n<sxf-modal\n  #modalEditCoverage\n  [options]=\"{ backdrop: 'static', keyboard: false }\"\n>\n  <div class=\"modal-header\" style=\"padding-bottom: 25px !important;\">\n    <h4\n      style=\"\n        padding-left: 15px;\n        font-size: 18px !important;\n        font-weight: 700;\n        color: #0033a0;\n      \"\n      id=\"modal-basic-title\"\n    >\n      Editar cotización\n    </h4>\n    <button\n      type=\"button\"\n      class=\"close closeButtom\"\n      aria-label=\"Close\"\n      (click)=\"closeModal()\"\n      name=\"closeModalBtn\"\n      style=\"padding-top: 15px; padding-right: 63px; padding-bottom: 0px;\"\n    >\n      <span style=\"font-size: 3rem; color: #06369e;\" aria-hidden=\"true\">\n        &times;\n      </span>\n    </button>\n  </div>\n  <div class=\"modal-body\">\n    <div class=\"col-lg-10\">\n      <h4 class=\"modal-title\" style=\"font-size: 2rem !important;\">\n        Al editar cualquier dato de la cotización, se recotizará con las tarifas\n        actuales. ¿Querés editarla de todos modos?\n      </h4>\n    </div>\n  </div>\n\n  <div class=\"modal-footer\" style=\"padding-top: 54px !important;\">\n    <div class=\"row\">\n      <div class=\"col-lg-4 offset-lg-3 pl-0\">\n        <button\n          type=\"button\"\n          class=\"btn btn-modal btn-lg btn-block\"\n          (click)=\"modalEditCoverage.closeModal()\"\n        >\n          Cancelar\n        </button>\n      </div>\n      <div class=\"col-lg-5 pl-0\">\n        <button\n          type=\"button\"\n          class=\"btn btn-primary btn-lg btn-block\"\n          (click)=\"goQuote()\"\n        >\n          <span>Editar Cotización</span>\n        </button>\n      </div>\n    </div>\n  </div>\n</sxf-modal>\n","import { Component, OnInit, ViewChild, OnDestroy } from '@angular/core';\nimport * as fromQuoteActions from '../../../quote/state/quote.actions';\nimport * as fromPolicy from '../../../../state/policy';\nimport * as fromPolicyActions from '../../../../state/policy/policy.actions';\nimport * as fromEmission from '../../../emission/state';\nimport * as fromEmissionActions from '../../../emission/state/emission.actions';\nimport { Store } from '@ngrx/store';\nimport * as fromProducer from '../../../../../producer/state';\nimport * as fromProducerActions from '../../../../../producer/state/producer.actions';\nimport {\n  IPolicy,\n  QuotingService,\n  FiscalConditionService,\n  IVehicle,\n  PaymentValidations,\n  ICampaign,\n  PaymentMethodService,\n  PaymentPlansService,\n  IPaymentPlan\n} from '@sura-platform/features';\nimport { IPackage } from '@sura-platform/features/package';\nimport { Router } from '@angular/router';\nimport {\n  Observable,\n  Subject,\n  combineLatest,\n  of,\n  Subscription,\n  EMPTY\n} from 'rxjs';\nimport { ModalComponent } from '@sura-platform/web';\nimport * as fromQuote from '../../../quote/state';\nimport {\n  switchMap,\n  map,\n  share,\n  tap,\n  first,\n  distinctUntilKeyChanged\n} from 'rxjs/operators';\nimport { AnimationOptions } from 'ngx-lottie';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { NotificationService } from '@sura-platform/core/services/notification.service';\nimport { QuoteIssueAdapter } from '../../../../adapters/quote-issue.adapter';\nimport { FormControl } from '@angular/forms';\nimport { BACKEND_ERRORS } from '@sura-platform/core/error/error.enum';\nimport { ProducerService, IProducer } from '@sura-platform/features/producer';\n@Component({\n  selector: 'sxf-details',\n  templateUrl: './details.component.html',\n  styleUrls: ['./details.component.scss']\n})\nexport class DetailsComponent implements OnInit, OnDestroy {\n  lottieConfig: AnimationOptions = {\n    path: '/assets/loadings/sura-loader.json'\n  };\n  @ViewChild('childComp') child_component: ModalComponent = <ModalComponent>{};\n  @ViewChild('uwEmision') uwEmision: ModalComponent = <ModalComponent>{};\n  @ViewChild('vehicleDetails') vehicleDetails: ModalComponent = <\n    ModalComponent\n  >{};\n  @ViewChild('modalEditCoverage') modalEditCoverage: ModalComponent = <\n    ModalComponent\n  >{};\n  /**\n   * variable to get policy from store\n   */\n  currentPolicy: IPolicy = <IPolicy>{};\n  currentMotor: IVehicle = <IVehicle>{};\n  packageSelected: IPackage = <IPackage>{};\n\n  /**\n   * Variable to get mechanicalAssistance\n   */\n  mechanicalAssistance: string | null = null;\n\n  isFromRetrieve: boolean | null = null;\n  fromRetrieve = false;\n  issueError$: Observable<any> = new Observable();\n  subject: Subject<any> = new Subject();\n  loadingIssue$: Subject<boolean> = new Subject();\n  loadingFromRetrieve$: Observable<boolean> | null = null;\n  additionals: any;\n  /**\n   * All vehicles\n   *\n   * @type {Observable<IVehicle[]>}\n   * @memberof DetailsComponent\n   */\n  vehicles$: Observable<IVehicle[]> = new Observable();\n  packageSelectedWithAssistance$: Observable<any> = new Observable();\n  brandModelPrizeCar$: Observable<any> = new Observable();\n  rebillingPeriod$: Observable<any> = new Observable();\n  fiscalCondition$: Observable<any> = new Observable();\n  additionals$: Observable<any> = new Observable();\n  discountAndCommission$: Observable<any> = new Observable();\n  campaign$: Observable<ICampaign[]> = new Observable();\n  installments$: Observable<any> = new Observable();\n  payment$: Observable<any> = new Observable();\n  formsValid$: Observable<any> = new Observable();\n  expandedDetail: boolean | null = null;\n  getQuoteApproved = false;\n\n  /**\n   *  Payment Methods on Emission\n   *\n   * @type {Observable<any>}\n   * @memberof DetailsComponent\n   */\n  paymentMethod$: Observable<any> = new Observable();\n\n  /**\n   * Payment Plan on Emission\n   *\n   * @type {Observable<any>}\n   * @memberof DetailsComponent\n   */\n  paymentPlan$: Observable<any> = new Observable();\n\n  /**\n   * Subscription to emission store\n   *\n   * @type {Subscription}\n   * @memberof DetailsComponent\n   */\n  emissionStoreSubscription: Subscription = new Subscription();\n\n  emissionStoreSubscriptionRetrieve: Subscription = new Subscription();\n  policyStoreProducerSubscription: Subscription = new Subscription();\n  producerServiceSubscription: Subscription = new Subscription();\n  policyStoreSubscription: Subscription = new Subscription();\n  producerStoreSubscription: Subscription = new Subscription();\n\n  /**\n   * If true then when 'Contratar' is pressed,\n   * quotes/issues/bind is called else issues is called\n   *\n   * @memberof DetailsComponent\n   */\n  isApprovedEmission = false;\n\n  /**\n   * If true, then we cannot change the coverage type\n   *\n   * @type {boolean}\n   * @memberof DetailsComponent\n   */\n  disabledByRetrieve: boolean | null = null;\n  //\n  /**\n   * FormControl for campaign\n   *\n   * @memberof DetailsComponent\n   */\n  formCampaign = new FormControl({ value: '', disabled: true });\n  updateCostSubscription: Subscription = new Subscription();\n  producerSubscription: Subscription = new Subscription();\n\n  currentproducer: IProducer = <IProducer>{};\n\n  constructor(\n    private producerService: ProducerService,\n    private router: Router,\n    private storePolicy: Store<fromPolicy.State>,\n    private storeEmission: Store<fromEmission.State>,\n    private quotingService: QuotingService,\n    private storeQuote: Store<fromQuote.State>,\n    private fiscalConditionService: FiscalConditionService,\n    private notificationService: NotificationService,\n    private quoteIssueAdapter: QuoteIssueAdapter,\n    private paymentMethodService: PaymentMethodService,\n    private paymentPlansService: PaymentPlansService,\n    private producerStore: Store<fromProducer.State>,\n    private storeProducer: Store<fromProducer.State>\n  ) {}\n\n  ngOnInit() {\n    this.loadingIssue$.next(false);\n    this.loadingFromRetrieve$ = combineLatest([\n      this.storeEmission.select(fromEmission.getJobNumber),\n      this.storePolicy.select(fromPolicy.getClientData)\n    ]).pipe(\n      switchMap((x) => {\n        const job = x[0];\n        const client = x[1];\n\n        this.isFromRetrieve = job ? true : false;\n\n        if (job && !client.documentNumber) {\n          return of(false);\n        }\n\n        return of(true);\n      })\n    );\n    this.emissionStoreSubscriptionRetrieve = this.storeEmission\n      .select(fromEmission.getEmission)\n      .subscribe((store) => {\n        this.fromRetrieve = store.jobNumberFromQuotes ? true : false;\n      });\n    if (this.fromRetrieve) {\n      this.policyStoreSubscription = this.storePolicy\n        .select(fromPolicy.getPolicyData)\n        .subscribe((data) => {\n          this.storeProducer.dispatch(\n            new fromProducerActions.SetCurrentProducerAction(data.producer.code)\n          );\n\n          this.producerServiceSubscription = this.producerService\n            .getProfile(data.producer.code)\n            .subscribe((producer) => {\n              this.storeProducer.dispatch(\n                new fromProducerActions.SetCurrentProducerProfile(producer)\n              );\n            });\n        });\n    }\n    this.producerSubscription = this.producerStore\n      .select(fromProducer.getCurrentProducer)\n      .subscribe((data: IProducer) => {\n        this.currentproducer = data;\n      });\n    this.formsValid$ = combineLatest([\n      this.storeEmission.select(fromEmission.getFormClientIsValid),\n      this.storeEmission.select(fromEmission.getFormResidenceIsValid),\n      this.storeEmission.select(fromEmission.getFormTaxIsValid),\n      this.storeEmission.select(fromEmission.getFormValidityIsValid),\n      this.storeEmission.select(fromEmission.getFormOtherIsValid)\n    ]).pipe(\n      switchMap((x) => {\n        if (x[0] && x[1] && x[2] && x[3] && x[4]) {\n          return of(false);\n        } else {\n          return of(true);\n        }\n      })\n    );\n    this.payment$ = this.storePolicy.select(fromPolicy.getPolicyData).pipe(\n      switchMap((x) => {\n        if (x.payment.id !== null) {\n          return of(false);\n        } else {\n          const paymentValidation = new PaymentValidations(x.payment);\n          if (\n            paymentValidation.completeModel() &&\n            paymentValidation.validatePayment()\n          )\n            return of(false);\n        }\n        return of(true);\n      })\n    );\n\n    this.vehicles$ = this.storePolicy.select(fromPolicy.getPolicyData).pipe(\n      switchMap((x) => {\n        const vehicles = x.motor.vehicles;\n        return of(vehicles);\n      })\n    );\n\n    this.packageSelectedWithAssistance$ = combineLatest([\n      this.storePolicy.select(fromPolicy.getPolicyData),\n      this.storeQuote.select(fromQuote.getQuoteMotorData),\n      this.storeEmission.select(fromEmission.getJobNumber),\n      this.storeQuote.select(fromQuote.getQuoteApproved)\n    ]).pipe(\n      switchMap((x) => {\n        // Se usa para el boton contratar.\n        this.currentPolicy = x[0];\n        this.currentMotor = x[0].motor.vehicles.find(\n          (c) => c.number === x[1].activeMotor\n        ) as IVehicle;\n        const currentMotor = x[0].motor.vehicles.find(\n          (c) => c.number === x[1].activeMotor\n        );\n        this.getQuoteApproved = x[3];\n        // SI NO TENGO AUTO\n        if (currentMotor?.year === null) {\n          return of({});\n        }\n\n        const packageSelected = currentMotor?.packages?.find(\n          (pk) => pk.selected\n        );\n\n        const assistance = packageSelected?.coverages?.find(\n          (cov) => cov.pattern.code === 'SURA_CA7_AsistenciaMecanicaCov'\n        );\n\n        const currentCost = this.currentPolicy?.costs[0];\n\n        return of({\n          package: packageSelected,\n          assistance: assistance\n            ? assistance.terms[0]?.value?.current\n            : 'NoAssistance',\n          cost: currentCost\n        });\n      })\n    );\n\n    //FIXME: Habilitar esto cuando se suba emisión\n    // this.updateCostSubscription = combineLatest([\n    //   this.storeQuote.select(fromQuote.getCosts),\n    //   this.storePolicy.select(fromPolicy.getCosts).pipe(\n    //     switchMap((c) => of(c[0]?.externalId)),\n    //     distinctUntilChanged()\n    //   )\n    // ]).subscribe(([newCosts, currentCost]) => {\n    //   if (currentCost) {\n    //     const newCost = newCosts.filter((c) => c.externalId === currentCost);\n\n    //     if (newCost.length > 0) {\n    //       this.storePolicy.dispatch(\n    //         new fromPolicyActions.UpdateCostsAction(newCost)\n    //       );\n    //     }\n    //   }\n    // });\n\n    this.additionals$ = combineLatest([\n      this.storePolicy.select(fromPolicy.getPolicyData),\n      this.storeQuote.select(fromQuote.getQuoteMotorData)\n    ]).pipe(\n      switchMap((x) => {\n        const currentMotor = x[0].motor.vehicles.filter(\n          (c) => c.number === x[1].activeMotor\n        )[0];\n\n        // SI NO TENGO AUTO\n        if (currentMotor.year === null) {\n          return of({\n            additionalsLenght: 0,\n            additionals: []\n          });\n        }\n\n        const additionalsList = currentMotor?.packages\n          ?.find((pk) => pk.selected)\n          ?.coverages?.filter(\n            (cov) =>\n              cov.pattern.code !== 'SURA_CA7_ClausulaDeAjusteCov' &&\n              cov.pattern.code !== 'SURA_CA7_AsistenciaMecanicaCov' &&\n              !cov.pattern.code.startsWith('SURA_CA7_Mobility')\n          )\n          .filter(\n            (cov: any) =>\n              cov.category.code === 'SURA_CA7_CobAdicionalesGrp' ||\n              cov.category.code === 'SURA_CA7_AccesoriosGrp'\n          );\n\n        return of({\n          additionalsLenght: additionalsList?.length,\n          additionals: additionalsList\n        });\n      })\n    );\n\n    this.brandModelPrizeCar$ = combineLatest([\n      this.storePolicy.select(fromPolicy.getPolicyData),\n      this.storeQuote.select(fromQuote.getQuoteMotorData)\n    ]).pipe(\n      switchMap((x) => {\n        const currentMotor = x[0].motor.vehicles.filter(\n          (c) => c.number === x[1].activeMotor\n        )[0];\n\n        // SI NO TENGO AUTO\n        if (currentMotor.year === null) {\n          return of({});\n        }\n\n        return of({\n          type: currentMotor.group,\n          brand: currentMotor?.brand?.description,\n          model: currentMotor?.model?.description,\n          //! ML: Esto hay que verificarlo\n          prize:\n            currentMotor.statedamount || currentMotor?.model?.statementamount\n        });\n      })\n    );\n\n    this.rebillingPeriod$ = this.storePolicy\n      .select(fromPolicy.getPolicyData)\n      .pipe(\n        switchMap((x) => {\n          let periodMethod = '';\n          switch (x.period.method) {\n            case 'Sura_ThreeMonths':\n              periodMethod = 'Trimestral';\n              break;\n            case 'HalfYear':\n              periodMethod = 'Semestral';\n              break;\n            case 'Sura_OneMonth':\n              periodMethod = 'Mensual';\n              break;\n            case 'Annual':\n              periodMethod = 'Anual';\n              break;\n            default:\n              break;\n          }\n          return of(periodMethod);\n        })\n      );\n\n    this.fiscalCondition$ = combineLatest([\n      this.storePolicy.select(fromPolicy.getPolicyData),\n      this.fiscalConditionService.getAllFiscalCondition()\n    ]).pipe(\n      switchMap((x) => {\n        const fiscalCondition = x[1].filter(\n          (f) => f.code === x[0].fiscalcondition\n        )[0].description;\n        return of(fiscalCondition);\n      })\n    );\n\n    this.discountAndCommission$ = this.storePolicy\n      .select(fromPolicy.getPolicyData)\n      .pipe(\n        switchMap((x) => {\n          const discount = x?.motor?.discounts.find(\n            (d) => d.code === 'SuraCA7_ExternalComercialDiscount'\n          )?.value;\n\n          return of({\n            discount,\n            commission: x.motor.commission.producer\n          });\n        })\n      );\n\n    this.campaign$ = this.storePolicy.select(fromPolicy.getPolicyData).pipe(\n      distinctUntilKeyChanged('campaign'),\n      switchMap((policy: IPolicy) => {\n        if (policy?.campaign) {\n          return of([policy.campaign]);\n        }\n\n        return of((null as unknown) as ICampaign[]);\n      }),\n      tap((campaign: ICampaign[]) => {\n        if (campaign !== null) this.formCampaign.setValue(campaign[0].id);\n      })\n    );\n\n    this.installments$ = this.storePolicy\n      .select(fromPolicy.getPolicyData)\n      .pipe(map((x: IPolicy) => x.paymentTerm.maximumnumberofinstallments));\n\n    this.issueError$ = this.subject.pipe(share());\n\n    this.emissionStoreSubscription = this.storeEmission\n      .select(fromEmission.getEmission)\n      .subscribe((emission) => {\n        this.isApprovedEmission = emission.approvedEmission;\n        this.disabledByRetrieve = emission.jobNumberFromQuotes ? true : false;\n      });\n\n    this.paymentMethod$ = this.storePolicy\n      .select(fromPolicy.getPolicyData)\n      .pipe(\n        distinctUntilKeyChanged('payment'),\n        switchMap((policy) => {\n          if (policy.payment) {\n            return this.paymentMethodService\n              .getAllPaymentMethods(policy.job)\n              .pipe(\n                switchMap((ps) => {\n                  return of(\n                    ps.filter((c) => {\n                      return c.code === policy.payment.method;\n                    })[0]\n                  );\n                })\n              );\n          } else {\n            return of(EMPTY);\n          }\n        })\n      );\n\n    this.paymentPlan$ = this.storePolicy.select(fromPolicy.getPolicyData).pipe(\n      first(),\n      switchMap((policy) => {\n        if (policy) {\n          return this.paymentPlansService\n            .getAllPaymentPlans(\n              'ars',\n              policy.payment.method as string,\n              policy.producer.code,\n              new Date(policy.period.start).toISOString(),\n              new Date(policy.period.end).toISOString()\n            )\n            .pipe(\n              switchMap((pp) => {\n                const currentPlan = pp.find(\n                  (plan) => plan.code === policy.payment.plan.code\n                ) as IPaymentPlan;\n\n                this.storePolicy.dispatch(\n                  new fromPolicyActions.SetCurrentPaymentTermAction(currentPlan)\n                );\n\n                return of(currentPlan);\n              })\n            );\n        } else {\n          return of(EMPTY);\n        }\n      })\n    );\n  }\n\n  ngOnDestroy() {\n    this.producerServiceSubscription?.unsubscribe();\n    this.policyStoreSubscription?.unsubscribe();\n    this.emissionStoreSubscription?.unsubscribe();\n    this.emissionStoreSubscriptionRetrieve?.unsubscribe();\n    this.producerStoreSubscription?.unsubscribe();\n    this.policyStoreProducerSubscription?.unsubscribe();\n    this.updateCostSubscription?.unsubscribe();\n    this.producerSubscription?.unsubscribe();\n  }\n\n  checkUW() {\n    // ML: Según la US-5866 no debe saltar un modal en esta instancia\n    // ya que en la instancia de DNI y PATENTE ya se avisa que existe UW\n    this.issuePolicy();\n  }\n\n  issuePolicy() {\n    this.loadingIssue$.next(true);\n\n    if (this.isApprovedEmission) {\n      this.quotingService.emitPolicy(this.currentPolicy).subscribe(\n        (data) => this.issueSuccess(data),\n        (err) => this.issueError(err)\n      );\n      return;\n    }\n\n    const adapted = this.quoteIssueAdapter.adapt(this.currentPolicy);\n    this.quotingService.issuePolicy(adapted).subscribe(\n      (data) => this.issueSuccess(data),\n      (err) => this.issueError(err)\n    );\n  }\n\n  closeModal() {\n    this.child_component.closeModal();\n  }\n\n  goThankYouPage() {\n    this.child_component.closeModal();\n    this.storeEmission.dispatch(new fromEmissionActions.SetUWIssueAction(true));\n    this.router.navigateByUrl('quoting/thankyou');\n  }\n\n  closeUWModal(reasonClose = null) {\n    if (reasonClose === 'continue') {\n      this.issuePolicy();\n    }\n    this.uwEmision.closeModal();\n  }\n\n  getAssistanceDescription(code: string): Observable<string> {\n    const currentCode: any = code;\n    //FIXME: ML - En el momento de RETRIEVE no cuento con los datos de asistencias\n    const assistance = [\n      { code: 'SOSBasic', description: 'SOS Básica' },\n      { code: 'SOSPremium', description: 'SOS Premium' },\n      { code: 'NoAssistance', description: 'Sin Asistencia' }\n    ];\n\n    return of(\n      assistance.find((a) => a.code === currentCode)?.description ||\n        'Sin Asistencia'\n    );\n    // return this.storePolicy.select(fromQuote.getQuoteMotorData).pipe(\n    //   switchMap((x) => {\n    //     return of(\n    //       x.mechanicalAssists.filter((ass) => ass.code === code)[0].description\n    //     );\n    //   })\n    // );\n  }\n\n  goCoverage() {\n    this.router.navigateByUrl(\n      'quoting/coverage/' + this.currentMotor.number + ''\n    );\n  }\n  goQuote() {\n    this.storeQuote.dispatch(\n      new fromQuoteActions.SetActiveRouteMotor(\n        'motor/' + this.currentMotor.number + '/sum'\n      )\n    );\n    this.storeQuote.dispatch(new fromQuoteActions.SetCurrentLine('motor'));\n    this.router.navigateByUrl(\n      '/quoting/quote/questions/motor/' + this.currentMotor.number + '/sum'\n    );\n    this.modalEditCoverage.closeModal();\n  }\n  openModal() {\n    this.modalEditCoverage.openModal();\n  }\n\n  goCoverageVehicles(VehicleNumber: any) {\n    this.storeQuote.dispatch(\n      new fromQuoteActions.SetCurrentMotorAction(VehicleNumber)\n    );\n    this.closeVehicleDetails();\n    this.router.navigateByUrl('quoting/coverage/' + VehicleNumber + '');\n  }\n  issueSuccess(data: any) {\n    this.loadingIssue$.next(false);\n    if (data.inspection) {\n      this.storePolicy.dispatch(\n        new fromPolicyActions.SetInspectionStatusAction(data.inspection.status)\n      );\n    }\n    if (data.policynumber) {\n      this.storePolicy.dispatch(\n        new fromPolicyActions.SetPolicyNumberAction(data.policynumber)\n      );\n      this.storeEmission.dispatch(\n        new fromEmissionActions.SetUWIssueAction(false)\n      );\n\n      if (!data.inspection) {\n        this.router.navigateByUrl('quoting/thankyou');\n      } else {\n        if (this.currentMotor.zerokm) {\n          this.router.navigateByUrl('quoting/thankyou');\n        } else {\n          this.router.navigateByUrl('quoting/inspection');\n        }\n      }\n    } else if (data.inspection?.status) {\n      this.storeEmission.dispatch(\n        new fromEmissionActions.SetUWIssueAction(false)\n      );\n      if (this.currentMotor.zerokm) {\n        this.router.navigateByUrl('quoting/thankyou');\n      } else {\n        this.router.navigateByUrl('quoting/inspection');\n      }\n    } else if (data.error?.code === BACKEND_ERRORS.UNDERWRITER) {\n      this.storeEmission.dispatch(\n        new fromEmissionActions.SetUWIssueAction(true)\n      );\n      this.router.navigateByUrl('quoting/thankyou');\n    } else {\n      this.subject.next(data.error);\n      // this.issueError = data.error.description;\n      this.child_component.openModal();\n    }\n  }\n\n  issueError(err: HttpErrorResponse | any) {\n    //FIXME: JC: Parche para evaluar errores ante un status 500 cuando sea una validacion de negocio. (UW)\n    this.loadingIssue$.next(false);\n    if (err.code === BACKEND_ERRORS.UNDERWRITER) {\n      this.storeEmission.dispatch(\n        new fromEmissionActions.SetUWIssueAction(true)\n      );\n      this.router.navigateByUrl('quoting/thankyou');\n    } else if (err.message.includes('Bad Request')) {\n      this.notificationService.notify({\n        code: -2,\n        description: 'Ha ocurrido un error, por favor intentelo mas tarde'\n      });\n    } else {\n      this.notificationService.notify({\n        code: -2,\n        description: err.message.replace(/^[^:]+: */, '')\n      });\n    }\n  }\n\n  openVehicleDetails() {\n    this.vehicleDetails.openModal();\n  }\n\n  closeVehicleDetails() {\n    this.vehicleDetails.closeModal();\n  }\n\n  /**\n   * Function to get package description of current vehicle\n   *\n   * @param {IVehicle} vehicle\n   * @returns\n   * @memberof DetailsComponent\n   */\n  getSelectedPackage(vehicle: IVehicle) {\n    return (\n      vehicle.packages?.find((p) => p.selected)?.description ||\n      vehicle.package?.description\n    );\n  }\n\n  /**\n   * Function to get currente mechanical assistance of\n   * current vehicle\n   *\n   * @param {IVehicle} vehicle\n   * @returns\n   * @memberof DetailsComponent\n   */\n  getSelectedMechanicalAssistance(vehicle: IVehicle) {\n    const currentAssistance =\n      vehicle?.packages\n        ?.find((p) => p.selected)\n        ?.coverages?.find(\n          (c) => c.pattern.code === 'SURA_CA7_AsistenciaMecanicaCov'\n        )?.terms[0] ||\n      vehicle.package?.coverages?.find(\n        (c) => c.pattern.code === 'SURA_CA7_AsistenciaMecanicaCov'\n      )?.terms[0];\n\n    const descriptions = [\n      { value: 'SOSBasic', description: 'SOS Básica' },\n      { value: 'SOSPremium', description: 'SOS Premium' },\n      { value: 'NoAssistance', description: 'Sin Asistencia' }\n    ];\n\n    return (\n      descriptions.find((d) => d.value === currentAssistance?.value?.current)\n        ?.description || 'Sin Asistencia'\n    );\n  }\n\n  /**\n   * Function to filter additionals of selected vehicle\n   *\n   * @param {IVehicle} vehicle\n   * @returns\n   * @memberof DetailsComponent\n   */\n  getSelectedAdditionals(vehicle: IVehicle) {\n    const additionals =\n      vehicle.packages?.find((p) => p.selected)?.coverages ||\n      vehicle.package?.coverages;\n\n    const additionalsGroups = [\n      'SURA_CA7_CobAdicionalesGrp',\n      'SURA_CA7_AccesoriosGrp'\n    ];\n\n    const additionalExcludeCodes = [\n      'SURA_CA7_AsistenciaMecanicaCov',\n      'SURA_CA7_ClausulaDeAjusteCov',\n      'SURA_CA7_MobilityTheftDamageCov',\n      'SURA_CA7_MobilityDeathCov',\n      'SURA_CA7_MobilityIncapacityCov',\n      'SURA_CA7_MobilityBoneFractureCov',\n      'SURA_CA7_MobilityInterIncomeCov',\n      'SURA_CA7_MobilityDamageToThirdCov',\n      'SURA_CA7_MobilityTheftPersonalEffectsCov',\n      'SURA_CA7_MobilityTheftPersonalDocCov',\n      'SURA_CA7_MobilityTheftElectronicEquipCov'\n    ];\n\n    return (\n      additionals?.filter(\n        (ad) =>\n          additionalsGroups.includes(ad?.category?.code as string) &&\n          !additionalExcludeCodes.includes(ad?.pattern?.code as string)\n      ) || []\n    );\n  }\n}\n","<div class=\"row\">\n  <div\n    class=\"col-lg-9 pr-2 ps\"\n    style=\"position: relative; min-height: 90vh; max-height: 90vh; height: 90vh;\"\n    [perfectScrollbar]=\"{ suppressScrollY: false }\"\n  >\n    <div class=\"row\">\n      <div class=\"questions col-lg-10 offset-lg-1\">\n        <ul class=\"timeline list-group\">\n          <li\n            *ngFor=\"let item of routes\"\n            [ngClass]=\"{\n              active: item.path == routeActive,\n              visited: !(item.value === null) && !(item.value.length < 1)\n            }\"\n            class=\"list-group-item\"\n          >\n            <div class=\"row header\">\n              <div class=\"col-lg-12 line\">\n                <div class=\"float-right edit\">\n                  <sxf-icon\n                    type=\"edit\"\n                    *ngIf=\"item.show && !item.disabled\"\n                    [routerLink]=\"item.path\"\n                    (click)=\"currentRoute(item.path)\"\n                    [disabled]=\"item.disabled\"\n                  ></sxf-icon>\n                </div>\n                <label class=\"mb-2\">\n                  {{\n                    item.value === null || item.value.length < 1\n                      ? item.question\n                      : item.shortName + ': '\n                  }}\n                  <span\n                    *ngIf=\"!(item.value === null) && !(item.value.length < 1)\"\n                    class=\"item-value\"\n                  >\n                    {{ item.value | uppercase }}\n                  </span>\n                </label>\n              </div>\n            </div>\n            <div id=\"collapseExample\" [ngbCollapse]=\"!item.show\">\n              <div *ngIf=\"item.path === routeActive\" class=\" \">\n                <router-outlet></router-outlet>\n              </div>\n            </div>\n          </li>\n        </ul>\n      </div>\n    </div>\n  </div>\n  <div class=\"col-lg-3 px-0 ps\">\n    <sxf-details></sxf-details>\n  </div>\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { Store } from '@ngrx/store';\nimport * as fromEmissionReducer from '../../state/emission.reducer';\nimport * as fromEmission from '../../state';\nimport * as fromEmissionActions from '../../state/emission.actions';\nimport { IRoutes } from '@sura-platform/web/core/models/question/routes.interface';\n\n@Component({\n  selector: 'sxf-emission-questions',\n  templateUrl: './emission-questions.component.html',\n  styleUrls: ['./emission-questions.component.scss']\n})\nexport class EmissionQuestionsComponent implements OnInit {\n  routes: IRoutes[] = [];\n  routeActive = '';\n  constructor(private store: Store<fromEmissionReducer.EmissionState>) {}\n\n  ngOnInit() {\n    this.store.select(fromEmission.getRoutes).subscribe((data: IRoutes[]) => {\n      this.routes = data;\n    });\n\n    this.store.select(fromEmission.getActiveRoute).subscribe((data: string) => {\n      this.routeActive = data;\n      if (data === '') {\n        this.store.dispatch(new fromEmissionActions.SetActiveRoute('client'));\n        this.routeActive = 'client';\n      }\n    });\n  }\n\n  currentRoute(event: string) {\n    this.store.dispatch(new fromEmissionActions.SetActiveRoute(event));\n  }\n}\n","<div [formGroup]=\"formValidaty\">\n  <div class=\"row\">\n    <div class=\"col-lg-4 pl-0\">\n      <label>\n        Inicio de vigencia\n        <sup>*</sup>\n      </label>\n    </div>\n  </div>\n  <div class=\"row\">\n    <div class=\"col-4 pl-0\">\n      <sxf-datetimepicker\n        (keydown.enter)=\"onEnter()\"\n        [minDate]=\"minDate\"\n        [maxDate]=\"maxDate\"\n        formControlName=\"beginningValidity\"\n        name=\"beginningValidityPolicy\"\n        [disabled]=\"disabledByRetrieve\"\n      ></sxf-datetimepicker>\n    </div>\n  </div>\n  <div class=\"row\" *ngIf=\"retroactiveVigence\">\n    <div class=\"col-5 pl-0\">\n      <span class=\"text-danger\" style=\"font-size: 15px;\">\n        <b>La fecha ingresada requiere autorización.</b>\n      </span>\n    </div>\n  </div>\n  <div class=\"row pt-4\">\n    <div class=\"col-lg-8 pl-0\">\n      <span>\n        <button\n          (click)=\"continue()\"\n          class=\"btn btn-primary btn-heft\"\n          name=\"continueValidatePolicyBtn\"\n        >\n          Continuar\n        </button>\n      </span>\n      <span class=\"press-enter ml-3 mr-4\">\n        o presiona ENTER\n      </span>\n    </div>\n  </div>\n</div>\n","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { Store } from '@ngrx/store';\nimport * as fromPolicy from '../../../../state/policy';\nimport * as fromQuote from '../../../quote/state';\nimport * as fromPolicyActions from '../../../../state/policy/policy.actions';\nimport * as fromEmission from '../../../emission/state';\nimport * as fromEmissionActions from '../../../emission/state/emission.actions';\nimport { FlowRouteEmissionService } from '../../services/flow-route-emission.service';\nimport { IRoutes } from '@sura-platform/web/core/models/question/routes.interface';\nimport * as moment from 'moment';\nimport { Subject, Subscription, combineLatest } from 'rxjs';\n\n@Component({\n  selector: 'sxf-validity',\n  templateUrl: './validity.component.html',\n  styleUrls: ['./validity.component.scss']\n})\nexport class ValidityComponent implements OnInit, OnDestroy {\n  constructor(\n    private fb: FormBuilder,\n    private storePolicy: Store<fromPolicy.State>,\n    private flowRouteEmissionService: FlowRouteEmissionService,\n    private storeEmission: Store<fromEmission.State>,\n    private storeQuote: Store<fromQuote.State>\n  ) {}\n  formValidaty: FormGroup;\n  date: any;\n  maxDate: any;\n  minDate: any;\n  rebillingMonths: number;\n  rebillingCode: string;\n  routes: IRoutes[];\n  today: moment.Moment;\n  isLessThatToday$: Subject<boolean> = new Subject();\n  retroactiveVigence = false;\n  periodData: any;\n\n  disabledByRetrieve$: Subscription;\n  disabledByRetrieve: boolean;\n\n  ngOnInit() {\n    this.formValidaty = this.fb.group({\n      beginningValidity: [, Validators.required]\n    });\n\n    this.storeQuote.select(fromQuote.getServerDate).subscribe((data) => {\n      this.today = moment(data, 'YYYY-MM-DD');\n\n      this.date = {\n        year: this.today.year(),\n        month: this.today.month() + 1,\n        day: this.today.date()\n      };\n\n      const momentTodayForMinDate = moment(this.today).subtract(2, 'months');\n      const momentTodayForMaxDate = moment(this.today).add(30, 'days');\n\n      this.minDate = {\n        year: momentTodayForMinDate.year(),\n        month: momentTodayForMinDate.month() + 1,\n        day: momentTodayForMinDate.date()\n      };\n\n      this.maxDate = {\n        year: momentTodayForMaxDate.year(),\n        month: momentTodayForMaxDate.month() + 1,\n        day: momentTodayForMaxDate.date()\n      };\n    });\n\n    this.storePolicy\n      .select(fromPolicy.getPeriod)\n      .subscribe((data) => {\n        const dateFromStore = moment(data.start, 'YYYY-MM-DD');\n\n        const dateForInput = {\n          year: dateFromStore.year(),\n          month: dateFromStore.month() + 1,\n          day: dateFromStore.date()\n        };\n\n        switch (data.method) {\n          case 'Sura_ThreeMonths':\n            this.rebillingMonths = 3;\n            this.rebillingCode = 'Sura_ThreeMonths';\n            break;\n          default:\n            this.rebillingMonths = 3;\n            this.rebillingCode = 'Sura_ThreeMonths';\n            break;\n        }\n\n        this.formValidaty\n          .get('beginningValidity')\n          .setValue(dateForInput, { emitEvent: true });\n\n        const _date = new Date(\n          dateForInput.year,\n          dateForInput.month,\n          dateForInput.day\n        ).toDateString();\n\n        const momentDate = moment(_date);\n        if (momentDate.subtract(1, 'month').diff(this.today, 'days') < 0) {\n          this.retroactiveVigence = true;\n        } else {\n          this.retroactiveVigence = false;\n        }\n      })\n      .unsubscribe();\n\n    this.storeEmission.select(fromEmission.getRoutes).subscribe((data) => {\n      this.routes = data;\n    });\n\n    this.formValidaty\n      .get('beginningValidity')\n      .valueChanges.subscribe((data) => {\n        if (data !== null) {\n          const _date = new Date(\n            data.year,\n            data.month,\n            data.day\n          ).toDateString();\n          const momentDate = moment(_date);\n\n          if (momentDate.subtract(1, 'month').diff(this.today, 'days') < 0) {\n            this.retroactiveVigence = true;\n          } else {\n            this.retroactiveVigence = false;\n          }\n          this.periodData = {\n            start: momentDate.format(),\n            end: momentDate.add(this.rebillingMonths, 'months').format(),\n            method: this.rebillingCode\n          };\n\n          this.storePolicy.dispatch(\n            new fromPolicyActions.SetPeriodData(this.periodData)\n          );\n        }\n      });\n\n    this.disabledByRetrieve$ = combineLatest([\n      this.storeEmission.select(fromEmission.getEmission),\n      this.storePolicy.select(fromPolicy.getPolicyData)\n    ]).subscribe((x) => {\n      const job = x[0].jobNumberFromQuotes;\n      const approved = x[0].approvedEmission;\n      const policy = x[1];\n\n      this.disabledByRetrieve =\n        job && approved && policy.period && policy.period.start ? true : false;\n    });\n  }\n\n  ngOnDestroy() {\n    if (this.disabledByRetrieve$) this.disabledByRetrieve$.unsubscribe();\n  }\n\n  onEnter() {\n    if (this.formValidaty.valid) {\n      this.continue();\n    }\n  }\n\n  continue() {\n    this.flowRouteEmissionService.enableRoute(this.routes, `aditionalauto/1`);\n\n    this.storeEmission.dispatch(\n      new fromEmissionActions.SetActiveRoute('aditionalauto/1')\n    );\n\n    // this.storePolicy.dispatch(\n    //   new fromPolicyActions.SetPeriodData(this.periodData)\n    // );\n\n    this.routes.forEach((element) => {\n      if (element.path === 'validity') {\n        element.value =\n          this.formValidaty.get('beginningValidity').value.day +\n          '/' +\n          this.formValidaty.get('beginningValidity').value.month +\n          '/' +\n          this.formValidaty.get('beginningValidity').value.year;\n      }\n    });\n\n    if (this.formValidaty.valid) {\n      this.storeEmission.dispatch(\n        new fromEmissionActions.SetFormEmissionTaxIsValidAction(true)\n      );\n    }\n\n    this.flowRouteEmissionService.enableRoute(this.routes, 'aditionalauto/1');\n\n    // this.router.navigateByUrl('quoting/emission/questions/aditionalauto');\n  }\n}\n","<div id=\"tabs\" #tabs>\n  <div class=\"row\">\n    <div class=\"col-lg-12 px-0\">\n      <ul\n        class=\"nav nav-pills nav-fill\"\n        *ngIf=\"paymentMethods$ | async as paymentMethods\"\n      >\n        <li\n          *ngFor=\"let methods of paymentMethods\"\n          class=\"nav-item tab-unselected\"\n        >\n          <label\n            class=\"nav-link active\"\n            [ngClass]=\"{ active: activeTab === methods.code }\"\n            (click)=\"changeTab(methods)\"\n            data-toggle=\"tab\"\n          >\n            <div class=\"cardpayment input-group\">\n              <div class=\"form-radio-label\">\n                <input\n                  type=\"radio\"\n                  name=\"options\"\n                  autocomplete=\"off\"\n                  [checked]=\"methods.code === activeTab\"\n                  name=\"paymentMethod{{ methods.code }}\"\n                />\n                <label for=\"radio\" class=\"radio-label\">\n                  {{ methods.description }}\n                </label>\n              </div>\n              <div></div>\n            </div>\n            <div class=\"text-dark text-left ml-2\">{{ methods.legend }}</div>\n          </label>\n        </li>\n      </ul>\n    </div>\n  </div>\n  <div class=\"tab-content mt-3\" *ngIf=\"paymentInstruments$ | async as payments\">\n    <!--this is credit card-->\n    <div *ngIf=\"activeTab === 'CreditCard' && payments.length > 0\">\n      <div>\n        <div class=\"row\">\n          <div class=\"col-lg-12 pl-2\">\n            <label>Tarjetas guardadas para este cliente</label>\n            <br />\n          </div>\n        </div>\n\n        <!-- <ul class=\"nav nav-pills justify-fill\"> -->\n        <div class=\"row pl-2\">\n          <div class=\"mr-3\">\n            <button\n              class=\"btn btn-primary btn-icon\"\n              (click)=\"previousPaginate()\"\n              name=\"previousPaginateBtn\"\n            >\n              <sxf-icon class=\"icon-blue\" type=\"arrow-left\"></sxf-icon>\n            </button>\n          </div>\n          <div class=\"col-7\">\n            <div class=\"row p-0\">\n              <div\n                class=\"col mr-3 px-0 nav-item tab-unselected\"\n                *ngFor=\"\n                  let item of paginateCreditCards(payments, 2, 0);\n                  let i = index\n                \"\n              >\n                <label\n                  *ngIf=\"item.method === 'CreditCard'\"\n                  (click)=\"setPaymentMethod(item)\"\n                  class=\"nav-link active\"\n                  data-toggle=\"tab\"\n                >\n                  <div class=\"payment-card\">\n                    <div class=\"input-group\" style=\"cursor: pointer;\">\n                      <div class=\"form-radio-label\">\n                        <input\n                          type=\"radio\"\n                          autocomplete=\"off\"\n                          [checked]=\"currentPolicy.payment.id === item.id\"\n                          name=\"optionPayment{{ item.id }}\"\n                          [disabled]=\"disabledByRetrieve\"\n                        />\n                        <label for=\"radio\" class=\"radio-label\">\n                          &nbsp;&nbsp;&nbsp;&nbsp;\n                          <img\n                            width=\"40\"\n                            src=\"../../../../../../../assets/cards/{{\n                              getCardImg(item.displayname) | uppercase\n                            }}.svg\"\n                            (error)=\"cardNotExists($event)\"\n                          />\n                          &nbsp;&nbsp;\n                          {{ item.displayname | cardnumber }}\n                        </label>\n                      </div>\n                    </div>\n                  </div>\n                </label>\n                <!-- <li class=\"nav-item tab-unselected\" *ngFor=\"let item of payments\"> -->\n              </div>\n            </div>\n          </div>\n          <div class=\"px-0\">\n            <button\n              class=\"btn btn-primary btn-icon\"\n              name=\"nextPaginateBtn\"\n              (click)=\"nextPaginate(payments.length)\"\n            >\n              <sxf-icon class=\"icon-blue\" type=\"arrow-right\"></sxf-icon>\n            </button>\n          </div>\n          <div class=\"col-lg-3 px-0\">\n            <button\n              class=\"btn btn-primary btn-icon\"\n              (click)=\"addNewPaymentWay()\"\n              [disabled]=\"disabledByRetrieve\"\n              name=\"addNewPaymentWayBtn\"\n              style=\"color: #00aec7; border: none; box-shadow: none;\"\n            >\n              <sxf-icon class=\"icon-green\" type=\"plus\"></sxf-icon>\n              Agregar tarjeta\n            </button>\n          </div>\n        </div>\n        <!-- </ul> -->\n      </div>\n    </div>\n    <!--this is debit card-->\n    <div *ngIf=\"activeTab === 'BankingDebt' && payments.length > 0\">\n      <div>\n        <div class=\"row\">\n          <div class=\"col-lg-12 pl-2\">\n            <label>Cuentas guardadas para este cliente</label>\n            <br />\n          </div>\n        </div>\n        <!-- <ul class=\"nav nav-pills justify-fill\"> -->\n        <div class=\"row pl-2\">\n          <div class=\"mr-3\">\n            <button\n              class=\"btn btn-primary btn-icon\"\n              (click)=\"previousPaginate()\"\n              name=\"previousPaginateBtn\"\n            >\n              <sxf-icon class=\"icon-blue\" type=\"arrow-left\"></sxf-icon>\n            </button>\n          </div>\n          <div class=\"col-7\">\n            <div class=\"row p-0\">\n              <div\n                class=\"col mr-3 px-0 nav-item tab-unselected\"\n                *ngFor=\"let item of paginateCbus(payments, 2, 0); let i = index\"\n              >\n                <label\n                  *ngIf=\"item.method === 'BankingDebt'\"\n                  (click)=\"setPaymentMethod(item)\"\n                  class=\"nav-link active\"\n                  data-toggle=\"tab\"\n                >\n                  <div class=\"payment-card\">\n                    <div class=\"input-group pt-1\">\n                      <div class=\"form-radio-label\">\n                        <input\n                          type=\"radio\"\n                          autocomplete=\"off\"\n                          [checked]=\"activePaymentMethodId === item.id\"\n                          name=\"radioPaymentOption{{ item.id }}\"\n                        />\n                        <label for=\"radio\" class=\"radio-label\">\n                          &nbsp;&nbsp;\n                          {{ item.displayname | slice: 5:27 }}\n                        </label>\n                      </div>\n                    </div>\n                  </div>\n                </label>\n                <!-- <li class=\"nav-item tab-unselected\" *ngFor=\"let item of payments\"> -->\n              </div>\n            </div>\n          </div>\n          <div class=\"px-0\">\n            <button\n              class=\"btn btn-primary btn-icon\"\n              name=\"nextPaginatePaymentBtn\"\n              (click)=\"nextPaginate(payments.length)\"\n            >\n              <sxf-icon class=\"icon-blue\" type=\"arrow-right\"></sxf-icon>\n            </button>\n          </div>\n          <div class=\"col-lg-3 px-0\">\n            <button\n              class=\"btn btn-primary btn-icon\"\n              (click)=\"addNewPaymentWay()\"\n              name=\"addNewPaymentWayPaymentBtn\"\n              style=\"color: #00aec7; border: none; box-shadow: none;\"\n            >\n              <sxf-icon class=\"icon-green\" type=\"plus\"></sxf-icon>\n              Agregar CBU\n            </button>\n          </div>\n        </div>\n        <!-- </ul> -->\n      </div>\n    </div>\n    <!--this is coupon-->\n  </div>\n  <div class=\"tab-content mt-3\">\n    <div\n      [formGroup]=\"formCredit\"\n      *ngIf=\"newPaymentWay && activeTab === 'CreditCard'\"\n    >\n      <div class=\"row mt-2 pl-2\">\n        <div class=\"col-lg-4 px-0\">\n          <label>\n            Número de tarjeta\n            <sup>*</sup>\n          </label>\n        </div>\n        <div class=\"col-lg-4\">\n          <label>\n            Vencimiento\n            <sup>*</sup>\n          </label>\n        </div>\n      </div>\n      <div class=\"row pl-2\">\n        <div class=\"col-4 pl-0\">\n          <sxf-textbox\n            type=\"text\"\n            formControlName=\"number\"\n            [mask]=\"numberMask\"\n            label=\"\"\n            placeholder=\"\"\n            [helpFeedback]=\"''\"\n            name=\"numberCard\"\n          ></sxf-textbox>\n        </div>\n        <!-- <input type=\"text\" class=\"form-control\" mask=\"M0/0000\"> -->\n        <div class=\"col-4\">\n          <sxf-textbox\n            type=\"text\"\n            formControlName=\"expirationdate\"\n            placeholder=\"MM/YYYY\"\n            [mask]=\"expirationDateMask\"\n            [helpFeedback]=\"''\"\n            name=\"expirationdateCard\"\n          ></sxf-textbox>\n        </div>\n      </div>\n    </div>\n    <div\n      [formGroup]=\"formDebit\"\n      *ngIf=\"newPaymentWay && activeTab === 'BankingDebt'\"\n    >\n      <div class=\"row pl-2\">\n        <div class=\"col-lg-4 px-0\">\n          <label>\n            CBU\n            <sup>*</sup>\n          </label>\n        </div>\n      </div>\n      <div class=\"row pl-2\">\n        <div class=\"col-lg-4 px-0\">\n          <sxf-textbox\n            type=\"text\"\n            formControlName=\"number\"\n            label=\"\"\n            placeholder=\"\"\n            [maxLength]=\"22\"\n            [minLength]=\"22\"\n            [helpFeedback]=\"''\"\n            placement=\"bottom\"\n            messageTooltips=\"\"\n            name=\"numberCBU\"\n          ></sxf-textbox>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class=\"row\">\n    <div class=\"col-6 pl-0 mt-2\">\n      <!-- TODO: DG, checkbox de poliza digital, descomentar si deciden volver a ponerlo\n            <div class=\"form-checkbox\">\n            <input\n              type=\"checkbox\"\n              [checked]=\"digitalPolicy\"\n              (click)=\"sendDigitalPolicy()\"\n              class=\"form-checkbox-input\"\n              id=\"digitalPolicy\"\n            />\n            <label class=\"form-checkbox-label\" for=\"digitalPolicy\"></label>\n            <label class=\"label-checkbox\">\n              Póliza digital\n            </label>\n          </div>-->\n      <span class=\"info pl-2\">\n        Vamos a enviar la póliza digital por mail\n      </span>\n    </div>\n  </div>\n</div>\n","import { Component, OnInit, OnDestroy } from '@angular/core';\n\nimport { BaseComponent } from '@sura-platform/core';\n\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\n\nimport * as fromPolicy from '../../../../state/policy';\nimport * as fromPolicyActions from '../../../../state/policy/policy.actions';\nimport * as fromEmission from '../../state';\nimport { Store } from '@ngrx/store';\nimport {\n  PaymentMethodService,\n  AccountService,\n  IPolicy,\n  ICreditCard,\n  IPayment,\n  IPaymentPlan\n} from '@sura-platform/features';\nimport { Observable, of, EMPTY, Subscription, combineLatest } from 'rxjs';\nimport { switchMap, filter, catchError } from 'rxjs/operators';\nimport * as moment from 'moment';\nimport * as fromQuote from '../../../quote/state';\n\ninterface PaymentMethod {\n  code: number;\n  description: string;\n  discount: number;\n}\n\ninterface Bank {\n  code: number;\n  description: string;\n}\n\ninterface CardStored {\n  code: number;\n  name: string;\n  number: string;\n  bank: Bank;\n  expired: string;\n  security: string;\n}\n\n@Component({\n  selector: 'sxf-paymentmethod',\n  templateUrl: 'paymentmethod.component.html',\n  styleUrls: ['paymentmethod.component.scss']\n})\nexport class PaymentMethodComponent extends BaseComponent\n  implements OnInit, OnDestroy {\n  /**\n   * tab open by default\n   */\n  activeTab: string | null = '';\n\n  /**\n   * Array of payment methods\n   */\n  arrPaymentMethods: PaymentMethod[] = [];\n\n  /**\n   * form for debicard\n   */\n  formDebit: FormGroup = <FormGroup>{};\n\n  /**\n   * form for creditcard\n   */\n  formCredit: FormGroup = <FormGroup>{};\n\n  /**\n   * Array of cards stored\n   */\n  arrCardsStored: CardStored[] = [];\n\n  paymentInstruments$: Observable<any> = new Observable();\n\n  paymentMethods$: Observable<any> = new Observable();\n\n  payment: IPayment = <IPayment>{};\n\n  paymentTerm: IPaymentPlan = <IPaymentPlan>{};\n\n  activePaymentMethodId: string | null = '';\n\n  newPaymentWay = false;\n\n  digitalPolicy = true;\n\n  fromRetrieve = false;\n\n  approvedEmission = false;\n\n  currentPolicy: IPolicy = <IPolicy>{};\n\n  initSlice = 0;\n  endSlice = 2;\n\n  arrayCardsLength = 0;\n  arrayCbusLength = 0;\n\n  public expirationDateMask = [/[0-1]/, /[0-9]/, '/', /\\d/, /\\d/, /\\d/, /\\d/];\n  public numberMask = [\n    /\\d/,\n    /\\d/,\n    /\\d/,\n    /\\d/,\n    ' ',\n    /\\d/,\n    /\\d/,\n    /\\d/,\n    /\\d/,\n    ' ',\n    /\\d/,\n    /\\d/,\n    /\\d/,\n    /\\d/,\n    ' ',\n    /\\d/,\n    /\\d/,\n    /\\d/,\n    /\\d/\n  ];\n\n  disabledByRetrieve = false;\n  paymentSelectedByRetrieve = false;\n  currentServerDate = new Date();\n\n  disabledByRetrieveSubscription: Subscription = new Subscription();\n  serverDataSubscription: Subscription = new Subscription();\n  paymentDataSubscription: Subscription = new Subscription();\n  paymentTermSubscription: Subscription = new Subscription();\n  policyDataSubscription: Subscription = new Subscription();\n  creditCardSubscription: Subscription | undefined = new Subscription();\n  cardExpirationSubcription: Subscription | undefined = new Subscription();\n  debitCardSubscription: Subscription | undefined = new Subscription();\n  emissionStoreSubscription: Subscription = new Subscription();\n\n  constructor(\n    private fb: FormBuilder,\n    private storePolicy: Store<fromPolicy.State>,\n    private storeEmission: Store<fromEmission.State>,\n    private paymentMethodService: PaymentMethodService,\n    private paymentInstrument: AccountService,\n    private storeQuote: Store<fromQuote.State>\n  ) {\n    super();\n  }\n\n  ngOnInit(): void {\n    this.paymentDataSubscription = this.storePolicy\n      .select(fromPolicy.getPaymentData)\n      .subscribe((data) => {\n        this.payment = data;\n        this.activeTab = data.method;\n      });\n\n    this.paymentTermSubscription = this.storePolicy\n      .select(fromPolicy.getPaymentTerm)\n      .subscribe((data) => {\n        this.paymentTerm = data;\n        this.payment.plan.code = data.code;\n      });\n\n    this.policyDataSubscription = this.storePolicy\n      .select(fromPolicy.getPolicyData)\n      .subscribe((data) => {\n        this.currentPolicy = data;\n        if (data.email) {\n          this.digitalPolicy = true;\n        } else {\n          this.digitalPolicy = false;\n        }\n      });\n\n    this.serverDataSubscription = this.storeQuote\n      .select(fromQuote.getServerDate)\n      .subscribe((date) => {\n        this.currentServerDate = new Date(date as any);\n      });\n\n    this.paymentMethods$ = this.storePolicy.select(fromPolicy.getJob).pipe(\n      switchMap((x) => {\n        if (x) {\n          return this.paymentMethodService.getAllPaymentMethods(x).pipe(\n            switchMap((ps) => {\n              ps.map((hj) => {\n                //FIXME: MP, DG: Marcos, aqui setie esto hardcodeado, lo pidieron asi, pero hay que estar\n                //pendiente que a futuro lo incluyan en la API (el descuento para mostrar a modo informativo)\n                if (hj.code !== 'Coupon') {\n                  hj.legend = '10% de descuento';\n                }\n              });\n              return of(ps.filter((c) => c.code === this.payment.method));\n            })\n          );\n        } else {\n          return of(EMPTY);\n        }\n      })\n    );\n\n    this.paymentInstruments$ = this.storePolicy\n      .select(fromPolicy.getClientData)\n      .pipe(\n        switchMap((x) => {\n          if (x.accountnumber !== null) {\n            return this.paymentInstrument\n              .getPaymentInstruments(x.accountnumber)\n              .pipe(\n                filter((u) => u.length > 0),\n                switchMap((p) => {\n                  const hasPaymentInstrumentsForTabSet = p.filter(\n                    (o) => o.method === this.payment.method\n                  ).length;\n                  if (hasPaymentInstrumentsForTabSet < 1) {\n                    this.newPaymentWay = true;\n                  }\n                  return of(p.filter((o) => o.method === this.payment.method));\n                })\n              );\n          } else {\n            this.newPaymentWay = true;\n            return of(EMPTY);\n          }\n        }),\n        catchError(() => {\n          this.newPaymentWay = true;\n          return of(EMPTY);\n        })\n      );\n\n    this.formDebit = this.fb.group({\n      number: [, [Validators.required, Validators.minLength(22)]]\n    });\n\n    this.formCredit = this.fb.group({\n      //! 14 digits Diners\n      //! 15 digits AMEX\n      //! Others 16 Digits\n      number: [\n        ,\n        [\n          Validators.required,\n          Validators.minLength(14),\n          Validators.maxLength(16)\n        ]\n      ],\n      // expirationdate: [\n      //   ,\n      //   [Validators.required, Validators.pattern('^d{2}/d{4}$')]\n      // ],\n      expirationdate: [, [Validators.required, Validators.minLength(7)]],\n      owner: [, Validators.required]\n    });\n\n    this.creditCardSubscription = this.formCredit\n      .get('number')\n      ?.valueChanges.subscribe((data: string) => {\n        // TODO: Descomentar este codigo siguiente cuando ande la api creditcards..\n        if (data.length > 6) {\n          this.paymentMethodService\n            .getCreditCards(data.substring(0, 6))\n            .subscribe((cc: ICreditCard[]) => {\n              if (cc) {\n                this.payment.creditcard.type = cc[0].code;\n                this.storePolicy.dispatch(\n                  new fromPolicyActions.SetCurrentPaymentMethodAction(\n                    this.payment\n                  )\n                );\n              }\n            });\n        }\n        this.payment.creditcard.number = data;\n        this.storePolicy.dispatch(\n          new fromPolicyActions.SetCurrentPaymentMethodAction(this.payment)\n        );\n      });\n\n    this.cardExpirationSubcription = this.formCredit\n      .get('expirationdate')\n      ?.valueChanges.subscribe((data: string) => {\n        this.payment.creditcard.expirationdate = null;\n        if (data.length === 7) {\n          const _expirationDate = '01/' + data;\n          const dateServer = moment(this.currentServerDate).format(\n            'YYYY-MM-DD'\n          );\n          const dateCard = moment(_expirationDate, 'DD/MM/YYYY').format(\n            'YYYY-MM-DD'\n          );\n\n          /* Si la fecha del servidor es mayor a la fecha de la TDC, hago dispatch */\n          if (dateCard > dateServer) {\n            this.payment.creditcard.expirationdate = moment(\n              _expirationDate,\n              'DD/MM/YYYY'\n            ).toISOString();\n\n            this.storePolicy.dispatch(\n              new fromPolicyActions.SetCurrentPaymentMethodAction(this.payment)\n            );\n          } else {\n            this.payment.creditcard.expirationdate = null;\n            this.storePolicy.dispatch(\n              new fromPolicyActions.SetCurrentPaymentMethodAction(this.payment)\n            );\n          }\n        }\n      });\n\n    this.debitCardSubscription = this.formDebit\n      .get('number')\n      ?.valueChanges.subscribe((data: string) => {\n        this.payment.cbu.number = data;\n        this.payment.cbu.conduit = '17';\n        this.storePolicy.dispatch(\n          new fromPolicyActions.SetCurrentPaymentMethodAction(this.payment)\n        );\n      });\n\n    //TODO DG: hacer que este por defecto la que venga por API (segun US-1715)\n    // this.changeTab(this.arrPaymentMethods[0]);\n\n    this.disabledByRetrieveSubscription = combineLatest([\n      this.storeEmission.select(fromEmission.getJobNumber),\n      this.storePolicy.select(fromPolicy.getPolicyData)\n    ]).subscribe((x) => {\n      const job = x[0];\n      const policy = x[1];\n\n      // ML: Entra en esta sección si retrieve indica que fue seleccionado\n      // un método de pago\n      if (policy.payment.id && !this.paymentSelectedByRetrieve) {\n        if (policy.client.accountnumber !== null) {\n          this.paymentInstrument\n            .getPaymentInstruments(policy.client.accountnumber)\n            .subscribe((pi) => {\n              const payment = pi.find((p) => p.id === policy.payment.id);\n\n              if (payment) {\n                this.setPaymentMethod(payment, true);\n                this.paymentSelectedByRetrieve = true;\n              }\n            });\n        }\n      }\n      this.emissionStoreSubscription = this.storeEmission\n        .select(fromEmission.getEmission)\n        .subscribe((store) => {\n          this.fromRetrieve = store.jobNumberFromQuotes ? true : false;\n          this.approvedEmission = store.approvedEmission;\n        });\n      if (this.fromRetrieve) {\n        this.disabledByRetrieve =\n          this.approvedEmission && policy.payment.id ? true : false;\n      } else {\n        this.disabledByRetrieve = job && policy.payment.id ? true : false;\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    this.debitCardSubscription?.unsubscribe();\n    this.creditCardSubscription?.unsubscribe();\n    this.cardExpirationSubcription?.unsubscribe();\n    this.emissionStoreSubscription?.unsubscribe();\n    this.serverDataSubscription?.unsubscribe();\n    this.policyDataSubscription?.unsubscribe();\n    this.paymentDataSubscription?.unsubscribe();\n    this.paymentTermSubscription?.unsubscribe();\n    this.disabledByRetrieveSubscription?.unsubscribe();\n  }\n\n  changeTab(tab: any) {\n    //FIXME: MVP 1\n    return false;\n\n    this.initSlice = 0;\n    this.endSlice = 2;\n\n    this.activeTab = tab.code;\n    this.payment.method = tab.code;\n    if (tab.code === 'BankingDebt') {\n      this.newPaymentWay = true;\n    }\n    this.storePolicy.dispatch(\n      new fromPolicyActions.SetCurrentPaymentMethodAction(this.payment)\n    );\n  }\n\n  addNewPaymentWay() {\n    this.newPaymentWay = true;\n    this.activePaymentMethodId = null;\n    this.payment.id = null;\n    this.payment.creditcard.number = null;\n    this.payment.creditcard.type = null;\n    this.payment.creditcard.expirationdate = null;\n    this.payment.cbu.number = null;\n    this.formCredit?.get('expirationdate')?.setValue('');\n    this.formCredit?.get('number')?.setValue('');\n    this.formDebit?.get('number')?.setValue('');\n    this.storePolicy.dispatch(\n      new fromPolicyActions.SetCurrentPaymentMethodAction(this.payment)\n    );\n  }\n\n  setPaymentMethod(payment: any, selected?: boolean) {\n    if (this.disabledByRetrieve && !selected) return;\n\n    this.payment.plan.code = this.payment.plan.code || this.paymentTerm.code;\n    this.newPaymentWay = false;\n    this.activePaymentMethodId = payment.id;\n    this.payment.id = payment.id;\n    this.payment.cbu.number = null;\n    this.payment.creditcard.expirationdate = null;\n    this.payment.creditcard.number = null;\n    this.payment.creditcard.type = null;\n    switch (payment.method) {\n      case 'CreditCard':\n        const type = payment.displayname\n          .substring(0, payment.displayname.indexOf('('))\n          .replace(' ', '');\n        const number = payment.displayname.substring(\n          payment.displayname.lastIndexOf('(') + 1,\n          payment.displayname.lastIndexOf(')')\n        );\n        const expirationCard = payment.displayname.substring(\n          payment.displayname.length - 10\n        );\n        // const yearExpiration = expirationCard.substring(expirationCard.length - 4);\n        // const monthExpiration =\n\n        this.payment.creditcard.number = number;\n        this.payment.creditcard.expirationdate = moment(\n          expirationCard,\n          'DD/MM/YYYY'\n        ).toISOString();\n        this.payment.creditcard.type = type.toString().toLowerCase().trim();\n        break;\n      case 'BankingDebt':\n        const cbuNumber = payment.displayname.substring(\n          payment.displayname.lastIndexOf('(') + 1,\n          payment.displayname.lastIndexOf(')')\n        );\n        this.payment.cbu.number = cbuNumber;\n        break;\n      default:\n        break;\n    }\n\n    this.storePolicy.dispatch(\n      new fromPolicyActions.SetCurrentPaymentMethodAction(this.payment)\n    );\n  }\n\n  sendDigitalPolicy() {\n    this.digitalPolicy = !this.digitalPolicy;\n    if (this.digitalPolicy) {\n      if (this.currentPolicy.client.email !== null) {\n        this.storePolicy.dispatch(\n          new fromPolicyActions.SetMailDataAction(\n            this.currentPolicy.client.email\n          )\n        );\n      } else {\n      }\n    } else {\n      this.storePolicy.dispatch(new fromPolicyActions.SetMailDataAction(null));\n    }\n  }\n\n  /**\n   * Return name of card from this template 'Visa (4551970002062213) - H - 05/08/2020'\n   */\n  getCardImg(value: string) {\n    const regex = /([^\\(]+)/;\n    const match = regex.exec(value);\n    if (match !== null) {\n      return match[1].trim().replace(' ', '').toUpperCase();\n    } else {\n      return null;\n    }\n  }\n\n  paginateCbus(array: Array<any>) {\n    this.arrayCbusLength = array.length;\n    const _array = array.slice(this.initSlice, this.endSlice);\n    return _array;\n  }\n\n  paginateCreditCards(array: Array<any>) {\n    this.arrayCardsLength = array.length;\n    const _array = array.slice(this.initSlice, this.endSlice);\n    return _array;\n  }\n\n  nextPaginate(lengthArray: number) {\n    if (this.endSlice < lengthArray) {\n      this.initSlice += 2;\n      this.endSlice += 2;\n    }\n  }\n\n  previousPaginate() {\n    if (this.initSlice >= 2) {\n      this.initSlice -= 2;\n      this.endSlice -= 2;\n    }\n  }\n\n  cardNotExists(event: Event): void {\n    const img: HTMLImageElement = <HTMLImageElement>event.target;\n    img.src = '/assets/icons/GENERAL_TARJETA.svg';\n    img.height = 25;\n  }\n}\n","<div [formGroup]=\"form\" class=\"col-lg-12\">\n  <div class=\"row\">\n    <div class=\"col-lg-4 pl-0\">\n      <label>\n        Documento\n        <sup>*</sup>\n      </label>\n    </div>\n  </div>\n  <div class=\"row\">\n    <div class=\"col-lg-6 input-group pl-0\">\n      <sxf-select\n        #documentType\n        style=\"width: 100px;\"\n        formControlName=\"document\"\n        [items]=\"documents$\"\n        bindLabel=\"description\"\n        bindValue=\"code\"\n        [multiple]=\"false\"\n        class=\"custom\"\n        [searchable]=\"false\"\n        placeholder=\"Documento...\"\n        [dropdownPosition]=\"'bottom'\"\n        name=\"documentClientEmission\"\n        [disabled]=\"disabledByRetrieve\"\n      ></sxf-select>\n      <sxf-textbox\n        type=\"text\"\n        formControlName=\"documentNumber\"\n        (keyup.enter)=\"validateDocumentNumber()\"\n        label=\"\"\n        placeholder=\"\"\n        [helpFeedback]=\"''\"\n        placement=\"bottom\"\n        [maxLength]=\"maxLength\"\n        messageTooltips=\"Ingresá los {{\n          maxLength !== 0 ? maxLength : ''\n        }} dígitos del {{ documentDescription }}\"\n        name=\"documentNumberClientEmission\"\n        [disabled]=\"disabledByRetrieve\"\n      ></sxf-textbox>\n      <br />\n    </div>\n    <div class=\"col-lg-3\">\n      <!-- <span *ngIf=\"!loadingData\"> -->\n      <button\n        [disabled]=\"\n          !form.valid || isLegalPerson !== 'undefined' || disabledByRetrieve\n        \"\n        (click)=\"validateDocumentNumber()\"\n        class=\"btn btn-primary btn-block\"\n        name=\"validateDocumentNumberBtn\"\n      >\n        <ng-lottie\n          [hidden]=\"!loadingData\"\n          [options]=\"lottieConfig\"\n          (animationCreated)=\"animationCreated($event)\"\n          height=\"24px\"\n          width=\"24px\"\n        ></ng-lottie>\n        {{ buttonLabel }}\n        <!-- Validar -->\n      </button>\n      <!-- </span>\n      <span *ngIf=\"loadingData\">\n        <button disabled class=\"btn btn-primary\">\n          Validando...\n        </button>\n      </span> -->\n      <div class=\"press-enter ml-3 mr-4\">\n        o presiona ENTER\n      </div>\n    </div>\n    <div class=\"col-lg-3\">\n      <span\n        class=\"question-class\"\n        (click)=\"openModal()\"\n        style=\"cursor: pointer;\"\n      >\n        <b>¿Los datos no coinciden?</b>\n      </span>\n    </div>\n  </div>\n</div>\n<div *ngIf=\"(searchClient$ | async) || (client$ | async)\">\n  <input type=\"hidden\" *ngIf=\"clientBaseN$ | async\" />\n  <!-- Formulario Persona Fisica -->\n\n  <div\n    [formGroup]=\"formPhysicalPerson\"\n    class=\"col-12\"\n    *ngIf=\"\n      !loadingData && isLegalPerson !== 'undefined' && isLegalPerson === 'not'\n    \"\n  >\n    <div class=\"row\">\n      <div class=\"col-lg-4 pl-0\">\n        <label>\n          Nombre\n          <sup>*</sup>\n        </label>\n      </div>\n      <div class=\"col-lg-4\">\n        <label>\n          Apellido\n          <sup>*</sup>\n        </label>\n      </div>\n      <div class=\"col-lg-4\">\n        <label>\n          Fecha de Nacimiento\n          <sup>*</sup>\n        </label>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-4 pl-0\">\n        <sxf-textbox\n          type=\"text\"\n          [disabled]=\"(clientFromEmission$ | async)?.firstname\"\n          formControlName=\"firstname\"\n          label=\"\"\n          placeholder=\"Ingresá el nombre\"\n          [helpFeedback]=\"\"\n          maxlength=\"100\"\n          placement=\"bottom\"\n          [value]=\"(client$ | async)?.firstname\"\n          name=\"firstnameClientEmission\"\n        ></sxf-textbox>\n      </div>\n      <div class=\"col-4\">\n        <sxf-textbox\n          type=\"text\"\n          [disabled]=\"(clientFromEmission$ | async)?.lastname\"\n          formControlName=\"lastname\"\n          maxlength=\"100\"\n          label=\"\"\n          placeholder=\"Ingresá el apellido\"\n          [helpFeedback]=\"\"\n          placement=\"bottom\"\n          name=\"lastnameClientEmission\"\n        ></sxf-textbox>\n      </div>\n      <div class=\"col-4\">\n        <sxf-datetimepicker\n          [disabled]=\"(clientFromEmission$ | async)?.birth\"\n          formControlName=\"birth\"\n          navigation=\"select\"\n          [minDate]=\"minDateClient\"\n          [maxDate]=\"maxDateClient\"\n          [helpFeedback]=\"\"\n          name=\"birthClientEmission\"\n        ></sxf-datetimepicker>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-lg-4 pl-0\">\n        <label>\n          Nacionalidad\n          <sup>*</sup>\n        </label>\n      </div>\n      <div class=\"col-lg-4\">\n        <label>\n          Estado Civil\n          <sup>*</sup>\n        </label>\n      </div>\n      <div class=\"col-lg-4\">\n        <label>\n          Sexo\n          <sup>*</sup>\n        </label>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-4 pl-0\">\n        <sxf-select\n          [disabled]=\"(clientFromEmission$ | async)?.nationality\"\n          formControlName=\"nationality\"\n          [items]=\"nationalities$\"\n          bindLabel=\"description\"\n          bindValue=\"code\"\n          [multiple]=\"false\"\n          [helpFeedback]=\"\"\n          class=\"custom\"\n          [searchable]=\"true\"\n          placeholder=\"Nacionalidad\"\n          [dropdownPosition]=\"'bottom'\"\n          name=\"nationalityClientEmission\"\n        ></sxf-select>\n      </div>\n      <div class=\"col-4\">\n        <sxf-select\n          [disabled]=\"(clientFromEmission$ | async)?.maritalstatus\"\n          formControlName=\"maritalstatus\"\n          [items]=\"maritalStatus$\"\n          bindLabel=\"description\"\n          bindValue=\"code\"\n          [multiple]=\"false\"\n          [helpFeedback]=\"\"\n          class=\"custom\"\n          [searchable]=\"true\"\n          placeholder=\"Estado Civil\"\n          [dropdownPosition]=\"'bottom'\"\n          name=\"maritalstatusClientEmission\"\n        ></sxf-select>\n      </div>\n      <div class=\"col-4\">\n        <sxf-select\n          [disabled]=\"(clientFromEmission$ | async)?.gender\"\n          formControlName=\"gender\"\n          [items]=\"genders$\"\n          bindLabel=\"description\"\n          bindValue=\"code\"\n          [multiple]=\"false\"\n          [helpFeedback]=\"\"\n          class=\"custom\"\n          [searchable]=\"true\"\n          placeholder=\"Sexo\"\n          [dropdownPosition]=\"'bottom'\"\n          name=\"genderClientEmission\"\n        ></sxf-select>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-lg-1 pl-0\">\n        <label>\n          Cód. Área\n          <sup>*</sup>\n        </label>\n      </div>\n      <div class=\"col-lg-3\">\n        <label>\n          Teléfono\n          <sup>*</sup>\n        </label>\n      </div>\n      <div class=\"col-lg-4\">\n        <label>\n          Mail\n          <sup>*</sup>\n        </label>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-1 pl-0 pr-0\">\n        <sxf-textbox\n          type=\"text\"\n          formControlName=\"prefix\"\n          [maxLength]=\"5\"\n          [minLength]=\"2\"\n          placeholder=\"Cód. Área\"\n          [helpFeedback]=\"\n            formPhysicalPerson.controls['prefix'].disabled\n              ? 'No es modificable'\n              : ''\n          \"\n          name=\"prefixClientEmission\"\n          [disabled]=\"\n            (clientFromEmission$ | async)?.cellphone?.area && disabledByRetrieve\n          \"\n        ></sxf-textbox>\n      </div>\n      <div class=\"col-3\">\n        <sxf-textbox\n          type=\"text\"\n          formControlName=\"phone\"\n          label=\"\"\n          placeholder=\"Teléfono\"\n          [minLength]=\"6\"\n          [maxLength]=\"8\"\n          [helpFeedback]=\"\n            formPhysicalPerson.controls['phone'].disabled\n              ? 'No es modificable'\n              : ''\n          \"\n          name=\"phoneClientEmission\"\n          [disabled]=\"\n            (clientFromEmission$ | async)?.cellphone?.number &&\n            disabledByRetrieve\n          \"\n        ></sxf-textbox>\n      </div>\n      <div class=\"col-4\">\n        <sxf-textbox\n          type=\"text\"\n          formControlName=\"email\"\n          label=\"\"\n          placeholder=\"Ingresá el email\"\n          [maxLength]=\"60\"\n          [helpFeedback]=\"\n            formPhysicalPerson.controls['email'].disabled\n              ? 'No es modificable'\n              : ''\n          \"\n          name=\"emailClientEmission\"\n          [disabled]=\"\n            (clientFromEmission$ | async)?.email && disabledByRetrieve\n          \"\n        ></sxf-textbox>\n        <span\n          *ngIf=\"\n            (formPhysicalPerson.controls.email.dirty ||\n              formPhysicalPerson.controls.email.touched) &&\n            !formPhysicalPerson.controls.email.errors\n          \"\n          class=\"text-danger\"\n        >\n          <b>Este email será usado para enviar la inspección por photo up</b>\n        </span>\n      </div>\n      <div class=\"col-4\">\n        <div class=\"form-checkbox\" id=\"containerExposedPerson\">\n          <span\n            placement=\"bottom\"\n            ngbTooltip=\"Funcionarios públicos nacionales, provinciales o municipales que ocupan u ocuparon altos cargos, puestos jerárquicos, como así también sus familiares\"\n          >\n            <input\n              type=\"checkbox\"\n              formControlName=\"exposedPerson\"\n              class=\"form-checkbox-input\"\n              id=\"exposedPerson\"\n              name=\"exposedPersonClientEmission\"\n              messageTooltips=\"Funcionarios públicos nacionales, provinciales o municipales que ocupan u ocuparon altos cargos, puestos jerárquicos, como así también sus familiares\"\n            />\n            <label class=\"form-checkbox-label\" for=\"exposedPerson\"></label>\n            <label class=\"label-checkbox\">\n              Persona politicamente expuesta\n            </label>\n          </span>\n        </div>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-lg-8 pl-0\">\n        <span>\n          <button\n            [disabled]=\"!formPhysicalPerson.valid\"\n            class=\"btn btn-primary btn-heft\"\n            (click)=\"continue()\"\n            name=\"continueDataClientEmisionBtn\"\n          >\n            Continuar\n          </button>\n        </span>\n      </div>\n    </div>\n  </div>\n  <!-- Formulario Persona Juridica -->\n  <div\n    [formGroup]=\"formLegalPerson\"\n    class=\"col-12\"\n    *ngIf=\"\n      !loadingData && isLegalPerson !== 'undefined' && isLegalPerson === 'yes'\n    \"\n  >\n    <div class=\"row\">\n      <div class=\"col-lg-4 pl-0\">\n        <label>\n          Razon Social\n          <sup>*</sup>\n        </label>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-4 pl-0\">\n        <sxf-textbox\n          type=\"text\"\n          [value]=\"(client$ | async)?.companyname\"\n          formControlName=\"companyname\"\n          [disabled]=\"(clientFromEmission$ | async)?.companyname\"\n          label=\"\"\n          placeholder=\"Ingresá el nombre\"\n          [maxLength]=\"255\"\n          [helpFeedback]=\"\"\n          placement=\"bottom\"\n          messageTooltips=\"Ingresá solo carácteres alfanumericos\"\n          name=\"companynameClientEmission\"\n        ></sxf-textbox>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-lg-1 pl-0\">\n        <label>\n          Cód. Área\n          <sup>*</sup>\n        </label>\n      </div>\n      <div class=\"col-lg-3\">\n        <label>\n          Teléfono\n          <sup>*</sup>\n        </label>\n      </div>\n      <div class=\"col-lg-4\">\n        <label>\n          Mail\n          <sup>*</sup>\n        </label>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-1 pl-0 pr-0\">\n        <sxf-textbox\n          type=\"text\"\n          formControlName=\"prefix\"\n          label=\"\"\n          [maxLength]=\"5\"\n          [minLength]=\"2\"\n          placeholder=\"Cód. Área\"\n          [helpFeedback]=\"''\"\n          name=\"prefixClientEmission\"\n        ></sxf-textbox>\n      </div>\n      <div class=\"col-3\">\n        <sxf-textbox\n          type=\"text\"\n          formControlName=\"phone\"\n          label=\"\"\n          placeholder=\"Teléfono\"\n          [minLength]=\"6\"\n          [maxLength]=\"8\"\n          [helpFeedback]=\"''\"\n          name=\"phoneClientEmission\"\n        ></sxf-textbox>\n      </div>\n      <div class=\"col-4\">\n        <sxf-textbox\n          type=\"text\"\n          formControlName=\"email\"\n          label=\"\"\n          placeholder=\"Ingresá el email\"\n          [maxLength]=\"60\"\n          [helpFeedback]=\"''\"\n          name=\"emailClientEmission\"\n        ></sxf-textbox>\n        <span\n          *ngIf=\"\n            (formLegalPerson.controls.email.dirty ||\n              formLegalPerson.controls.email.touched) &&\n            !formLegalPerson.controls.email.errors\n          \"\n          class=\"text-danger\"\n        >\n          <b>Este email será usado para enviar la inspección por photo up</b>\n        </span>\n      </div>\n    </div>\n    <div class=\"row\" style=\"display: none;\">\n      <div class=\"col-lg-4\"></div>\n      <div class=\"col-lg-4\"></div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-4\">\n        <div class=\"form-checkbox\">\n          <input\n            type=\"checkbox\"\n            id=\"officialorganism\"\n            class=\"form-checkbox-input\"\n            formControlName=\"officialorganism\"\n            name=\"officialorganismClientEmission\"\n          />\n          <label class=\"form-checkbox-label\" for=\"officialorganism\"></label>\n          <label>\n            Organismo social\n          </label>\n        </div>\n      </div>\n      <div class=\"col-4\">\n        <div class=\"form-checkbox\">\n          <input\n            type=\"checkbox\"\n            id=\"consortium\"\n            formControlName=\"consortium\"\n            class=\"form-checkbox-input\"\n            name=\"consortiumClientEmission\"\n          />\n          <label class=\"form-checkbox-label\" for=\"consortium\"></label>\n          <label>\n            Consorcio\n          </label>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"row mt-3\">\n      <div class=\"col-lg-8 pl-0\">\n        <span>\n          <button\n            [disabled]=\"!formLegalPerson.valid\"\n            class=\"btn btn-primary btn-heft\"\n            (click)=\"continue()\"\n            name=\"continueClientEmissionBtn\"\n          >\n            Continuar\n          </button>\n        </span>\n      </div>\n    </div>\n  </div>\n</div>\n\n<sxf-modal #modalClient>\n  <div class=\"modal-header modal-header-items\">\n    <!-- <h4 class=\"modal-title\" id=\"modal-basic-title\">¿Los datos no coinciden?</h4> -->\n    <button\n      type=\"button\"\n      class=\"close\"\n      aria-label=\"Close\"\n      (click)=\"closeModal()\"\n      name=\"closeModalBtn\"\n    >\n      <span aria-hidden=\"true\">&times;</span>\n    </button>\n  </div>\n  <div class=\"modal-body modal-body-items\">\n    <h3>¿Los datos no coinciden?</h3>\n    <p>\n      Si el número de {{ documentDescription }} no coincide con los datos de\n      nombre y apellido verificá que no haya errores de tipeo. Si el error\n      persiste, por favor comunicate con tu ejecutivo de cuenta.\n    </p>\n  </div>\n\n  <div class=\"modal-footer\">\n    <div class=\"row\">\n      <div class=\"col-lg-4 offset-lg-8 pl-0\">\n        <button\n          type=\"button\"\n          class=\"btn btn-primary btn-lg btn-block\"\n          (click)=\"closeModal()\"\n          name=\"closeModalBtn\"\n        >\n          Volver\n        </button>\n      </div>\n    </div>\n  </div>\n</sxf-modal>\n\n<sxf-modal #modalNoClient>\n  <div class=\"modal-header modal-header-items\">\n    <h4 class=\"modal-title\" id=\"modal-basic-title\">Cliente existente</h4>\n    <button\n      type=\"button\"\n      class=\"close\"\n      aria-label=\"Close\"\n      (click)=\"closeModalNoClient()\"\n      name=\"closeModalBtn\"\n    >\n      <span aria-hidden=\"true\">&times;</span>\n    </button>\n  </div>\n  <div class=\"modal-body modal-body-items\">\n    <h3>Este cliente pertenece a otro productor</h3>\n    <p>\n      Pertenece a otra organización comercial deberá comunicarse con su\n      ejecutivo de cuenta para poder avanzar con esta solicitud.\n    </p>\n  </div>\n  <div class=\"modal-footer\">\n    <div class=\"row\">\n      <div class=\"col-lg-4 offset-lg-8 pl-0\">\n        <button\n          type=\"button\"\n          class=\"btn btn-primary btn-lg btn-block\"\n          (click)=\"closeModalNoClient()\"\n          name=\"closeModalBtn\"\n        >\n          Volver\n        </button>\n      </div>\n    </div>\n  </div>\n</sxf-modal>\n\n<sxf-modal #modalUW (closed)=\"closeUWModal()\">\n  <div class=\"modal-header\" style=\"padding: 1rem 2rem;\">\n    <button\n      type=\"button\"\n      class=\"close\"\n      aria-label=\"Close\"\n      (click)=\"closeUWModal('Cross click')\"\n    >\n      <span aria-hidden=\"true\">&times;</span>\n    </button>\n  </div>\n  <div class=\"modal-body\">\n    <h4>\n      La presente emisión va a requerir autorización de la compañía.\n    </h4>\n    <h4>¿Desea solicitar autorización?</h4>\n  </div>\n  <div class=\"modal-footer\">\n    <div class=\"row\">\n      <div class=\"col-lg-4 offset-lg-3 pl-0\">\n        <button\n          type=\"button\"\n          class=\"btn btn-modal btn-lg btn-block\"\n          (click)=\"closeUWModal()\"\n        >\n          Cancelar\n        </button>\n      </div>\n      <div class=\"col-lg-5 pl-0\">\n        <button\n          type=\"button\"\n          class=\"btn btn-primary btn-lg btn-block\"\n          (click)=\"closeUWModal('continue')\"\n        >\n          Continuar\n        </button>\n      </div>\n    </div>\n  </div>\n</sxf-modal>\n<sxf-modal #modalMobility [options]=\"{ size: 'lg' }\">\n  <div class=\"modal-header\">\n    <h6 class=\"modal-title\" id=\"modal-basic-title\">\n      Movilidad Sura\n    </h6>\n    <button\n      type=\"button\"\n      class=\"close\"\n      aria-label=\"Close\"\n      (click)=\"closeModalMobility()\"\n      [disabled]=\"loadingCosts\"\n    >\n      <span aria-hidden=\"true\">&times;</span>\n    </button>\n  </div>\n  <div class=\"modal-body\">\n    <h3>Movilidad Sura sólo está disponible para personas físicas.</h3>\n    <h6>\n      Si tu cliente es Jurídico debemos cancelar este producto y realizar una\n      recotización\n    </h6>\n  </div>\n  <div class=\"modal-footer\">\n    <div class=\"row\">\n      <div class=\"col-lg-2 offset-lg-4 pl-0\">\n        <button\n          type=\"button\"\n          class=\"btn btn-modal btn-lg btn-block\"\n          (click)=\"closeModalMobility()\"\n        >\n          Cancelar\n        </button>\n      </div>\n      <div class=\"col-lg-6 pl-0\">\n        <button\n          type=\"button\"\n          class=\"btn btn-primary\"\n          (click)=\"continueIsLegalPerson()\"\n        >\n          <span *ngIf=\"!loadingCosts\">Recotizar como Persona Jurídica</span>\n          <!-- <span *ngIf=\"loadingCosts\">Recotizando</span> -->\n        </button>\n      </div>\n    </div>\n  </div>\n</sxf-modal>\n\n<sxf-modal #newCosts [options]=\"{ backdrop: 'static', keyboard: false }\">\n  <div class=\"modal-header\">\n    <h4 class=\"modal-title\" id=\"modal-basic-title\">\n      Recotizando\n    </h4>\n  </div>\n  <div class=\"modal-body modal-body-items\">\n    <p *ngIf=\"!loadingCosts; else stillLoadingCost\">\n      Recotizamos sin el seguro de Movilidad, el nuevo valor de la cuota es de\n      <b>$ {{ newQuote | number: '1.0-0' }}</b>\n\n      <br />\n      Para mas detalle revisar el detalle del menú lateral.\n    </p>\n    <ng-template #stillLoadingCost>\n      <div class=\"row\">\n        <div class=\"col-12 text-center\">\n          <ng-lottie\n            [options]=\"suraLoaderConfig\"\n            width=\"8.75rem\"\n            height=\"6.25rem\"\n          ></ng-lottie>\n        </div>\n      </div>\n    </ng-template>\n  </div>\n\n  <div class=\"modal-footer\">\n    <div class=\"row\">\n      <div class=\"col-lg-4 offset-lg-8 pl-0\">\n        <button\n          type=\"button\"\n          class=\"btn btn-primary btn-lg btn-block\"\n          (click)=\"closeModalNewCosts()\"\n          [disabled]=\"loadingCosts\"\n          name=\"closeModalNewCostsBtn\"\n        >\n          Aceptar\n        </button>\n      </div>\n    </div>\n  </div>\n</sxf-modal>\n","import cloneDeep from 'lodash/cloneDeep';\nimport { Component, OnInit, OnDestroy, ViewChild } from '@angular/core';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { Observable, Subscription, of, combineLatest, EMPTY } from 'rxjs';\nimport {\n  IGender,\n  GenderService,\n  IDocument,\n  IdentificationService,\n  ICrudIncome,\n  AccountService,\n  IAccount,\n  INationality,\n  NationalityService,\n  IAddress,\n  IPolicy,\n  IVehicle,\n  IMaritalStatus,\n  MaritalStatusService,\n  ClienteNService,\n  IClienteN,\n  UtilService,\n  ContactsService,\n  IOfficialIds,\n  IProvince,\n  ProvinceService,\n  QuotingService,\n  IPackage\n} from '@sura-platform/features';\n\nimport { PolicyAdapter } from '../../../quoting/adapters/policy.adapter';\nimport { FlowRouteEmissionService } from '../../../quoting/components/emission/services/flow-route-emission.service';\nimport * as fromEmission from '../../../quoting/components/emission/state';\nimport * as fromEmissionActions from '../../../quoting/components/emission/state/emission.actions';\n\nimport { IRoutes } from '@sura-platform/web/core/models/question/routes.interface';\nimport { Store } from '@ngrx/store';\n\nimport * as fromPolicy from '../../../quoting/state/policy/index';\nimport * as fromQuote from '../../../quoting/components/quote/state';\nimport * as fromPolicyActions from '../../../quoting/state/policy/policy.actions';\nimport * as fromQuoteActions from '../../../quoting/components/quote/state/quote.actions';\nimport { ModalComponent, SelectComponent } from '@sura-platform/web';\nimport { switchMap, catchError, tap, share } from 'rxjs/operators';\nimport { ApplicationError } from '@sura-platform/core/error/errors';\nimport * as moment from 'moment';\nimport { isNullOrUndefined } from '@swimlane/ngx-datatable';\n//import { IFault } from '@sura-platform/core/error/error.interface';\nimport { AnimationOptions } from 'ngx-lottie';\nimport { AnimationItem } from 'lottie-web';\nimport { ActivatedRoute } from '@angular/router';\nimport { IMotorConfiguration } from '../../../quoting/components/motor/motor.config';\nimport { IPremium } from '@sura-platform/features/package/interfaces/premium.interface';\nimport { ICoverage } from '@sura-platform/features/coverage';\n\n@Component({\n  selector: 'sxf-client-data',\n  templateUrl: './client-data.component.html',\n  styleUrls: ['./client-data.component.scss']\n})\nexport class ClientDataComponent implements OnInit, OnDestroy {\n  lottieConfig: AnimationOptions = {\n    path: '/assets/loadings/data-validation-loader.json',\n    loop: false,\n    autoplay: false\n  };\n\n  suraLoaderConfig: AnimationOptions = {\n    path: '/assets/loadings/sura-loader.json'\n  };\n\n  buttonLabel = 'Validar';\n  buttonAnimated: any;\n\n  constructor(\n    private fb: FormBuilder,\n    private genderService: GenderService,\n    private identificationService: IdentificationService,\n    private flowRouteEmissionService: FlowRouteEmissionService,\n    private storeEmission: Store<fromEmission.State>,\n    private accountService: AccountService,\n    private storePolicy: Store<fromPolicy.State>,\n    private storeQuote: Store<fromQuote.State>,\n    private nationalityService: NationalityService,\n    private maritalStatusService: MaritalStatusService,\n    private _clientNService: ClienteNService,\n    private utilService: UtilService,\n    private contactService: ContactsService,\n    private provinceService: ProvinceService,\n    private route: ActivatedRoute,\n    private policyAdapter: PolicyAdapter,\n    private quotingService: QuotingService\n  ) {\n    this.motorConfig = this.route.snapshot.data.config;\n  }\n\n  @ViewChild('documentType') documentSelect: SelectComponent = <\n    SelectComponent\n  >{};\n\n  @ViewChild('modalClient', { static: true }) modalClient: ModalComponent = <\n    ModalComponent\n  >{};\n\n  @ViewChild('modalNoClient', { static: true })\n  modalNoClient: ModalComponent = <ModalComponent>{};\n\n  @ViewChild('modalUW', { static: true }) modalUW: ModalComponent = <\n    ModalComponent\n  >{};\n\n  @ViewChild('modalMobility') modalMobility: ModalComponent = <\n    ModalComponent\n  >{};\n\n  @ViewChild('newCosts') modalNewCosts: ModalComponent = <ModalComponent>{};\n  //@ViewChild('content', { static: false }) content: ElementRef;\n\n  routes: IRoutes[] = <IRoutes[]>[];\n\n  accounts: IAccount = <IAccount>{};\n\n  /**\n   * Disabled fields for US-5573\n   */\n  disabledFields = false;\n\n  /**\n   * Variable Fiscal condition for get data from api\n   */\n  fiscalConditions$: Subscription = new Subscription();\n\n  /**\n   * Variable Crud income for get data from api\n   */\n  iibb$: Observable<ICrudIncome[]> = new Observable();\n\n  isValidateDocument = false;\n\n  client$: Observable<any> = new Observable();\n\n  clientFromEmission$: Observable<IAccount> = new Observable();\n\n  searchClient$: Observable<any> = new Observable();\n\n  isLegalPerson = 'undefined';\n\n  form: FormGroup = <FormGroup>{};\n\n  loadingData = false;\n\n  formPhysicalPerson: FormGroup = <FormGroup>{};\n\n  formLegalPerson: FormGroup = <FormGroup>{};\n\n  genders$: Observable<IGender[]> = new Observable();\n\n  maritalStatus$: Observable<IMaritalStatus[]> = new Observable();\n\n  documents$: Observable<IDocument[]> = new Observable();\n\n  nationalities$: Observable<INationality[]> = new Observable();\n\n  disabledByRetrieve$: Subscription = new Subscription();\n  disabledByRetrieve: boolean;\n\n  maxLength = 8;\n  documentDescription = 'DNI';\n\n  currentAccount: IAccount = <IAccount>{};\n\n  currentPolicy: IPolicy = <IPolicy>{};\n  currentMotor: IVehicle = <IVehicle>{};\n  vehicles: IVehicle[] = <IVehicle[]>[];\n  showForms = false;\n  currentData: any;\n  currentAccountEmission: any;\n  clientBaseN$: Observable<IClienteN[]> = new Observable();\n  accountReset: IAccount = <IAccount>{};\n  accountResetSubscription: Subscription = new Subscription();\n\n  provincesFromApi: IProvince[] = <IProvince[]>[];\n\n  resetResidenceValues: IAddress = {\n    state: null,\n    id: null,\n    city: null,\n    postalcode: null,\n    street: null,\n    streetnumber: null,\n    apartment: null,\n    floor: null,\n    type: null,\n    clarification: null\n  };\n\n  currentBlackList = false;\n\n  maxDateClient: any;\n  minDateClient: any;\n  motorConfig: IMotorConfiguration[];\n\n  /**\n   * True whether policy has mobility active\n   *\n   * @memberof ClientDataComponent\n   */\n  hasMobility = false;\n\n  MOBILITY_CODE = 'SURA_CA7_MobilityTheftDamageCov';\n\n  /**\n   * True whether call costs endpoint, recotización\n   *\n   * @memberof ClientDataComponent\n   */\n  loadingCosts = false;\n  newQuote = '';\n\n  callCostsSubscription: Subscription = new Subscription();\n\n  ngOnInit() {\n    this.provinceService\n      .getAllProvinces()\n      .subscribe((provs) => (this.provincesFromApi = provs));\n\n    this.utilService.getCurrentServerDate().subscribe((data) => {\n      const currentDate = new Date(data.datetime); // moment().add(9, 'month');\n      const currentDateForMinDateTime = new Date(data.datetime);\n      const date = {\n        year: currentDate.getFullYear() - 16,\n        month: currentDate.getMonth() + 1,\n        day: currentDate.getDate()\n      };\n      this.maxDateClient = date;\n\n      const minDateTime = {\n        year: currentDateForMinDateTime.getFullYear() - 116,\n        month: currentDateForMinDateTime.getMonth() + 1,\n        day: currentDateForMinDateTime.getDate()\n      };\n\n      this.minDateClient = minDateTime;\n    });\n    this.accountResetSubscription = this.storeQuote\n      .select(fromPolicy.getInitialAccountState)\n      .subscribe((initState) => {\n        this.accountReset = initState;\n      });\n\n    this.genders$ = this.genderService.getGenders();\n\n    this.maritalStatus$ = this.maritalStatusService.getMaritalStatus();\n\n    combineLatest([\n      this.storePolicy.select(fromPolicy.getPolicyData),\n      this.storeQuote.select(fromQuote.getQuoteMotorData)\n    ]).subscribe((data) => {\n      this.currentPolicy = data[0];\n      this.currentMotor = data[0].motor.vehicles.filter(\n        (c) => c.number === data[1].activeMotor\n      )[0];\n      this.vehicles = data[0].motor.vehicles;\n\n      // Se busca si algún vehículo tiene movilidad\n      this.vehicles.some((v) => {\n        const currentPkg = v?.packages?.find((p) => p.selected);\n\n        this.hasMobility = <boolean>(\n          currentPkg?.coverages?.some(\n            (c) => c.pattern.code === this.MOBILITY_CODE\n          )\n        );\n\n        // Si al menos un vehiculo tiene movilidad se sale\n        if (this.hasMobility) {\n          return true;\n        }\n      });\n    });\n\n    this.form = this.fb.group({\n      document: [\n        !this.currentPolicy.client.documentType\n          ? 'SSN'\n          : this.currentPolicy.client.documentType,\n        Validators.required\n      ],\n      documentNumber: [\n        this.currentPolicy.client.documentNumber,\n        [\n          Validators.required,\n          Validators.pattern('^[0-9]+$'),\n          Validators.minLength(8)\n        ]\n      ]\n    });\n\n    this.documents$ = this.identificationService.getDocumentTypes();\n\n    this.nationalities$ = this.nationalityService.getNationalities().pipe(\n      switchMap((x) => {\n        const nationatiliesFromServer = [];\n        const argentino = x.filter((g) => g.description === 'Argentino(a)')[0];\n\n        nationatiliesFromServer.push(argentino);\n\n        x.filter((j) => j.code !== 'N010').forEach((f) => {\n          nationatiliesFromServer.push(f);\n        });\n\n        return of(nationatiliesFromServer);\n      })\n    );\n\n    this.storeEmission.select(fromEmission.getRoutes).subscribe((data) => {\n      this.routes = data;\n    });\n\n    this.formPhysicalPerson = this.fb.group({\n      firstname: [\n        ,\n        [\n          Validators.required,\n          Validators.pattern('[A-zÀ-ÿ ]*'),\n          Validators.maxLength(100)\n        ]\n      ],\n      lastname: [\n        ,\n        [\n          Validators.required,\n          Validators.pattern('[A-zÀ-ÿ ]*'),\n          Validators.maxLength(100)\n        ]\n      ],\n      birth: [, Validators.required],\n      nationality: [, Validators.required],\n      maritalstatus: [, Validators.required],\n      gender: [, Validators.required],\n      prefix: [\n        ,\n        [\n          Validators.required,\n          Validators.minLength(2),\n          Validators.maxLength(5),\n          Validators.pattern(/^\\d+$/)\n        ]\n      ],\n      phone: [\n        ,\n        [\n          Validators.required,\n          Validators.minLength(6),\n          Validators.maxLength(8),\n          Validators.pattern(/^-?(0|[1-9]\\d*)?$/)\n        ]\n      ],\n      email: [\n        '',\n        [\n          Validators.required,\n          Validators.pattern(\n            '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\\\.[a-zA-Z]{2,4}$'\n          ),\n          Validators.maxLength(60)\n        ]\n      ],\n      exposedPerson: [false]\n    });\n\n    this.formPhysicalPerson\n      .get('birth')\n      ?.valueChanges.pipe(\n        switchMap((x) => {\n          const _birthDate = moment(x).subtract(1, 'months');\n          return of(_birthDate);\n        })\n      )\n      .subscribe();\n\n    this.formLegalPerson = this.fb.group({\n      companyname: [, [Validators.required, Validators.maxLength(255)]],\n      consortium: [],\n      officialorganism: [],\n      prefix: [\n        ,\n        [\n          Validators.required,\n          Validators.minLength(2),\n          Validators.maxLength(5),\n          Validators.pattern(/^\\d+$/)\n        ]\n      ],\n      phone: [\n        ,\n        [\n          Validators.required,\n          Validators.minLength(6),\n          Validators.maxLength(8),\n          Validators.pattern(/^-?(0|[1-9]\\d*)?$/)\n        ]\n      ],\n      email: [\n        ,\n        [\n          Validators.required,\n          Validators.pattern(\n            '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\\\.[a-zA-Z]{2,4}$'\n          )\n        ]\n      ]\n    });\n\n    this.client$ = this.storePolicy.select(fromPolicy.getClientData).pipe(\n      switchMap((x: IAccount) => {\n        this.currentAccount = x;\n        // Si es persona fisica\n        if (x.type === 'Person') {\n          this.isLegalPerson = 'not';\n          this.form.patchValue(\n            {\n              document:\n                x.documentType === null\n                  ? this.form.get('document')?.value\n                  : x.documentType,\n              documentNumber:\n                x.documentNumber === null\n                  ? this.form.get('documentNumber')?.value\n                  : x.documentNumber\n            },\n            { emitEvent: false }\n          );\n\n          this.formPhysicalPerson.patchValue({\n            firstname: x.firstname?.toUpperCase(),\n            lastname: x.lastname?.toUpperCase(),\n            birth: !isNullOrUndefined(x.birth)\n              ? {\n                  year: parseInt(x.birth.substring(0, 4), 0),\n                  month: parseInt(x.birth.substring(5, 7), 0),\n                  day: parseInt(x.birth.substring(8, 10), 0)\n                }\n              : null,\n            nationality: x.nationality,\n            maritalstatus: x.maritalstatus,\n            gender: x.gender,\n            prefix: !isNullOrUndefined(x.cellphone) ? x.cellphone.area : [],\n            phone: !isNullOrUndefined(x.cellphone) ? x.cellphone.number : [],\n            email: x.email,\n            exposedPerson: x.politicallyexposed\n          });\n        } else if (x.type === 'Company') {\n          this.isLegalPerson = 'yes';\n          this.openModalMobility();\n          this.form.patchValue(\n            {\n              document: x.documentType,\n              documentNumber: x.documentNumber\n            },\n            { emitEvent: false }\n          );\n          this.form.updateValueAndValidity();\n          this.formLegalPerson.patchValue({\n            companyname: x.companyname?.toUpperCase(),\n            consortium: x.consortium,\n            prefix: x.workphone?.area,\n            phone: x.workphone?.number,\n            officialorganism: x.officialorganism,\n            email: x.email\n          });\n        }\n        return of(x);\n      }),\n      share()\n    );\n\n    this.clientFromEmission$ = this.storeEmission.select(\n      fromEmission.getClientData\n    );\n\n    this.form.get('documentNumber')?.valueChanges.subscribe(() => {\n      this.formPhysicalPerson.reset();\n      this.formLegalPerson.reset();\n      this.isLegalPerson = 'undefined';\n      this.currentBlackList = false;\n    });\n\n    this.form.get('document')?.valueChanges.subscribe((data: any) => {\n      this.maxLength = 11;\n      switch (data) {\n        case 'SSN':\n          this.maxLength = 8;\n          this.documentDescription = 'DNI';\n          break;\n        case 'FEIN':\n          this.maxLength = 11;\n          this.documentDescription = 'CUIT';\n          break;\n        case 'CUILSura':\n          this.maxLength = 11;\n          this.documentDescription = 'CUIL';\n          break;\n        case 'PassportSura':\n          this.documentDescription = 'Pasaporte';\n          //this.maxLength = 0;\n          break;\n      }\n      this.formPhysicalPerson.reset();\n      this.formLegalPerson.reset();\n      this.currentBlackList = false;\n\n      this.form.get('documentNumber')?.reset();\n      this.isLegalPerson = 'undefined';\n    });\n\n    // ML: Verificar y deshabilitar el form en caso de que el usuario\n    // ya estaba asignado desde RETRIEVE\n    this.disabledByRetrieve$ = combineLatest([\n      this.storeEmission.select(fromEmission.getEmission),\n      this.storePolicy.select(fromPolicy.getClientData)\n    ]).subscribe((x) => {\n      const job = x[0].jobNumberFromQuotes;\n      const approved = x[0].approvedEmission;\n      const client = x[1];\n\n      this.disabledByRetrieve =\n        job && approved && client.accountnumber ? true : false;\n\n      if (this.disabledByRetrieve)\n        this.formPhysicalPerson.get('exposedPerson')?.disable();\n    });\n  }\n\n  validateDocumentNumber() {\n    if (\n      this.form.get('document')?.value === 'FEIN' &&\n      parseInt(this.form.get('documentNumber')?.value.substring(0, 2), 0) >= 30\n    ) {\n      this.isLegalPerson = 'yes';\n      this.openModalMobility();\n    } else {\n      this.isLegalPerson = 'not';\n    }\n\n    this.checkClienteN(this.form.get('documentNumber')?.value);\n\n    // Reset depende de form\n    const accountReset: IAccount = {\n      ...this.accountReset,\n      type: this.isLegalPerson === 'yes' ? 'Company' : 'Person',\n      documentType: this.form.get('document')?.value,\n      documentNumber: this.form.get('documentNumber')?.value,\n      address: <IAddress>{\n        ...this.accountReset.address,\n        state: <string>this.currentPolicy.insured?.address?.state,\n        city: <string>this.currentPolicy.insured?.address?.city\n      }\n    };\n\n    // Se setean vacias las propiedades client para policy y para emission.\n    this.storePolicy.dispatch(\n      new fromPolicyActions.SetClientDataAction(accountReset)\n    );\n\n    this.storeEmission.dispatch(\n      new fromEmissionActions.SetClientData(accountReset)\n    );\n\n    // Se limpia la descripcion de la ruta\n\n    this.routes.forEach((element) => {\n      if (element.path === 'residence') {\n        element.value = '';\n      }\n    });\n\n    // Se limpia la propiedad address para policy\n\n    this.storePolicy.dispatch(\n      new fromPolicyActions.SetAddressAction({\n        ...this.resetResidenceValues,\n        city: <string>this.currentPolicy.insured?.address?.city,\n        state: <string>this.currentPolicy.insured?.address?.state\n      })\n    );\n\n    const requestAccount: any = {\n      officialid: {\n        type: this.form.get('document')?.value,\n        value: this.form.get('documentNumber')?.value\n      }\n    };\n\n    const requestContact = {\n      type: this.isLegalPerson === 'yes' ? 'Company' : 'Person',\n      officialid: this.form.get('documentNumber')?.value\n    };\n\n    // Si el form (tipoDoc y nroDoc) es valido, entonces...\n    this.formPhysicalPerson.reset();\n    this.formLegalPerson.reset();\n\n    this.loadingData = true;\n    this.buttonLabel = 'Validando';\n    this.buttonAnimated.playSegments([[0, 119]], true);\n\n    // Busco por cuenta y por contacto..\n    this.searchClient$ = combineLatest([\n      this.accountService.getAccounts(requestAccount),\n      this.contactService.getContacts(requestContact)\n    ]).pipe(\n      switchMap((x) => {\n        const fromAccount = x[0];\n        const fromContact = x[1];\n        const typePerson = this.isLegalPerson === 'yes' ? 'Company' : 'Person';\n        this.buttonAnimated.playSegments([[120, 175]], false);\n        setTimeout(() => {\n          this.buttonLabel = 'Validado';\n        }, 2000);\n        this.loadingData = false;\n        // No encontre nada en account ni en contact\n        if (!fromAccount && !fromContact) {\n          return of(EMPTY);\n        } else {\n          // Si encuentro en account\n          if (fromAccount) {\n            fromAccount.documentNumber = this.form.get('documentNumber')?.value;\n            fromAccount.documentType = this.form.get('document')?.value;\n            fromAccount.address = fromAccount.primaryaddress;\n            this.storePolicy.dispatch(\n              new fromPolicyActions.SetClientDataAction(fromAccount)\n            );\n            this.storeEmission.dispatch(\n              new fromEmissionActions.SetClientData(cloneDeep(fromAccount))\n            );\n          } else {\n            const fromContactAddress = fromContact[0].address.split('|');\n            const _address: IAddress = {\n              id: fromContactAddress[0],\n              street: fromContactAddress[1],\n              streetnumber: fromContactAddress[2],\n              floor: fromContactAddress[3],\n              apartment: fromContactAddress[4],\n              postalcode: fromContactAddress[5],\n              city: fromContactAddress[6],\n              state: this.provincesFromApi.filter(\n                (p) => p.description === fromContactAddress[7]\n              )[0].code,\n              clarification: null,\n              type: 'home'\n            };\n            // Plancho en policy\n            this.storePolicy.dispatch(\n              new fromPolicyActions.SetBasicDataForClientAction(\n                typePerson,\n                fromContact[0].companyname.toUpperCase(),\n                fromContact[0].firstname.toUpperCase(),\n                fromContact[0].lastname.toUpperCase(),\n                fromContact[0].id,\n                this.form.get('documentNumber')?.value,\n                this.form.get('document')?.value,\n                _address\n              )\n            );\n            // Plancho en emission\n            this.storeEmission.dispatch(\n              new fromEmissionActions.SetBasicDataForClientAction(\n                typePerson,\n                fromContact[0].companyname.toUpperCase(),\n                fromContact[0].firstname.toUpperCase(),\n                fromContact[0].lastname.toUpperCase(),\n                fromContact[0].id,\n                this.form.get('documentNumber')?.value,\n                this.form.get('document')?.value,\n                _address\n              )\n            );\n          }\n          this.routes.forEach((element) => {\n            if (element.path === 'client') {\n              element.value =\n                this.isLegalPerson === 'yes'\n                  ? this.formLegalPerson.get('companyname')?.value\n                  : this.formPhysicalPerson.get('firstname')?.value +\n                    ' ' +\n                    this.formPhysicalPerson.get('lastname')?.value;\n            }\n          });\n          this.storeEmission.dispatch(\n            new fromEmissionActions.SetRoutes(this.routes)\n          );\n\n          return of(EMPTY);\n        }\n      }),\n      catchError((err: ApplicationError) => {\n        this.loadingData = false;\n        //si no pertenece el cliente a ese grupo comercial\n        if (parseInt(err.code, 0) === -1) {\n          this.openModalNoClient();\n        }\n        return of([]);\n      }),\n      share()\n    );\n  }\n\n  checkClienteN(officialId: any) {\n    this.clientBaseN$ = this._clientNService.validateClientN(officialId).pipe(\n      tap((ctl) => {\n        let blackList = false;\n        if (ctl !== null && ctl.length > 0) {\n          blackList = true;\n        }\n\n        this.currentBlackList = blackList;\n\n        if (this.currentBlackList) this.modalUW.openModal();\n      })\n    );\n  }\n\n  continue() {\n    const officialids: IOfficialIds[] = [];\n    officialids.push({\n      primary: true,\n      type: this.form.get('document')?.value,\n      value: this.form.get('documentNumber')?.value\n    });\n    this.currentAccount.officialids = officialids;\n\n    if (this.isLegalPerson === 'not' && this.formPhysicalPerson.valid) {\n      const formData = this.formPhysicalPerson.getRawValue();\n      (this.currentAccount.contactid = !this.currentAccount.contactid\n        ? null\n        : this.currentAccount.contactid),\n        (this.currentAccount.documentNumber = this.form.get(\n          'documentNumber'\n        )?.value),\n        (this.currentAccount.documentType = this.form.get('document')?.value),\n        (this.currentAccount.firstname = formData.firstname),\n        (this.currentAccount.lastname = formData.lastname),\n        (this.currentAccount.fiscalcondition = !this.currentAccount\n          .fiscalcondition\n          ? this.currentPolicy.fiscalcondition\n          : this.currentAccount.fiscalcondition);\n      this.currentAccount.type = 'Person';\n      this.currentAccount.maritalstatus = formData.maritalstatus;\n      this.currentAccount.nationality = formData.nationality;\n      this.currentAccount.gender = formData.gender;\n      this.currentAccount.email = formData.email;\n      this.currentAccount.birth = moment(\n        formData.birth.year +\n          '-' +\n          formData.birth.month +\n          '-' +\n          formData.birth.day\n      ).format();\n      this.currentAccount.politicallyexposed = formData.exposedPerson;\n      this.currentAccount.blacklist = this.currentBlackList;\n      this.currentAccount.cellphone = {\n        area: formData.prefix,\n        number: formData.phone\n      };\n\n      let workPhone = '';\n      if (this.currentAccount?.workphone) {\n        workPhone =\n          (this.currentAccount.workphone.area || '') +\n          (this.currentAccount.workphone.number || '');\n      }\n\n      this.storePolicy.dispatch(\n        new fromPolicyActions.SetInspectionPhoneNumberAction(workPhone)\n      );\n    } else if (this.formLegalPerson.valid && this.isLegalPerson === 'yes') {\n      const formData = this.formLegalPerson.getRawValue();\n      (this.currentAccount.contactid = !this.currentAccount.contactid\n        ? null\n        : this.currentAccount.contactid),\n        (this.currentAccount.documentNumber = this.form.get(\n          'documentNumber'\n        )?.value),\n        (this.currentAccount.documentType = this.form.get('document')?.value),\n        (this.currentAccount.companyname = formData.companyname);\n      this.currentAccount.fiscalcondition = !this.currentAccount.fiscalcondition\n        ? this.currentPolicy.fiscalcondition\n        : this.currentAccount.fiscalcondition;\n      this.currentAccount.email = formData.email;\n      this.currentAccount.consortium = formData.consortium;\n      this.currentAccount.officialorganism = formData.officialorganism;\n      this.currentAccount.blacklist = this.currentBlackList;\n      this.currentAccount.type = 'Company';\n      this.currentAccount.workphone = {\n        area: formData.prefix,\n        number: formData.phone\n      };\n\n      let phone = '';\n      if (this.currentAccount?.workphone) {\n        phone =\n          (this.currentAccount.workphone.area || '') +\n          (this.currentAccount.workphone.number || '');\n      }\n\n      this.storePolicy.dispatch(\n        new fromPolicyActions.SetInspectionPhoneNumberAction(phone)\n      );\n    }\n\n    this.storePolicy.dispatch(\n      new fromPolicyActions.SetClientDataAction(this.currentAccount)\n    );\n\n    this.storePolicy.dispatch(\n      new fromPolicyActions.SetMailDataAction(<string>this.currentAccount.email)\n    );\n    const vhc = this.vehicles.filter(\n      (x) => x.number === this.currentMotor.number\n    );\n    if (this.disabledByRetrieve) {\n      //TODO: Implementar de otra forma la detección del retrieve\n    } else if (\n      this.isLegalPerson === 'not' &&\n      vhc.length > 0 &&\n      vhc[0].driver\n    ) {\n      vhc[0].driver.clientIsDriver = this.motorConfig?.filter(\n        (p) => p.vehicleType === this.currentMotor.group\n      )[0]?.clientIsDriver;\n    } else if (this.vehicles) {\n      if (vhc.length > 0 && vhc[0].driver) {\n        vhc[0].driver.clientIsDriver = false;\n      }\n    }\n\n    this.storePolicy.dispatch(\n      new fromPolicyActions.UpdateVehicleAction(this.vehicles)\n    );\n\n    this.flowRouteEmissionService.enableRoute(this.routes, 'residence');\n\n    this.storeEmission.dispatch(\n      new fromEmissionActions.SetActiveRoute('residence')\n    );\n\n    this.routes.forEach((element) => {\n      if (element.path === 'residence') {\n        element.value = '';\n      }\n    });\n\n    this.routes.forEach((element) => {\n      if (element.path === 'client') {\n        element.value =\n          this.isLegalPerson === 'yes'\n            ? this.formLegalPerson.get('companyname')?.value\n            : this.formPhysicalPerson.get('firstname')?.value +\n              ' ' +\n              this.formPhysicalPerson.get('lastname')?.value;\n      }\n    });\n\n    this.flowRouteEmissionService.enableRoute(this.routes, 'residence');\n\n    if (this.formLegalPerson.valid || this.formPhysicalPerson.valid) {\n      this.storeEmission.dispatch(\n        new fromEmissionActions.SetFormEmissionClientIsValidAction(true)\n      );\n    }\n  }\n\n  closeModal() {\n    this.modalClient.closeModal();\n  }\n\n  openModal() {\n    this.modalClient.openModal();\n  }\n\n  closeModalNoClient() {\n    this.modalNoClient.closeModal();\n  }\n\n  openModalNoClient() {\n    this.modalNoClient.openModal();\n  }\n\n  ngOnDestroy(): void {\n    if (this.fiscalConditions$) {\n      this.fiscalConditions$.unsubscribe();\n    }\n    if (this.accountResetSubscription) {\n      this.accountResetSubscription.unsubscribe();\n    }\n\n    if (this.disabledByRetrieve$) {\n      this.disabledByRetrieve$.unsubscribe();\n    }\n\n    if (this.callCostsSubscription) {\n      this.callCostsSubscription.unsubscribe();\n    }\n  }\n\n  /**\n   * Control lottie animation\n   */\n  animationCreated(animationItem: AnimationItem): void {\n    this.buttonAnimated = animationItem;\n  }\n\n  closeUWModal(action?: string) {\n    if (action === 'continue') {\n      this.modalUW.closeModal();\n      return;\n    }\n\n    this.form.get('documentNumber')?.setValue('');\n    this.modalUW.closeModal();\n  }\n\n  /**\n   * Open modal mobility whether policy has mobility active\n   *\n   * @memberof ClientDataComponent\n   */\n  openModalMobility() {\n    if (this.hasMobility) {\n      this.modalMobility.openModal();\n    }\n  }\n\n  closeModalMobility() {\n    this.form.get('documentNumber')?.setValue('', { emitEvent: true });\n    this.form.get('document')?.setValue('SSN', { emitEvent: true });\n    this.modalMobility.closeModal();\n  }\n\n  continueIsLegalPerson() {\n    this.loadingCosts = true;\n    this.modalMobility.closeModal();\n    this.modalNewCosts.openModal();\n\n    // Se sacan los paquetes de movilidad\n    this.vehicles.forEach((v) => {\n      const currentPkg = v?.packages?.find((p) => p.selected);\n      if (currentPkg) {\n        currentPkg.coverages = <ICoverage[]>(\n          currentPkg?.coverages?.filter(\n            (c) => c.pattern.code !== this.MOBILITY_CODE\n          )\n        );\n      }\n    });\n\n    // Se hace la recotización\n    const adapted = this.policyAdapter.adapt(this.currentPolicy);\n    adapted.motor.vehicles.forEach((v) => {\n      v.packages = <IPackage[]>v.packages?.filter((p) => p.selected);\n    });\n\n    this.callCostsSubscription = this.quotingService\n      .getCosts(adapted)\n      .subscribe((newCosts) => {\n        // Solo guardaré en costs la cotización del vehículo actual\n        const packageSelected = this.currentMotor?.packages?.find(\n          (p) => p.selected\n        );\n\n        this.storePolicy.dispatch(\n          new fromPolicyActions.UpdateCostsAction(\n            newCosts.costs?.filter((c: any) =>\n              c.externalId\n                .split('&')\n                .includes(\n                  `${this.currentPolicy.productcode},${this.currentMotor.number},${packageSelected?.code}`\n                )\n            )\n          )\n        );\n\n        this.vehicles.forEach((v) => {\n          // Actualizar preminewCostsums con el resultado de la nueva cotización\n          const selected = v?.packages?.find((p) => p.selected);\n\n          // Buscar error en motor.errors de este vehículo y paquete\n          const error = newCosts.errors?.find((e: any) =>\n            e.externalId\n              .split('&')\n              .includes(\n                `${this.currentPolicy.productcode},${v.number},${selected?.code}`\n              )\n          );\n\n          // Busco los datos del paquete con la nueva cotización si existiera\n          const newPackage = newCosts.motor.vehicles\n            ?.find((costVehicle: any) => costVehicle.number === v.number)\n            ?.packages.find((p: any) => p.code === selected?.code);\n\n          if (!error?.code) {\n            if (selected) {\n              selected.premiums = <IPremium>newPackage?.premiums;\n            }\n\n            this.newQuote = newCosts.costs\n              ?.find((c: any) =>\n                c.externalId\n                  .split('&')\n                  .includes(\n                    `${this.currentPolicy.productcode},${v.number},${selected?.code}`\n                  )\n              )\n              .invoice.toString();\n            this.newQuote = <string>(\n              (this.newQuote ? parseFloat(this.newQuote).toFixed(2) : '')\n            );\n          } else {\n            if (selected) {\n              selected.premiums = <IPremium>{};\n            }\n\n            this.newQuote = '';\n          }\n        });\n\n        this.storePolicy.dispatch(\n          new fromPolicyActions.UpdateVehicleAction(this.vehicles)\n        );\n\n        this.storeQuote.dispatch(\n          new fromQuoteActions.SetCostsResponseAction(newCosts)\n        );\n\n        this.loadingCosts = false;\n      });\n  }\n\n  closeModalNewCosts() {\n    this.modalNewCosts.closeModal();\n  }\n}\n","import { reduce } from './reduce';\nfunction toArrayReducer(arr, item, index) {\n    if (index === 0) {\n        return [item];\n    }\n    arr.push(item);\n    return arr;\n}\nexport function toArray() {\n    return reduce(toArrayReducer, []);\n}\n//# sourceMappingURL=toArray.js.map","<div class=\"col-12\">\n  <div class=\"row\">\n    <div class=\"col-lg-12 pl-0\">\n      <ng-template #stillLoading>\n        <div class=\"grid-container\">\n          <div class=\"grid-item\">\n            <button class=\"btn btn-primary btn-block\">\n              Cargando...\n            </button>\n          </div>\n        </div>\n      </ng-template>\n      <div class=\"grid-container\" *ngIf=\"residences$ | async as addresses\">\n        <span class=\"data-not-found\" *ngIf=\"addresses.length == 0\">\n          No se encontraron resultados\n        </span>\n        <div class=\"grid-item\" *ngFor=\"let address of addresses\">\n          <button\n            [ngClass]=\"{\n              active: address.id === addressIdSelected\n            }\"\n            (click)=\"selectAddress(address)\"\n            class=\"btn btn-primary btn-block\"\n            (keydown.enter)=\"onEnter()\"\n            name=\"selectAddressClientEmissionBtn\"\n            [disabled]=\"disabledByRetrieve\"\n          >\n            {{ address.street | uppercase }}\n            {{ address.streetnumber | uppercase }},\n            {{ address.city | uppercase }}\n          </button>\n        </div>\n        <div class=\"grid-item\">\n          <button\n            [ngClass]=\"{\n              active: addressIdSelected === null\n            }\"\n            (click)=\"addAddress([])\"\n            class=\"btn btn-primary btn-block\"\n            name=\"addAddressClientEmissionBtn\"\n            [disabled]=\"disabledByRetrieve\"\n          >\n            + Agregar nuevo domicilio\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n<div *ngIf=\"addressType$ | async as addressType\">\n  <div [formGroup]=\"formClientResidence\" class=\"col-12\">\n    <div class=\"row\">\n      <div class=\"col-lg-4 pl-0\">\n        <label>\n          Cód. postal\n          <sup>*</sup>\n        </label>\n      </div>\n      <div class=\"col-lg-4\">\n        <label>\n          Provincia\n          <sup>*</sup>\n        </label>\n      </div>\n      <div class=\"col-lg-4\">\n        <label>\n          Localidad\n          <sup>*</sup>\n        </label>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-lg-4 pl-0\">\n        <sxf-textbox\n          type=\"text\"\n          formControlName=\"postalcode\"\n          (keyup.enter)=\"validatePostalCode()\"\n          [disabled]=\"!clientIsEditable\"\n          label=\"\"\n          placeholder=\"Codigo Postal\"\n          [maxLength]=\"4\"\n          name=\"postalcodeAddressEmission\"\n        ></sxf-textbox>\n      </div>\n      <div class=\"col-lg-4\">\n        <sxf-select\n          #province\n          formControlName=\"state\"\n          (keydown.enter)=\"onEnter()\"\n          [disabled]=\"!clientIsEditable\"\n          [items]=\"provinces$ | async\"\n          bindLabel=\"description\"\n          bindValue=\"code\"\n          [multiple]=\"false\"\n          class=\"custom\"\n          [searchable]=\"true\"\n          placeholder=\"Provincia\"\n          [dropdownPosition]=\"'bottom'\"\n          name=\"stateAddressEmission\"\n          [loading]=\"loadingPostalCode\"\n        ></sxf-select>\n      </div>\n      <div class=\"col-lg-4\">\n        <sxf-select\n          #location\n          formControlName=\"city\"\n          (keydown.enter)=\"onEnter()\"\n          [disabled]=\"!clientIsEditable || loadingPostalCode\"\n          [items]=\"locations$\"\n          bindLabel=\"city\"\n          bindValue=\"city\"\n          [multiple]=\"false\"\n          class=\"custom\"\n          [searchable]=\"true\"\n          placeholder=\"Localidad\"\n          [dropdownPosition]=\"'bottom'\"\n          name=\"cityAddressEmission\"\n        ></sxf-select>\n      </div>\n    </div>\n\n    <div class=\"row\">\n      <div class=\"col-lg-5 pl-0\">\n        <label>\n          Calle\n          <sup>*</sup>\n        </label>\n      </div>\n      <div class=\"col-lg-3\">\n        <label>\n          Altura\n          <sup>*</sup>\n        </label>\n      </div>\n      <div class=\"col-lg-2\">\n        <label>\n          Piso\n        </label>\n      </div>\n      <div class=\"col-lg-2\">\n        <label>\n          Depto\n        </label>\n      </div>\n    </div>\n\n    <div class=\"row\">\n      <div class=\"col-lg-5 pl-0\">\n        <sxf-textbox\n          type=\"text\"\n          formControlName=\"street\"\n          (keydown.enter)=\"onEnter()\"\n          [disabled]=\"!clientIsEditable\"\n          label=\"\"\n          placeholder=\"Calle\"\n          [maxLength]=\"200\"\n          name=\"streetAddressEmission\"\n        ></sxf-textbox>\n      </div>\n      <div class=\"col-lg-3\">\n        <sxf-textbox\n          type=\"text\"\n          formControlName=\"streetnumber\"\n          (keydown.enter)=\"onEnter()\"\n          [disabled]=\"!clientIsEditable\"\n          label=\"\"\n          placeholder=\"Altura\"\n          [maxLength]=\"10\"\n          name=\"streetNumberAddressEmission\"\n        ></sxf-textbox>\n      </div>\n      <div class=\"col-lg-2\">\n        <sxf-textbox\n          type=\"text\"\n          formControlName=\"floor\"\n          (keydown.enter)=\"onEnter()\"\n          [disabled]=\"!clientIsEditable\"\n          label=\"\"\n          placeholder=\"Piso\"\n          [maxLength]=\"10\"\n          name=\"floorAddressEmission\"\n        ></sxf-textbox>\n      </div>\n      <div class=\"col-lg-2\">\n        <sxf-textbox\n          type=\"text\"\n          formControlName=\"apartment\"\n          (keydown.enter)=\"onEnter()\"\n          [disabled]=\"!clientIsEditable\"\n          label=\"\"\n          placeholder=\"Depto\"\n          [maxLength]=\"10\"\n          name=\"apartmentAddressEmission\"\n        ></sxf-textbox>\n      </div>\n      <!-- <div class=\"col-lg-4\">\n      <sxf-select #typehab formControlName=\"typehab\" [items]=\"[]\" bindLabel=\"typehab\" bindValue=\"code\"\n        [multiple]=\"false\" class=\"custom\" [searchable]=\"true\" placeholder=\"\" [dropdownPosition]=\"'bottom'\"></sxf-select>\n    </div> -->\n    </div>\n\n    <div class=\"row\">\n      <div class=\"col-lg-4 pl-0\">\n        <label>\n          Tipo\n          <sup>*</sup>\n        </label>\n      </div>\n      <div class=\"col-lg-8 pl-0\">\n        <label>\n          Aclaraciones\n        </label>\n      </div>\n    </div>\n\n    <div class=\"row\">\n      <div class=\"col-lg-4 pl-0\">\n        <sxf-select\n          #typeHome\n          formControlName=\"type\"\n          (keydown.enter)=\"onEnter()\"\n          [disabled]=\"!clientIsEditable\"\n          [items]=\"addressType\"\n          bindLabel=\"description\"\n          bindValue=\"code\"\n          [multiple]=\"false\"\n          class=\"custom\"\n          [searchable]=\"true\"\n          placeholder=\"Tipo de vivienda\"\n          [dropdownPosition]=\"'bottom'\"\n          name=\"typeAddressEmission\"\n        ></sxf-select>\n      </div>\n      <div class=\"col-lg-8 pl-0\">\n        <sxf-textbox\n          type=\"text\"\n          formControlName=\"clarification\"\n          (keydown.enter)=\"onEnter()\"\n          [disabled]=\"!clientIsEditable\"\n          label=\"\"\n          placeholder=\"Notas\"\n          name=\"clarificationAddressEmission\"\n        ></sxf-textbox>\n      </div>\n    </div>\n\n    <div class=\"row pt-4\">\n      <div class=\"col-lg-8 pl-0\">\n        <span>\n          <button\n            [disabled]=\"!formClientResidence.valid\"\n            (click)=\"continue()\"\n            class=\"btn btn-primary btn-heft\"\n            name=\"continueAddressEmissionBtn\"\n          >\n            Continuar\n          </button>\n        </span>\n        <span class=\"press-enter ml-3 mr-4\">\n          o presiona ENTER\n        </span>\n      </div>\n    </div>\n  </div>\n</div>\n\n<sxf-modal #newCosts [options]=\"{ backdrop: 'static', keyboard: false }\">\n  <div class=\"modal-header\">\n    <h4 class=\"modal-title\" id=\"modal-basic-title\">\n      Recotizando\n    </h4>\n    <!-- <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"closeModalNewCosts()\"\n      name=\"closeModalFiscalConditionNewCostsBtn\">\n      <span aria-hidden=\"true\">&times;</span>\n    </button> -->\n  </div>\n  <div class=\"modal-body modal-body-items\">\n    <p *ngIf=\"!loadingCosts; else stillLoadingCost\">\n      Recotizamos en base a la dirección del cliente, el nuevo valor de la cuota\n      es de\n      <b>$ {{ newQuote | number: '1.0-0' }}</b>\n      <br />\n      Para mas detalle revisar el detalle del menú lateral.\n    </p>\n    <ng-template #stillLoadingCost>\n      <div class=\"row\">\n        <div class=\"col-12 text-center\">\n          <ng-lottie\n            [options]=\"lottieConfig\"\n            width=\"8.75rem\"\n            height=\"6.25rem\"\n          ></ng-lottie>\n        </div>\n      </div>\n    </ng-template>\n  </div>\n\n  <div class=\"modal-footer\">\n    <div class=\"row\">\n      <div class=\"col-lg-4 offset-lg-8 pl-0\">\n        <button\n          type=\"button\"\n          class=\"btn btn-primary btn-lg btn-block\"\n          (click)=\"closeModalNewCosts()\"\n          [disabled]=\"loadingCosts\"\n          name=\"closeModalFiscalConditionNewCostsBtn\"\n        >\n          Aceptar\n        </button>\n      </div>\n    </div>\n  </div>\n</sxf-modal>\n","import { Component, OnInit, ViewChild, OnDestroy } from '@angular/core';\nimport {\n  FormGroup,\n  FormBuilder,\n  Validators,\n  FormControl\n} from '@angular/forms';\nimport { Observable, of, combineLatest, Subscription, EMPTY } from 'rxjs';\nimport {\n  IProvince,\n  ProvinceService,\n  LocationService,\n  ILocation,\n  IAddress,\n  AddressTypeService,\n  IAddressType,\n  IAccount,\n  IVehicle,\n  IPolicy,\n  QuotingService,\n  IPackage\n} from '@sura-platform/features';\nimport {\n  switchMap,\n  tap,\n  filter,\n  map,\n  groupBy,\n  mergeMap,\n  toArray,\n  catchError,\n  first\n} from 'rxjs/operators';\nimport { Store } from '@ngrx/store';\nimport * as fromQuote from '../../../quoting/components/quote/state';\nimport * as fromQuoteActions from '../../../quoting/components/quote/state/quote.actions';\nimport * as fromPolicy from '../../../quoting/state/policy';\nimport * as fromPolicyActions from '../../../quoting/state/policy/policy.actions';\nimport { PolicyAdapter } from '../../../quoting/adapters/policy.adapter';\nimport * as fromEmission from '../../../quoting/components/emission/state';\nimport * as fromEmissionActions from '../../../quoting/components/emission/state/emission.actions';\nimport { FlowRouteEmissionService } from '../../../quoting/components/emission/services/flow-route-emission.service';\nimport { IRoutes } from '@sura-platform/web/core/models/question/routes.interface';\nimport { ModalComponent } from '@sura-platform/web';\nimport { AnimationOptions } from 'ngx-lottie';\nimport { IPremium } from '@sura-platform/features/package/interfaces/premium.interface';\n// import * as fromPolicyActions from '../../../quoting/state/policy/policy.actions';\n\n@Component({\n  selector: 'sxf-client-residence',\n  templateUrl: './client-residence.component.html',\n  styleUrls: ['./client-residence.component.scss']\n})\nexport class ClientResidenceComponent implements OnInit, OnDestroy {\n  lottieConfig: AnimationOptions = {\n    path: '/assets/loadings/sura-loader.json'\n  };\n  zipCode = new FormControl('');\n  formClientResidence: FormGroup = <FormGroup>{};\n  provinces$: Observable<IProvince[]> = new Observable();\n  policyclientaddress$: Observable<IAddress> = new Observable();\n  primaryClientAddress$: Observable<IAddress> = new Observable();\n  provinceDescription = '';\n  locations$: Observable<ILocation[]> = new Observable();\n  routes: IRoutes[] = <IRoutes[]>[];\n  residences$: Observable<any> = new Observable();\n  addressType$: Observable<IAddressType[]> = new Observable();\n  defaultAddressType = '';\n  dataByPostalCodeSubscriber: Subscription = new Subscription();\n  dataByPostalCode$: Observable<any> = new Observable();\n  arrProvinces: IProvince[] = <IProvince[]>[];\n  addressIdSelected = '';\n  filledQuestion = false;\n  loadingPostalCode = false;\n  client: IAccount = <IAccount>{};\n  clientIsEditable = false;\n  vehicles: IVehicle[] = <IVehicle[]>[];\n  currentMotor: IVehicle = <IVehicle>{};\n  currentPolicy: IPolicy = <IPolicy>{};\n  loadingCosts = false;\n  newQuote = '';\n  getClientFromStore$: Subscription = new Subscription();\n\n  @ViewChild('newCosts') modalNewCosts: ModalComponent = <ModalComponent>{};\n\n  disabledByRetrieve$: Subscription = new Subscription();\n  disabledByRetrieve = false;\n  policySubscription: Subscription = new Subscription();\n\n  constructor(\n    private fb: FormBuilder,\n    private provinceService: ProvinceService,\n    private locationService: LocationService,\n    private storePolicy: Store<fromPolicy.State>,\n    private storeQuote: Store<fromQuote.State>,\n    private flowRouteEmissionService: FlowRouteEmissionService,\n    private storeEmission: Store<fromEmission.State>,\n    private _addressTypeService: AddressTypeService,\n    private quotingService: QuotingService,\n    private policyAdapter: PolicyAdapter\n  ) {}\n\n  ngOnInit() {\n    this.formClientResidence = this.fb.group({\n      id: [null],\n      state: [, Validators.required],\n      city: [, Validators.required],\n      postalcode: [, Validators.required],\n      street: [, Validators.required],\n      streetnumber: [, Validators.required],\n      apartment: [],\n      floor: [],\n      type: [, Validators.required],\n      clarification: []\n    });\n\n    this.storeEmission\n      .select(fromEmission.getClientData)\n      .subscribe((data) => (this.clientIsEditable = <boolean>data.editable));\n\n    this.storePolicy.select(fromPolicy.getClientData).subscribe((data) => {\n      this.client = data;\n    });\n\n    this.policySubscription = combineLatest([\n      this.storePolicy.select(fromPolicy.getPolicyData),\n      this.storeQuote.select(fromQuote.getQuoteMotorData)\n    ]).subscribe((data) => {\n      this.vehicles = data[0].motor.vehicles;\n      this.currentMotor = data[0].motor.vehicles.filter(\n        (c) => c.number === data[1].activeMotor\n      )[0];\n      this.currentPolicy = data[0];\n    });\n\n    this.provinces$ = this.provinceService.getAllProvinces().pipe(\n      switchMap((x) => {\n        this.arrProvinces = x;\n        return of(x);\n      })\n    );\n\n    this.addressType$ = this._addressTypeService.getAddressType().pipe(\n      tap((ty) => {\n        this.defaultAddressType = ty[0].code;\n        this.loadAddressSave();\n      })\n    );\n    this.addressIdSelected = '';\n\n    // ML: Verificar y deshabilitar el form en caso de que el usuario\n    // ya estaba asignado desde RETRIEVE\n    this.disabledByRetrieve$ = this.storeEmission\n      .select(fromEmission.getEmission)\n      .subscribe((emission) => {\n        const job = emission.jobNumberFromQuotes;\n        const approved = emission.approvedEmission;\n\n        this.disabledByRetrieve = job && approved ? true : false;\n      });\n  }\n\n  loadAddressSave() {\n    this.storeEmission.select(fromEmission.getRoutes).subscribe((data) => {\n      this.routes = data;\n    });\n\n    //Para evitar busqueda por codigo postal cuando ya hay guardada una direccion nueva\n    this.routes.forEach((element) => {\n      if (element.path === 'residence') {\n        if (element.value === null) {\n          this.filledQuestion = false;\n        } else {\n          this.filledQuestion = true;\n        }\n      }\n    });\n\n    this.residences$ = combineLatest([\n      this.storeEmission.select(fromEmission.getClientAddresses),\n      this.storePolicy.select(fromPolicy.getClientData)\n    ]).pipe(\n      switchMap((idd) => {\n        if (idd[0] === null) idd[0] = [];\n        const arrayAddress = idd[0].filter((jk) => jk.postalcode);\n\n        if (!(arrayAddress.length > 0)) {\n          if (\n            idd &&\n            idd.length > 1 &&\n            idd[1]?.address?.postalcode !== null &&\n            idd[1]?.address?.postalcode !== ''\n          ) {\n            this.addAddress(<any>idd[1].address);\n          } else {\n            this.addAddress([]);\n          }\n        }\n\n        //si hay una sola la selecciono por defecto siempre que no este ya una previamente guardada (cuando se vuelve una pregunta atras)\n        if (\n          arrayAddress.length === 1 &&\n          idd &&\n          idd.length > 0 &&\n          idd[1]?.address?.postalcode === null\n        ) {\n          this.selectAddress(arrayAddress[0]);\n        }\n        return of(arrayAddress);\n      })\n    );\n\n    this.formClientResidence.get('state')?.valueChanges.subscribe((data) => {\n      if (data !== null) {\n        // this.locations$ = this.locationService.getLocations(data);\n\n        this.locations$ = this.locationService.getLocations(data).pipe(\n          tap((x) => {\n            if (x.length === 1) {\n              this.formClientResidence\n                ?.get('city')\n                ?.setValue(x[0].city, { onlySelf: true, emitEvent: true });\n            } else {\n              this.formClientResidence\n                ?.get('city')\n                ?.setValue([], { onlySelf: true, emitEvent: false });\n            }\n          })\n        );\n      }\n    });\n\n    this.primaryClientAddress$ = <Observable<IAddress>>(\n      this.storePolicy.select(fromPolicy.getPrimaryAddressClient)\n    );\n\n    this.getClientFromStore$ = combineLatest([\n      this.storePolicy.select(fromPolicy.getClientData),\n      this.provinceService.getAllProvinces(),\n      this.storePolicy.select(fromPolicy.getAddress)\n    ])\n      .pipe(\n        filter(\n          (x) =>\n            x[0].address !== undefined &&\n            x[0].address !== null &&\n            x[0].address.state !== null\n        ),\n        switchMap((x: any) => {\n          const province = x[1].filter(\n            (p: any) => p.code === x[0].address.state\n          )[0];\n          this.provinceDescription = province.description;\n          this.formClientResidence.patchValue(\n            {\n              id: x[0].address.id,\n              state: x[0].address.state,\n              city: x[0].address.city,\n              postalcode: x[0].address.postalcode,\n              street: x[0].address.street,\n              streetnumber: x[0].address.streetnumber,\n              apartment: x[0].address.apartment,\n              floor: x[0].address.floor,\n              type: x[0].address.type,\n              clarification: x[0].address.clarification\n            },\n            { emitEvent: false }\n          );\n          if (x[0].address.id !== undefined)\n            this.addressIdSelected = x[0].address.id;\n\n          return of(x[0].address);\n        })\n      )\n      .subscribe();\n\n    this.formClientResidence\n      .get('postalcode')\n      ?.valueChanges.subscribe((data) => {\n        if (data !== null && data.length === 4 && !this.filledQuestion) {\n          this.loadingPostalCode = true;\n          this.validatePostalCode();\n        }\n      });\n  }\n\n  selectAddress(address: any) {\n    this.addressIdSelected = address.id;\n    this.clientIsEditable = false;\n    this.formClientResidence.patchValue(\n      {\n        id: address.id ? address.id : null,\n        state: address.state ? address.state : null,\n        city: address.city ? address.city : null,\n        postalcode: address.postalcode ? address.postalcode : null,\n        street: address.street ? address.street : null,\n        streetnumber: address.streetnumber ? address.streetnumber : null,\n        apartment: address.apartment ? address.apartment : null,\n        floor: address.floor ? address.floor : null,\n        type: address.type ? address.type : null,\n        clarification: address.clarification ? address.clarification : null\n      },\n      { emitEvent: false }\n    );\n\n    // const addressTemp = {\n    //   ...this.formClientResidence.value,\n    //   id: address.id\n    // };\n\n    this.storePolicy.dispatch(\n      new fromPolicyActions.SetAddressAction(this.formClientResidence.value)\n    );\n  }\n\n  addAddress(address: any) {\n    this.clientIsEditable = true;\n    if (address.length === 0) {\n      this.filledQuestion = false;\n      this.addressIdSelected = '';\n      this.formClientResidence.reset();\n\n      this.formClientResidence.patchValue(\n        {\n          type: this.defaultAddressType\n        },\n        { emitEvent: true }\n      );\n    } else {\n      this.addressIdSelected = address?.id;\n      this.formClientResidence.patchValue(\n        {\n          id: address?.id,\n          state: address?.state,\n          city: address?.city,\n          postalcode: address?.postalcode,\n          street: address?.street,\n          streetnumber: address?.streetnumber,\n          apartment: address?.apartment,\n          floor: address?.floor,\n          type: address?.type,\n          clarification: address?.clarification\n        },\n        { emitEvent: false }\n      );\n    }\n  }\n\n  onEnter() {\n    if (this.formClientResidence.valid) {\n      this.continue();\n    }\n  }\n\n  continue() {\n    this.storePolicy.dispatch(\n      new fromPolicyActions.SetAddressAction(this.formClientResidence.value)\n    );\n\n    // ML: En caso de ser cliente existente, debo enviar el policy.address\n    if (\n      this.client.accountnumber &&\n      this.formClientResidence.get('id')?.value === null\n    )\n      this.storePolicy.dispatch(\n        new fromPolicyActions.SetPolicyAddressAction(\n          this.formClientResidence.value\n        )\n      );\n\n    this.callCost();\n  }\n\n  callCost() {\n    if (this.disabledByRetrieve) {\n      this.closeModalNewCosts();\n      return;\n    }\n\n    combineLatest([\n      this.storePolicy.select(fromPolicy.getPolicyData),\n      this.storeEmission.select(fromEmission.getPolicyAddressFromQuote)\n    ])\n      .pipe(first())\n      .subscribe(([policy, address]) => {\n        if (\n          policy?.client?.address?.state === address?.state &&\n          policy?.client?.address?.city === address?.city\n        ) {\n          this.closeModalNewCosts();\n          return;\n        }\n\n        this.loadingCosts = true;\n        this.modalNewCosts.openModal();\n\n        const adapted = this.policyAdapter.adapt(policy);\n        adapted.motor.vehicles.forEach((v) => {\n          v.packages = <IPackage[]>v?.packages?.filter((p) => p.selected);\n        });\n\n        this.quotingService.getCosts(adapted).subscribe((newCosts: IPolicy) => {\n          // Solo guardaré en costs la cotización del vehículo actual\n          const packageSelected = this.currentMotor?.packages?.find(\n            (p) => p.selected\n          );\n\n          this.storePolicy.dispatch(\n            new fromPolicyActions.UpdateCostsAction(\n              newCosts.costs?.filter((c) =>\n                c.externalId\n                  .split('&')\n                  .includes(\n                    `${this.currentPolicy.productcode},${this.currentMotor.number},${packageSelected?.code}`\n                  )\n              )\n            )\n          );\n\n          this.vehicles.forEach((v) => {\n            // Actualizar premiums con el resultado de la nueva cotización\n            const selected = v?.packages?.find((p) => p.selected);\n\n            // Buscar error en motor.errors de este vehículo y paquete\n            const error = newCosts.errors?.find((e) =>\n              e.externalId\n                .split('&')\n                .includes(\n                  `${this.currentPolicy.productcode},${v.number},${selected?.code}`\n                )\n            );\n\n            // Busco los datos del paquete con la nueva cotización si existiera\n            const newPackage = newCosts?.motor?.vehicles\n              ?.find((costVehicle) => costVehicle.number === v.number)\n              ?.packages?.find((p) => p.code === selected?.code);\n\n            if (!error?.code) {\n              if (selected) {\n                selected.premiums = <IPremium>newPackage?.premiums;\n              }\n\n              this.newQuote = <string>(\n                newCosts?.costs\n                  ?.find((c) =>\n                    c?.externalId\n                      ?.split('&')\n                      ?.includes(\n                        `${this.currentPolicy.productcode},${v.number},${selected?.code}`\n                      )\n                  )\n                  ?.invoice.toString()\n              );\n              this.newQuote = <string>(\n                (this.newQuote ? parseFloat(this.newQuote).toFixed(2) : '')\n              );\n            } else {\n              if (selected) {\n                selected.premiums = <IPremium>{};\n              }\n\n              this.newQuote = '';\n            }\n          });\n\n          this.storePolicy.dispatch(\n            new fromPolicyActions.UpdateVehicleAction(this.vehicles)\n          );\n\n          this.storeQuote.dispatch(\n            new fromQuoteActions.SetCostsResponseAction(newCosts)\n          );\n\n          this.loadingCosts = false;\n        });\n      })\n      .unsubscribe();\n  }\n\n  closeModalNewCosts() {\n    this.modalNewCosts.closeModal();\n    this.routes.forEach((element) => {\n      if (element.path === 'residence') {\n        element.value =\n          this.client?.address?.street +\n          ' ' +\n          this.client?.address?.streetnumber +\n          ', ' +\n          this.arrProvinces.filter(\n            (f) => f.code === this.client?.address?.state\n          )[0].description;\n      }\n    });\n\n    this.storeEmission.dispatch(\n      new fromEmissionActions.SetActiveRoute('tax-condition')\n    );\n\n    if (this.formClientResidence.valid) {\n      this.storeEmission.dispatch(\n        new fromEmissionActions.SetFormEmissionResidenceIsValidAction(true)\n      );\n    }\n\n    this.flowRouteEmissionService.enableRoute(this.routes, 'tax-condition');\n  }\n\n  validatePostalCode() {\n    this.formClientResidence\n      ?.get('city')\n      ?.setValue([], { onlySelf: true, emitEvent: false });\n\n    this.provinces$ = this.provinceService.getAllProvinces();\n\n    this.locations$ = this.locationService\n      .getLocationAndProvince(this.formClientResidence.get('postalcode')?.value)\n      .pipe(\n        map((locations) => locations),\n        tap((x) => {\n          if (x) {\n            x = x.filter((zx) => zx.postalcode);\n            if (x.length === 1) {\n              this.formClientResidence\n                ?.get('city')\n                ?.setValue(x[0].city, { onlySelf: true, emitEvent: true });\n            } else {\n              this.formClientResidence\n                ?.get('city')\n                ?.setValue([], { onlySelf: true, emitEvent: false });\n            }\n          }\n        })\n      );\n\n    this.dataByPostalCode$ = this.locations$.pipe(\n      groupBy((state) => state.map((x) => x.state.description)),\n      mergeMap((x) => combineLatest([of(x.key), x.pipe(toArray())])),\n      map((x) => x[0])\n    );\n\n    this.dataByPostalCodeSubscriber = this.dataByPostalCode$\n      .pipe(\n        map((x) => {\n          if (x) {\n            this.loadingPostalCode = false;\n            const codes = x;\n            const distinctCodes: any[] = Array.from(new Set(codes));\n\n            if (distinctCodes.length === 1) {\n              const codeProvince = this.arrProvinces.filter(\n                (zg) => zg.description === distinctCodes[0].toString()\n              )[0];\n\n              this.formClientResidence\n                ?.get('state')\n                ?.setValue(codeProvince.code, {\n                  onlySelf: true,\n                  emitEvent: false\n                });\n              return distinctCodes[0];\n            } else {\n              // this.searchingLocations = false;\n              this.formClientResidence\n                ?.get('state')\n                ?.setValue([], { onlySelf: true, emitEvent: false });\n              return EMPTY;\n            }\n          }\n        }),\n        catchError(() => {\n          this.formClientResidence\n            .get('state')\n            ?.setValue([], { onlySelf: true, emitEvent: false });\n          this.formClientResidence\n            .get('city')\n            ?.setValue([], { onlySelf: true, emitEvent: false });\n          this.loadingPostalCode = false;\n          // alert(\n          //   'La busqueda no trajo ningun resultado. Cargue los datos manualmente.'\n          // );\n          return of([]);\n        })\n      )\n      .subscribe();\n  }\n\n  ngOnDestroy() {\n    if (this.disabledByRetrieve$) this.disabledByRetrieve$.unsubscribe();\n    if (this.getClientFromStore$) this.getClientFromStore$.unsubscribe();\n    if (this.policySubscription) this.policySubscription.unsubscribe();\n  }\n}\n","import { scan } from './scan';\nimport { takeLast } from './takeLast';\nimport { defaultIfEmpty } from './defaultIfEmpty';\nimport { pipe } from '../util/pipe';\nexport function reduce(accumulator, seed) {\n    if (arguments.length >= 2) {\n        return function reduceOperatorFunctionWithSeed(source) {\n            return pipe(scan(accumulator, seed), takeLast(1), defaultIfEmpty(seed))(source);\n        };\n    }\n    return function reduceOperatorFunction(source) {\n        return pipe(scan((acc, value, index) => accumulator(acc, value, index + 1)), takeLast(1))(source);\n    };\n}\n//# sourceMappingURL=reduce.js.map","<div class=\"row\">\n  <div [formGroup]=\"formClienTax\" class=\"col-lg-12\">\n    <div class=\"row\">\n      <div class=\"col-lg-4 pl-0\">\n        <label>\n          Condición fiscal\n          <sup>*</sup>\n        </label>\n      </div>\n      <div class=\"col-lg-4\" *ngIf=\"showIIBB\">\n        <label>\n          Ingresos Brutos\n          <sup>*</sup>\n        </label>\n      </div>\n      <div class=\"col-lg-4\" *ngIf=\"showiibbNumber\">\n        <label>\n          N° IIBB\n          <sup>*</sup>\n        </label>\n      </div>\n    </div>\n\n    <div class=\"row\">\n      <div class=\"col-lg-4 pl-0\">\n        <sxf-select #fiscalcondition formControlName=\"fiscalcondition\" (keydown.enter)=\"onEnter()\"\n          [items]=\"fiscalConditions$ | async\" bindLabel=\"description\" bindValue=\"code\" [multiple]=\"false\" class=\"custom\"\n          [searchable]=\"true\" placeholder=\"Cond. Fiscal\" dropdownPosition=\"bottom\" name=\"fiscalconditionSelectEmission\"\n          [disabled]=\"disabledByRetrieve\"></sxf-select>\n      </div>\n      <div class=\"col-lg-4\" *ngIf=\"showIIBB\">\n        <sxf-select #iibb formControlName=\"iibb\" (keydown.enter)=\"onEnter()\" [items]=\"iibb$ | async\"\n          bindLabel=\"description\" bindValue=\"code\" [multiple]=\"false\" class=\"custom\" [searchable]=\"true\"\n          placeholder=\"Ing. Brutos\" dropdownPosition=\"bottom\" name=\"iibbEmission\" [disabled]=\"disabledByRetrieve\">\n        </sxf-select>\n      </div>\n      <div class=\"col-lg-4\" *ngIf=\"showiibbNumber\">\n        <sxf-textbox #numiibb type=\"text\" formControlName=\"iibbNumber\" (keydown.enter)=\"onEnter()\" label=\"\"\n          placeholder=\"\" [helpFeedback]=\"''\" placement=\"bottom\" name=\"numIibbEmission\" [disabled]=\"disabledByRetrieve\">\n        </sxf-textbox>\n      </div>\n    </div>\n\n    <div class=\"row\" *ngIf=\"showCertified\">\n      <div class=\"col-lg-4 pl-0\">\n        <label>\n          Inicio de certificado\n          <sup>*</sup>\n        </label>\n      </div>\n      <div class=\"col-lg-4\">\n        <label>\n          Vencimiento de certificado\n          <sup>*</sup>\n        </label>\n      </div>\n    </div>\n\n    <div class=\"row\" *ngIf=\"showCertified\">\n      <div class=\"col-lg-4 pl-0\">\n        <sxf-datetimepicker formControlName=\"beginningValidity\" (keydown.enter)=\"onEnter()\"\n          name=\"beginningValidityFiscalConditionEmission\"></sxf-datetimepicker>\n      </div>\n      <div class=\"col-lg-4\">\n        <sxf-datetimepicker [minDate]=\"date\" [maxDate]=\"maxDate\" formControlName=\"endingValidity\"\n          (keydown.enter)=\"onEnter()\" name=\"endingValidityFiscalConditionEmission\"></sxf-datetimepicker>\n      </div>\n    </div>\n\n    <div class=\"row pt-4\">\n      <div class=\"col-lg-8 pl-0\">\n        <span>\n          <button [disabled]=\"!formClienTax.valid\" class=\"btn btn-primary btn-heft\" (click)=\"continue()\"\n            name=\"continueFiscalConditionBtn\">\n            Continuar\n          </button>\n        </span>\n        <span class=\"press-enter ml-3 mr-4\">\n          o presiona ENTER\n        </span>\n      </div>\n    </div>\n  </div>\n</div>\n\n<sxf-modal #modalFiscal>\n  <div class=\"modal-header\">\n    <h4 class=\"modal-title\" id=\"modal-basic-title\">\n      La condición fiscal no coincide\n    </h4>\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"closeModal()\" name=\"closeModalFiscalConditionBtn\">\n      <span aria-hidden=\"true\">&times;</span>\n    </button>\n  </div>\n  <div class=\"modal-body modal-body-items\">\n    <p>\n      La condición fiscal usada para cotizar no coincide con la registrada para\n      el cliente. Vamos a recotizar la cobertura elegida con la condición fiscal\n      existente. De haber un cambio en la misma, por favor comunicate con tu\n      Ejecutivo Comercial.\n    </p>\n  </div>\n\n  <div class=\"modal-footer\">\n    <div class=\"row\">\n      <div class=\"col-lg-4 offset-lg-8 pl-0\">\n        <button type=\"button\" class=\"btn btn-primary btn-lg btn-block\" (click)=\"closeModal()\"\n          name=\"closeModalFiscalConditionBtn\">\n          Aceptar\n        </button>\n      </div>\n    </div>\n  </div>\n</sxf-modal>\n\n<sxf-modal #newCosts>\n  <div class=\"modal-header\">\n    <h4 class=\"modal-title\" id=\"modal-basic-title\">\n      Nueva cotización\n    </h4>\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"closeModalNewCosts()\"\n      name=\"closeModalFiscalConditionNewCostsBtn\">\n      <span aria-hidden=\"true\">&times;</span>\n    </button>\n  </div>\n  <div class=\"modal-body modal-body-items\">\n    <ng-template #stillLoading>\n      <div class=\"row\">\n        <div class=\"col-12 text-center\">\n          <ng-lottie [options]=\"lottieConfig\" width=\"8.75rem\" height=\"6.25rem\"></ng-lottie>\n        </div>\n      </div>\n    </ng-template>\n    <p *ngIf=\"!loadingCosts; else stillLoading\">\n      Recotizamos tu cobertura con la condición fiscal registrada. el nuevo\n      valor de la cuota es de {{ newQuote | number: '1.0-0' }} Para mas detalle\n      revisar el detalle del menú lateral.\n    </p>\n  </div>\n\n  <div class=\"modal-footer\">\n    <div class=\"row\">\n      <div class=\"col-lg-4 offset-lg-8 pl-0\">\n        <button type=\"button\" class=\"btn btn-primary btn-lg btn-block\" (click)=\"closeModalNewCosts()\"\n          [disabled]=\"loadingCosts\" name=\"closeModalFiscalConditionNewCostsBtn\">\n          Aceptar\n        </button>\n      </div>\n    </div>\n  </div>\n</sxf-modal>","import { Component, OnInit, ViewChild, OnDestroy } from '@angular/core';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport {\n  IFiscalcondition,\n  ICrudIncome,\n  FiscalConditionService,\n  CrudIncomeService,\n  IAccount,\n  IPolicy,\n  QuotingService,\n  IVehicle\n} from '@sura-platform/features';\nimport { Observable, of, combineLatest, Subscription } from 'rxjs';\nimport { Store } from '@ngrx/store';\nimport { FlowRouteEmissionService } from '../../../quoting/components/emission/services/flow-route-emission.service';\nimport * as fromPolicy from '../../../quoting/state/policy';\nimport * as fromPolicyActions from '../../../quoting/state/policy/policy.actions';\nimport * as fromEmission from '../../../quoting/components/emission/state';\nimport * as fromEmissionActions from '../../../quoting/components/emission/state/emission.actions';\nimport * as fromQuote from '../../../quoting/components/quote/state';\nimport * as fromQuoteActions from '../../../quoting/components/quote/state/quote.actions';\nimport { IRoutes } from '@sura-platform/web/core/models/question/routes.interface';\nimport { switchMap, first } from 'rxjs/operators';\nimport { SelectComponent, ModalComponent } from '@sura-platform/web';\nimport { IPackage } from '@sura-platform/features/package';\nimport { NgbDateStruct } from '@ng-bootstrap/ng-bootstrap';\nimport { AnimationOptions } from 'ngx-lottie';\nimport { PolicyAdapter } from '../../../quoting/adapters/policy.adapter';\nimport { IPremium } from '@sura-platform/features/package/interfaces/premium.interface';\n\n@Component({\n  selector: 'sxf-client-tax-condition',\n  templateUrl: './client-tax-condition.component.html',\n  styleUrls: ['./client-tax-condition.component.scss']\n})\nexport class ClientTaxConditionComponent implements OnInit, OnDestroy {\n  lottieConfig: AnimationOptions = {\n    path: '/assets/loadings/sura-loader.json'\n  };\n  constructor(\n    private fb: FormBuilder,\n    private fiscalService: FiscalConditionService,\n    private iibbService: CrudIncomeService,\n    private storePolicy: Store<fromPolicy.State>,\n    private flowRouteEmissionService: FlowRouteEmissionService,\n    private storeEmission: Store<fromEmission.State>,\n    private quotingService: QuotingService,\n    private storeQuote: Store<fromQuote.State>,\n    private policyAdapter: PolicyAdapter\n  ) {}\n\n  @ViewChild('fiscalcondition')\n  fiscalConditionSelect: SelectComponent = <SelectComponent>{};\n  @ViewChild('iibb') iibbSelect: SelectComponent = <SelectComponent>{};\n\n  @ViewChild('modalFiscal') modalFiscal: ModalComponent = <ModalComponent>{};\n\n  @ViewChild('newCosts') modalNewCosts: ModalComponent = <ModalComponent>{};\n\n  /**\n   * Object any for pupulate the store\n   */\n  currentMotor: IVehicle = <IVehicle>{};\n\n  formClienTax: FormGroup = <FormGroup>{};\n\n  /**\n   * Variable Fiscal condition for get data from api\n   */\n  fiscalConditions$: Observable<IFiscalcondition[]> = new Observable();\n  /**\n   * Variable Crud income for get data from api\n   */\n  iibb$: Observable<ICrudIncome[]> = new Observable();\n\n  routes: IRoutes[] = <IRoutes[]>[];\n\n  currentPackageSelected: any;\n\n  client: IAccount = <IAccount>{};\n\n  /**\n   * variable to get policy from store\n   */\n  currentPolicy: IPolicy = <IPolicy>{};\n\n  packageSelected: IPackage = <IPackage>{};\n\n  arrayFiscalCondition: IFiscalcondition[] = <IFiscalcondition[]>[];\n  clientData: IAccount = <IAccount>{};\n  firstTimeFiscalCondition = false;\n\n  date: any;\n  maxDate: NgbDateStruct = <NgbDateStruct>{};\n  minDate: NgbDateStruct = <NgbDateStruct>{};\n  showCertified = false;\n  showIIBB = false;\n  showiibbNumber = false;\n  loadingCosts = false;\n  vehicles: IVehicle[] = <IVehicle[]>{};\n  firstTimeFiscalConditionChangeValue = false;\n  newQuote = '';\n  CONSUMIDOR_FINAL = 'consumidorFinal';\n  NORESPONSABLE = 'noResponsable';\n  arrCondFiscalOriginal: any[] = [];\n\n  disabledByRetrieve$: Subscription = new Subscription();\n  disabledByRetrieve = false;\n\n  ngOnInit() {\n    this.newQuote = '0';\n    const currentTime = new Date(Date.now());\n    const month = currentTime.getMonth() + 1;\n    const day = currentTime.getDate();\n    const year = currentTime.getFullYear();\n\n    this.date = {\n      day: day,\n      month: month,\n      year: year\n    };\n    this.firstTimeFiscalCondition = false;\n    this.firstTimeFiscalConditionChangeValue = false;\n    this.loadingCosts = false;\n    this.showIIBB = false;\n    this.showCertified = false;\n    this.showiibbNumber = true;\n\n    this.minDate = this.date;\n\n    this.maxDate = {\n      day: this.date.day,\n      month: month,\n      year: year + 10\n    };\n\n    combineLatest([\n      this.storePolicy.select(fromPolicy.getPolicyData),\n      this.storeQuote.select(fromQuote.getQuoteMotorData)\n    ])\n      .subscribe((data) => {\n        this.vehicles = data[0].motor.vehicles;\n        this.currentMotor = data[0].motor.vehicles.filter(\n          (c) => c.number === data[1].activeMotor\n        )[0];\n        this.currentPolicy = data[0];\n      })\n      .unsubscribe();\n\n    this.formClienTax = this.fb.group({\n      fiscalcondition: [\n        this.currentPolicy.fiscalcondition,\n        Validators.required\n      ],\n      iibb: [this.currentPolicy.iibb.type],\n      iibbNumber: [this.currentPolicy.iibb.number],\n      beginningValidity: [this.date],\n      endingValidity: []\n    });\n\n    this.iibb$ = this.iibbService.getAllCrudIncome();\n\n    this.storeEmission.select(fromEmission.getRoutes).subscribe((data) => {\n      this.routes = data;\n    });\n\n    // Si el cliente es existente maximo puedo mostrar 2 opciones\n\n    this.storePolicy\n      .select(fromPolicy.getPolicyData)\n      .subscribe((data) => {\n        const isLegalPerson = data.client.type === 'Company';\n        this.fiscalConditions$ = this.fiscalService\n          .getAllFiscalCondition()\n          .pipe(\n            switchMap((xa) => {\n              this.arrayFiscalCondition = xa;\n\n              let itemsFiscalConditionMandatory = this.CONSUMIDOR_FINAL;\n              if (isLegalPerson) {\n                itemsFiscalConditionMandatory = this.NORESPONSABLE;\n              }\n\n              let itemsFiscalCondition = [itemsFiscalConditionMandatory];\n              //si la condicion fiscal informada es diferente a la del cliente\n              if (\n                data.client.fiscalcondition !== itemsFiscalConditionMandatory\n              ) {\n                itemsFiscalCondition.push(<string>data.client.fiscalcondition);\n              }\n\n              let arrayConditionFiscal = [];\n\n              if (this.arrCondFiscalOriginal.length) {\n                itemsFiscalCondition = <string[]>this.arrCondFiscalOriginal;\n              }\n\n              //es cliente nuevo\n              if (data.client.contactid === null) {\n                let noCode = this.CONSUMIDOR_FINAL;\n                if (!isLegalPerson) {\n                  noCode = this.NORESPONSABLE;\n                }\n                arrayConditionFiscal = xa.filter((afc) => afc.code !== noCode);\n              } else {\n                arrayConditionFiscal = xa.filter((afc) =>\n                  itemsFiscalCondition.includes(afc.code)\n                );\n              }\n\n              if (\n                data.client.fiscalcondition !== data.fiscalcondition &&\n                !this.firstTimeFiscalCondition &&\n                data.client.contactid !== null\n              ) {\n                this.modalFiscal.openModal();\n              }\n\n              let options = { emitEvent: false, onlySelf: true };\n              if (!this.firstTimeFiscalCondition) {\n                this.firstTimeFiscalCondition = true;\n                options = { emitEvent: true, onlySelf: true };\n                this.activateCertifiedDates(data.client.fiscalcondition);\n                this.activateIIBB(data.client.fiscalcondition);\n                if (\n                  data.client.iibb &&\n                  data.client.iibb.type &&\n                  data.client.iibb.type !== null\n                )\n                  this.activateIIBBnumber(data.client.iibb.type);\n\n                this.arrCondFiscalOriginal = itemsFiscalCondition;\n              }\n\n              let fiscalConditionForm = data.client.fiscalcondition;\n              let iibbType = data.client.iibb?.type;\n\n              // caso en el que elijan una condicion fiscal que no corresponde con el tipo de persona\n              if (\n                arrayConditionFiscal.filter(\n                  (acf) => acf.code === data.client.fiscalcondition\n                ).length === 0 &&\n                data.client.contactid === null\n              ) {\n                if (isLegalPerson) {\n                  fiscalConditionForm = this.NORESPONSABLE;\n                  iibbType = iibbType || 'noInscripto';\n                } else {\n                  fiscalConditionForm = this.CONSUMIDOR_FINAL;\n                }\n                this.modalFiscal.openModal();\n              }\n\n              this.formClienTax.patchValue(\n                {\n                  fiscalcondition: fiscalConditionForm,\n                  iibb: iibbType,\n                  iibbNumber: data.client.iibb ? data.client.iibb.number : ''\n                },\n                options\n              );\n\n              return of(arrayConditionFiscal);\n            })\n          );\n      })\n      .unsubscribe();\n\n    this.formClienTax\n      .get('beginningValidity')\n      ?.valueChanges.subscribe((dateInit) => {\n        this.date = dateInit;\n        this.maxDate = {\n          day: this.date.day,\n          month: this.date.month,\n          year: this.date.year + 5\n        };\n      });\n\n    this.formClienTax.get('iibb')?.valueChanges.subscribe((iibb) => {\n      this.activateIIBBnumber(iibb);\n      this.updateCrudIncomeType(iibb);\n    });\n\n    this.formClienTax.get('fiscalcondition')?.valueChanges.subscribe((data) => {\n      let item = this.fiscalConditionSelect.getValue();\n      if (item === undefined) {\n        const fiscalTemp = this.arrayFiscalCondition.filter(\n          (afc) => afc.code === data\n        )[0];\n        item = fiscalTemp;\n      }\n\n      this.activateCertifiedDates(data);\n      this.activateIIBB(data);\n      this.updateConditionFiscal(item);\n\n      //FIXME: mejorar esto.. tengo que recotizar cada vez que ocurre un valuechange, pero no el 1ero..\n      //FIXME: porque el 1ero verifica si condiciones fiscales de cliente y cotizacion coinciden o no\n      if (!this.firstTimeFiscalConditionChangeValue) {\n        this.firstTimeFiscalConditionChangeValue = true;\n      } else {\n        this.callCost();\n      }\n    });\n\n    combineLatest([\n      this.storeEmission.select(fromEmission.getEmission),\n      this.storePolicy.select(fromPolicy.getFiscalCondition)\n    ]).subscribe((x) => {\n      const job = x[0].jobNumberFromQuotes;\n      const approved = x[0].approvedEmission;\n      const fiscalCondition = x[1];\n\n      this.disabledByRetrieve =\n        job && approved && fiscalCondition ? true : false;\n    });\n  }\n\n  ngOnDestroy() {\n    if (this.disabledByRetrieve$) this.disabledByRetrieve$.unsubscribe();\n  }\n\n  activateCertifiedDates(data: any) {\n    if (data === 'inscriptoExentoPercepcion') {\n      //inscriptoExentoPercepcion\n      this.showCertified = true;\n      this.formClienTax\n        .get('beginningValidity')\n        ?.setValidators(Validators.required);\n      this.formClienTax\n        .get('endingValidity')\n        ?.setValidators(Validators.required);\n\n      if (\n        this.currentPolicy.client.certificate &&\n        this.currentPolicy.client.certificate.start !== null\n      ) {\n        const _dateInitFromStore = this.currentPolicy.client.certificate.start.toString();\n        const _dateInit = {\n          year: parseInt(_dateInitFromStore.substring(0, 4), 0),\n          month: parseInt(_dateInitFromStore.substring(5, 7), 0),\n          day: parseInt(_dateInitFromStore.substring(8, 10), 0)\n        };\n        const _dateEndFromStore = this.currentPolicy?.client?.certificate?.end?.toString();\n        const _dateEnd = {\n          year: parseInt(<string>_dateEndFromStore?.substring(0, 4), 0),\n          month: parseInt(<string>_dateEndFromStore?.substring(5, 7), 0),\n          day: parseInt(<string>_dateEndFromStore?.substring(8, 10), 0)\n        };\n        this.formClienTax.patchValue(\n          {\n            beginningValidity: _dateInit,\n            endingValidity: _dateEnd\n          },\n          { emitEvent: false, onlySelf: true }\n        );\n      }\n    } else {\n      this.showCertified = false;\n      this.formClienTax.get('beginningValidity')?.clearValidators();\n      this.formClienTax.get('beginningValidity')?.updateValueAndValidity();\n      this.formClienTax.get('endingValidity')?.clearValidators();\n      this.formClienTax.get('endingValidity')?.updateValueAndValidity();\n    }\n  }\n\n  activateIIBB(data: any) {\n    if (data !== this.CONSUMIDOR_FINAL) {\n      //inscriptoExentoPercepcion\n      this.showIIBB = true;\n      this.formClienTax.get('iibb')?.setValidators(Validators.required);\n      this.activateIIBBnumber(\n        this.currentPolicy.client.iibb && this.currentPolicy.client.iibb.type\n          ? this.currentPolicy.client.iibb.type\n          : ''\n      );\n    } else {\n      this.showIIBB = false;\n      this.formClienTax.get('iibb')?.clearValidators();\n      this.formClienTax.get('iibb')?.updateValueAndValidity();\n      this.activateIIBBnumber('');\n    }\n  }\n\n  activateIIBBnumber(data: any) {\n    if (\n      data === 'inscriptoConvenioMultilateral' ||\n      data === 'inscriptoConvenioLocal'\n    ) {\n      //inscriptoExentoPercepcion\n      this.showiibbNumber = true;\n      this.formClienTax.get('iibbNumber')?.setValidators(Validators.required);\n    } else {\n      this.showiibbNumber = false;\n      this.formClienTax.get('iibbNumber')?.clearValidators();\n      this.formClienTax.get('iibbNumber')?.updateValueAndValidity();\n    }\n  }\n\n  updateConditionFiscal(fiscalCondition: any) {\n    this.storePolicy.dispatch(\n      new fromPolicyActions.SetCurrentFiscalConditionAction(\n        fiscalCondition.code\n      )\n    );\n  }\n\n  updateCrudIncomeType(type: string) {\n    this.storePolicy.dispatch(\n      new fromPolicyActions.SetCurrentCrudIncomeTypeAction(type)\n    );\n  }\n\n  continue() {\n    const iibbSavedContinue = this.formClienTax.get('iibb')?.value;\n    const iibbNumberSavedContinue = this.formClienTax.get('iibbNumber')?.value;\n    const conditionFiscalSavedContinue = this.currentPolicy.fiscalcondition;\n\n    if (conditionFiscalSavedContinue === 'inscriptoExentoPercepcion') {\n      const dateInit = this.formClienTax.get('beginningValidity')?.value;\n      const dateEnd = this.formClienTax.get('endingValidity')?.value;\n\n      let isoDatebeginningValidity =\n        dateInit.year + '-' + dateInit.month + '-' + dateInit.day;\n      isoDatebeginningValidity = new Date(\n        isoDatebeginningValidity\n      ).toISOString();\n\n      let isoDateendingValidity =\n        dateEnd.year + '-' + dateEnd.month + '-' + dateEnd.day;\n      isoDateendingValidity = new Date(isoDateendingValidity).toISOString();\n\n      const certificate = {\n        start: isoDatebeginningValidity,\n        end: isoDateendingValidity\n      };\n      this.storePolicy.dispatch(\n        new fromPolicyActions.SetCertificateAction(certificate)\n      );\n    }\n\n    this.storePolicy.dispatch(\n      new fromPolicyActions.SetCurrentCrudIncomeTypeAction(iibbSavedContinue)\n    );\n\n    this.storePolicy.dispatch(\n      new fromPolicyActions.SetCurrentCrudIncomeNumberAction(\n        iibbNumberSavedContinue\n      )\n    );\n\n    this.storePolicy.dispatch(\n      new fromPolicyActions.SetCurrentCrudIncomeClientAndInsuredAction({\n        code: iibbSavedContinue,\n        description: '',\n        type: iibbSavedContinue,\n        number: iibbNumberSavedContinue\n      })\n    );\n\n    // const fiscalConditionDescription = this.currentPolicy.fiscalconditionDesc;\n\n    //si es cliente nuevo, entonces le seteo por defecto la condicion fiscal\n    if (this.currentPolicy.client.contactid === null) {\n      this.storePolicy.dispatch(\n        new fromPolicyActions.SetCurrentFiscalConditionClientAndInsuredAction(\n          this.currentPolicy.fiscalcondition\n        )\n      );\n    }\n\n    this.flowRouteEmissionService.enableRoute(this.routes, 'validity');\n\n    this.storeEmission.dispatch(\n      new fromEmissionActions.SetActiveRoute('validity')\n    );\n\n    let iibbDescription = '';\n    if (this.showIIBB) {\n      iibbDescription = this.iibbSelect.getValue().description;\n    }\n\n    this.routes.forEach((element) => {\n      if (element.path === 'tax-condition') {\n        element.value =\n          this.arrayFiscalCondition.filter(\n            (f) => f.code === this.formClienTax.get('fiscalcondition')?.value\n          )[0].description +\n          ' ' +\n          iibbDescription;\n      }\n    });\n\n    if (this.formClienTax.valid) {\n      this.storeEmission.dispatch(\n        new fromEmissionActions.SetFormEmissionValidityIsValidAction(true)\n      );\n    }\n\n    this.flowRouteEmissionService.enableRoute(this.routes, 'validity');\n  }\n\n  closeModal() {\n    this.modalFiscal.closeModal();\n    this.callCost();\n  }\n\n  closeModalNewCosts() {\n    this.modalNewCosts.closeModal();\n  }\n\n  onEnter() {\n    if (this.formClienTax.valid) {\n      this.continue();\n    }\n  }\n\n  callCost() {\n    this.loadingCosts = true;\n    this.modalNewCosts.openModal();\n\n    this.storePolicy\n      .select(fromPolicy.getPolicyData)\n      .pipe(\n        first(),\n        switchMap((policy) => {\n          const adapted = this.policyAdapter.adapt(policy);\n\n          adapted.motor.vehicles?.forEach((v) => {\n            v.packages = <IPackage[]>v?.packages?.filter((p) => p.selected);\n          });\n\n          return this.quotingService.getCosts(adapted);\n        })\n      )\n      .subscribe((newCosts) => {\n        // Solo guardaré en costs la cotización del vehículo actual\n        const packageSelected = this.currentMotor?.packages?.find(\n          (p) => p.selected\n        );\n\n        this.storePolicy.dispatch(\n          new fromPolicyActions.UpdateCostsAction(\n            newCosts.costs?.filter((c: any) =>\n              c.externalId\n                .split('&')\n                .includes(\n                  `${this.currentPolicy.productcode},${this.currentMotor.number},${packageSelected?.code}`\n                )\n            )\n          )\n        );\n\n        this.vehicles.forEach((v) => {\n          // Actualizar premiums con el resultado de la nueva cotización\n          const selected = v?.packages?.find((p) => p.selected);\n\n          // Buscar error en motor.errors de este vehículo y paquete\n          const error = newCosts.motor.errors?.find((e: any) =>\n            e.externalId\n              .split('&')\n              .includes(\n                `${this.currentPolicy.productcode},${v.number},${selected?.code}`\n              )\n          );\n\n          // Busco los datos del paquete con la nueva cotización si existiera\n          const newPackage = newCosts.motor.vehicles\n            ?.find((costVehicle: any) => costVehicle.number === v.number)\n            ?.packages.find((p: any) => p.code === selected?.code);\n\n          if (!error?.code) {\n            if (selected) {\n              selected.premiums = newPackage?.premiums;\n            }\n            this.newQuote = newCosts.costs\n              ?.find((c: any) =>\n                c.externalId\n                  .split('&')\n                  .includes(\n                    `${this.currentPolicy.productcode},${v.number},${selected?.code}`\n                  )\n              )\n              .invoice.toString();\n            this.newQuote = <string>this.newQuote\n              ? parseFloat(this.newQuote).toFixed(2)\n              : '';\n          } else {\n            if (selected) {\n              selected.premiums = <IPremium>{};\n            }\n            this.newQuote = '';\n          }\n        });\n\n        this.storePolicy.dispatch(\n          new fromPolicyActions.UpdateVehicleAction(this.vehicles)\n        );\n\n        this.storeQuote.dispatch(\n          new fromQuoteActions.SetCostsResponseAction(newCosts)\n        );\n\n        this.loadingCosts = false;\n      });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Resolve } from '@angular/router';\nimport { Observable, of, combineLatest } from 'rxjs';\nimport { switchMap, first } from 'rxjs/operators';\nimport { Store } from '@ngrx/store';\nimport * as fromEmission from '../state';\nimport * as fromEmissionActions from '../state/emission.actions';\nimport * as fromPolicy from '../../../state/policy';\nimport * as fromPolicyActions from '../../../state/policy/policy.actions';\n\nimport {\n  AccountService,\n  QuotesService,\n  UtilService,\n  IVehicle,\n  IPayment,\n  IPolicy,\n  IOfficialIds,\n  IAccount,\n  VehicleGroup,\n  IPaymentPlan,\n  IAddress,\n  IDiscount,\n  ICost,\n  IMotorError\n} from '@sura-platform/features';\n\nimport * as moment from 'moment';\nimport { MOTOR_CONF } from '../../motor/motor.config';\n\n@Injectable()\nexport class QuoteResolver implements Resolve<Observable<any>> {\n  /**\n   * Current date and time of\n   * the server.\n   *\n   * @type {string}\n   * @memberof QuoteResolver\n   */\n  serverDate: string | null = null;\n\n  /**\n   * Flag used to detect if payment.period\n   * should be modified or not.\n   *\n   * @type {boolean}\n   * @memberof QuoteResolver\n   */\n  approved: boolean | null = null;\n\n  constructor(\n    private quotesService: QuotesService,\n    private accountService: AccountService,\n    private storeEmission: Store<fromEmission.State>,\n    private storePolicy: Store<fromPolicy.State>,\n    private utilService: UtilService\n  ) {}\n\n  resolve() {\n    return combineLatest([\n      this.storePolicy.select(fromPolicy.getJob),\n      this.storeEmission.select(fromEmission.getEmission),\n      this.utilService.getCurrentServerDate()\n    ]).pipe(\n      switchMap((x) => {\n        const jobFromPolicy = x[0].number;\n        const jobFromEmission = x[1].jobNumberFromQuotes;\n        this.serverDate = x[2].datetime;\n        this.approved = x[1].approvedEmission;\n\n        // Si no hay jobnumber en policy, entonces no cargo RETRIEVE\n        if (jobFromPolicy !== null) return of(true);\n\n        // Si no hay jobnumber en emission, entonces no cargo RETRIEVE\n        if (!jobFromEmission || jobFromEmission === '') return of(true);\n\n        // En caso de que haya jobnumber en emission entonces hago el RETRIEVE\n        return this.quotesService.getQuote(jobFromEmission).pipe(\n          switchMap(async (retrieve) => {\n            this.fillPolicyAttributes(retrieve);\n\n            // Si obtener información sobre el usuario en guidewire\n            const officialId = retrieve.client?.officialids?.find(\n              (id) => id.primary\n            );\n            await this.getAccountInfo(officialId as IOfficialIds, retrieve);\n\n            // ML: En Emission guardo el ID del policy.address\n            this.storeEmission.dispatch(\n              new fromEmissionActions.SetPolicyAddressFromQuotesAction(\n                retrieve.address as IAddress\n              )\n            );\n            return of(true);\n          })\n        );\n      }),\n      first()\n    );\n  }\n\n  private fillPolicyAttributes(policy: Partial<IPolicy>) {\n    // Jobtype\n    policy = {\n      ...policy,\n      job: {\n        ...policy?.job,\n        type: 'Submission'\n      } as {\n        number: string;\n        type: string;\n      }\n    };\n\n    // Completo los campos faltantes en retrieve para payment y paymentTerm\n    const payment: IPayment = {\n      method: null,\n      plan: {\n        code: null\n      },\n      cbu: {\n        alias: null,\n        conduit: null,\n        number: null\n      },\n      creditcard: {\n        expirationdate: null,\n        number: null,\n        type: null\n      },\n      id: null\n    };\n\n    const paymentTerm: IPaymentPlan = {\n      code: policy?.payment?.plan?.code as string,\n      description: null,\n      maximumnumberofinstallments: null\n    };\n\n    policy.payment = {\n      ...payment,\n      ...policy.payment\n    };\n\n    policy.paymentTerm = {\n      ...paymentTerm,\n      ...policy.paymentTerm\n    };\n\n    this.populatePeriod(policy);\n\n    // En policy agrego el document type y number del cliente\n    const officialid = policy?.client?.officialids?.find((id) => id.primary);\n\n    policy = {\n      ...policy,\n      client: {\n        ...policy.client,\n        documentNumber: officialid?.value as string,\n        documentType: officialid?.type as string\n      } as IAccount,\n      motor: {\n        ...policy.motor,\n        fleet: 'NonFleet',\n        vehicles: policy?.motor?.vehicles?.sort((a, b) => {\n          if (a.number && b.number) {\n            return a?.number - b?.number;\n          }\n          return a.number as number;\n        })\n      } as {\n        fleet: string;\n        vehicles: Array<IVehicle>;\n        discounts: IDiscount[];\n        commission: {\n          producer: number;\n        };\n        costs: ICost[];\n        errors?: Array<IMotorError>;\n      }\n    };\n\n    policy?.motor?.discounts?.forEach((discount) => {\n      discount.value = Math.abs(discount.value);\n    });\n\n    // Esto es para meter package dentro del arreglo packages\n    policy?.motor?.vehicles?.forEach((vehicle: Partial<IVehicle>) => {\n      // No tengo ID desde retrieve\n      vehicle.id = vehicle.number;\n\n      // ML: Sin estos campos en el objeto, falla en emission\n      vehicle.group = this.findVehicleGroup(vehicle?.model?.type as string);\n      vehicle.license = vehicle.license || null;\n\n      // Sumas aseguradas y base\n      vehicle.statedamount = vehicle.model?.statementamount;\n\n      if (!vehicle.zerokm && vehicle.model) {\n        vehicle.model.statementamount = vehicle.model.originalcostnew;\n        vehicle.model.originalcostnew = 0;\n      }\n\n      // Detectar si el conductor es el cliente\n      let clientIsDriver = false;\n      const driver = vehicle.driver;\n      const client = policy.client;\n\n      if (driver) {\n        if (\n          client?.firstname?.toLowerCase() ===\n            driver?.firstname?.toLowerCase() &&\n          client?.lastname?.toLowerCase() === driver?.lastname?.toLowerCase()\n        ) {\n          clientIsDriver = true;\n        }\n      }\n\n      vehicle.driver = {\n        firstname: null,\n        lastname: null,\n        birth: null,\n        gender: null,\n        clientIsDriver,\n        ...vehicle.driver\n      };\n\n      if (!vehicle.bondholder) {\n        vehicle.bondholder = {\n          finish: null,\n          firstinstallmentdue: null,\n          number: null,\n          quotas: null,\n          start: null,\n          type: null\n        };\n      } else {\n        vehicle.bondholder.type = Number(vehicle.bondholder.type);\n      }\n\n      if (vehicle.package) {\n        // Buscar la descripción del paquete en JSON\n        let pkgDescription = '';\n        MOTOR_CONF?.find(\n          (v) => v.vehicleType === vehicle.group\n        )?.package?.forEach((pkg) => {\n          pkg?.packages?.forEach((pkgs) => {\n            if (pkgs?.code === vehicle?.package?.code) {\n              // Este campo es necesario para identificar a qué grupo corresponde\n              // esta cotización\n              vehicle.package.group = pkg.code;\n\n              pkgDescription = pkgs.description;\n              return;\n            }\n          });\n        });\n        vehicle.package.description = pkgDescription;\n        vehicle.package.selected = true;\n        vehicle.package.externalid = `${vehicle.number}_${vehicle.package.code}`;\n\n        vehicle.packages = [];\n        vehicle.packages.push(vehicle.package);\n      }\n    });\n\n    this.storePolicy.dispatch(new fromPolicyActions.SetPolicyAction(policy));\n  }\n\n  private getAccountInfo(\n    officialid: IOfficialIds,\n    policy: Partial<IPolicy>\n  ): Promise<IAccount> {\n    const data: any = {\n      officialid\n    };\n\n    return new Promise((res, rej) => {\n      this.accountService.getAccounts(data).subscribe((account) => {\n        if (!account) {\n          const client = policy.client;\n\n          this.storeEmission.dispatch(\n            new fromEmissionActions.SetBasicDataForClientAction(\n              client?.type as string,\n              client?.companyname?.toUpperCase() as string,\n              client?.firstname?.toUpperCase() as string,\n              client?.lastname?.toUpperCase() as string,\n              client?.contactid as string,\n              client?.documentNumber as string,\n              client?.documentType as string,\n              client?.address as IAddress\n            )\n          );\n\n          return res();\n        }\n\n        account.documentNumber = officialid.value;\n        account.documentType = officialid.type;\n\n        if (policy?.client?.address?.id) {\n          const address = account?.addresses?.find(\n            (add) => add.id === policy?.client?.address?.id\n          );\n\n          account.address = address\n            ? address\n            : {\n                apartment: null,\n                city: null,\n                clarification: null,\n                floor: null,\n                id: null,\n                postalcode: null,\n                state: null,\n                street: null,\n                streetnumber: null,\n                type: null\n              };\n        }\n\n        this.storePolicy.dispatch(\n          new fromPolicyActions.SetClientDataAction(account)\n        );\n        this.storeEmission.dispatch(\n          new fromEmissionActions.SetClientData(account)\n        );\n        res(account);\n      }, rej);\n    });\n  }\n\n  /**\n   * Method used for find the vehicle group\n   *\n   * @private\n   * @param {string} type\n   * @returns {(VehicleGroup | null)}\n   * @memberof QuoteResolver\n   */\n  private findVehicleGroup(type: string): VehicleGroup | null {\n    return MOTOR_CONF.find((conf) => conf.types.includes(type))\n      ?.vehicleType as VehicleGroup | null;\n  }\n\n  /**\n   * Method used to change period properties\n   * when the policy does not come from\n   * an approved issue.\n   *\n   * @private\n   * @param {Partial<IPolicy>} policy\n   * @returns\n   * @memberof QuoteResolver\n   */\n  private populatePeriod(policy: Partial<IPolicy>) {\n    const currentDate = moment(this.serverDate);\n    let methodName: string;\n    let methodMonths: number;\n\n    if (this.approved) {\n      return;\n    }\n\n    if (!policy.period) {\n      policy.period = {\n        start: currentDate.toDate(),\n        end: null,\n        method: null,\n        rate: null\n      };\n\n      return;\n    }\n\n    switch (policy.period.method) {\n      case 'Sura_ThreeMonths':\n        methodName = 'Sura_ThreeMonths';\n        methodMonths = 3;\n        break;\n\n      default:\n        methodName = 'Sura_ThreeMonths';\n        methodMonths = 3;\n    }\n\n    const start = currentDate.toDate();\n    const end = currentDate.clone().add(methodMonths, 'months').toDate();\n\n    policy.period = {\n      start,\n      end,\n      method: methodName,\n      rate: undefined\n    };\n  }\n}\n","import { Routes, RouterModule } from '@angular/router';\nimport { NgModule } from '@angular/core';\nimport { StoreModule } from '@ngrx/store';\nimport { emissionReducer } from './state/emission.reducer';\nimport { EmissionComponent } from './emission.component';\n\nimport {\n  EmissionQuestionsComponent,\n  ValidityComponent,\n  PaymentMethodComponent,\n  ClientTaxConditionComponent\n} from './components';\nimport { ClientDataComponent } from '../../../client/components/client-data/client-data.component';\nimport { ClientResidenceComponent } from '../../../client/components/client-residence/client-residence.component';\nimport { OthersMotorComponent } from '../motor/components/others/others.component';\nimport { QuoteResolver } from './services/quote.resolver';\nimport JSON_CONF from '../motor/motor.config.json';\nimport { IMotorConfiguration } from '../motor/motor.config';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: EmissionComponent,\n    resolve: { data: QuoteResolver },\n    children: [\n      {\n        path: 'questions',\n        component: EmissionQuestionsComponent,\n        children: [\n          {\n            path: 'client',\n            component: ClientDataComponent,\n            data: {\n              question: 'Algunos datos más de tu cliente',\n              show: true,\n              disabled: false,\n              value: '',\n              shortName: 'Cliente',\n              config: <IMotorConfiguration>JSON_CONF\n            }\n          },\n          {\n            path: 'residence',\n            component: ClientResidenceComponent,\n            data: {\n              question: '¿Cual es tu domicilio?',\n              show: true,\n              disabled: true,\n              value: '',\n              shortName: '¿Este es el domicilio fiscal?'\n            }\n          },\n          {\n            path: 'tax-condition',\n            component: ClientTaxConditionComponent,\n            data: {\n              question: '¿Cuál es la condición fiscal?',\n              show: true,\n              disabled: true,\n              value: '',\n              shortName: 'Condicion fiscal'\n            }\n          },\n          {\n            path: 'validity',\n            component: ValidityComponent,\n            data: {\n              question: '¿Cuál es el inicio de vigencia?',\n              show: true,\n              disabled: true,\n              value: '',\n              shortName: 'Inicio de vigencia'\n            }\n          },\n          {\n            path: 'aditionalauto/:id',\n            component: OthersMotorComponent,\n            data: {\n              question: '¿Cuál es le número de chasis y de motor?',\n              show: true,\n              disabled: true,\n              value: '',\n              shortName: 'Chasis y motor'\n            }\n          },\n          {\n            path: 'payment-method',\n            component: PaymentMethodComponent,\n            data: {\n              question: '¿Cómo lo quiere pagar?',\n              show: true,\n              disabled: true,\n              value: '',\n              shortName: 'payment'\n            }\n          }\n        ]\n      }\n    ]\n  }\n];\n\n@NgModule({\n  imports: [\n    RouterModule.forChild(routes),\n    StoreModule.forFeature('emission', emissionReducer)\n  ],\n  exports: [RouterModule],\n  providers: []\n})\nexport class EmissionRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { EmissionRoutingModule } from './emission-routing.routing';\nimport { SharedModule } from '../../../shared/shared.module';\nimport { PeriodMethodPipe, CardNumberPipe } from '@sura-platform/core';\nimport { EMISSION_COMPONENTS } from './components';\nimport { LottieModule } from 'ngx-lottie';\nimport {\n  GenderService,\n  IdentificationService,\n  DocumentationService,\n  AccountService,\n  NationalityService,\n  AddressTypeService,\n  MaritalStatusService,\n  ClienteNService,\n  PatentBlackListService,\n  QuotesService,\n  PatentUseService,\n  BondholderService\n} from '@sura-platform/features';\nimport { FlowRouteEmissionService } from './services/flow-route-emission.service';\nimport { QuoteResolver } from './services/quote.resolver';\n\nexport function playerFactory() {\n  return import('lottie-web');\n}\n@NgModule({\n  imports: [\n    SharedModule,\n    EmissionRoutingModule,\n    LottieModule.forRoot({ player: playerFactory })\n  ],\n  exports: [...EMISSION_COMPONENTS],\n  declarations: [EMISSION_COMPONENTS],\n  providers: [\n    GenderService,\n    IdentificationService,\n    DocumentationService,\n    FlowRouteEmissionService,\n    AccountService,\n    NationalityService,\n    PeriodMethodPipe,\n    CardNumberPipe,\n    AddressTypeService,\n    MaritalStatusService,\n    ClienteNService,\n    PatentBlackListService,\n    QuoteResolver,\n    QuotesService,\n    PatentUseService,\n    BondholderService\n  ]\n})\nexport class EmissionModule { }\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar subscribeToArray_1 = require(\"./subscribeToArray\");\nvar subscribeToPromise_1 = require(\"./subscribeToPromise\");\nvar subscribeToIterable_1 = require(\"./subscribeToIterable\");\nvar subscribeToObservable_1 = require(\"./subscribeToObservable\");\nvar isArrayLike_1 = require(\"./isArrayLike\");\nvar isPromise_1 = require(\"./isPromise\");\nvar isObject_1 = require(\"./isObject\");\nvar iterator_1 = require(\"../symbol/iterator\");\nvar observable_1 = require(\"../symbol/observable\");\nexports.subscribeTo = function (result) {\n    if (!!result && typeof result[observable_1.observable] === 'function') {\n        return subscribeToObservable_1.subscribeToObservable(result);\n    }\n    else if (isArrayLike_1.isArrayLike(result)) {\n        return subscribeToArray_1.subscribeToArray(result);\n    }\n    else if (isPromise_1.isPromise(result)) {\n        return subscribeToPromise_1.subscribeToPromise(result);\n    }\n    else if (!!result && typeof result[iterator_1.iterator] === 'function') {\n        return subscribeToIterable_1.subscribeToIterable(result);\n    }\n    else {\n        var value = isObject_1.isObject(result) ? 'an invalid object' : \"'\" + result + \"'\";\n        var msg = \"You provided \" + value + \" where a stream was expected.\"\n            + ' You can provide an Observable, Promise, Array, or Iterable.';\n        throw new TypeError(msg);\n    }\n};\n//# sourceMappingURL=subscribeTo.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.observable = (function () { return typeof Symbol === 'function' && Symbol.observable || '@@observable'; })();\n//# sourceMappingURL=observable.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar InnerSubscriber_1 = require(\"../InnerSubscriber\");\nvar subscribeTo_1 = require(\"./subscribeTo\");\nvar Observable_1 = require(\"../Observable\");\nfunction subscribeToResult(outerSubscriber, result, outerValue, outerIndex, innerSubscriber) {\n    if (innerSubscriber === void 0) { innerSubscriber = new InnerSubscriber_1.InnerSubscriber(outerSubscriber, outerValue, outerIndex); }\n    if (innerSubscriber.closed) {\n        return undefined;\n    }\n    if (result instanceof Observable_1.Observable) {\n        return result.subscribe(innerSubscriber);\n    }\n    return subscribeTo_1.subscribeTo(result)(innerSubscriber);\n}\nexports.subscribeToResult = subscribeToResult;\n//# sourceMappingURL=subscribeToResult.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar hostReportError_1 = require(\"./hostReportError\");\nexports.subscribeToPromise = function (promise) { return function (subscriber) {\n    promise.then(function (value) {\n        if (!subscriber.closed) {\n            subscriber.next(value);\n            subscriber.complete();\n        }\n    }, function (err) { return subscriber.error(err); })\n        .then(null, hostReportError_1.hostReportError);\n    return subscriber;\n}; };\n//# sourceMappingURL=subscribeToPromise.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar canReportError_1 = require(\"./util/canReportError\");\nvar toSubscriber_1 = require(\"./util/toSubscriber\");\nvar observable_1 = require(\"./symbol/observable\");\nvar pipe_1 = require(\"./util/pipe\");\nvar config_1 = require(\"./config\");\nvar Observable = (function () {\n    function Observable(subscribe) {\n        this._isScalar = false;\n        if (subscribe) {\n            this._subscribe = subscribe;\n        }\n    }\n    Observable.prototype.lift = function (operator) {\n        var observable = new Observable();\n        observable.source = this;\n        observable.operator = operator;\n        return observable;\n    };\n    Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n        var operator = this.operator;\n        var sink = toSubscriber_1.toSubscriber(observerOrNext, error, complete);\n        if (operator) {\n            sink.add(operator.call(sink, this.source));\n        }\n        else {\n            sink.add(this.source || (config_1.config.useDeprecatedSynchronousErrorHandling && !sink.syncErrorThrowable) ?\n                this._subscribe(sink) :\n                this._trySubscribe(sink));\n        }\n        if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n            if (sink.syncErrorThrowable) {\n                sink.syncErrorThrowable = false;\n                if (sink.syncErrorThrown) {\n                    throw sink.syncErrorValue;\n                }\n            }\n        }\n        return sink;\n    };\n    Observable.prototype._trySubscribe = function (sink) {\n        try {\n            return this._subscribe(sink);\n        }\n        catch (err) {\n            if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n                sink.syncErrorThrown = true;\n                sink.syncErrorValue = err;\n            }\n            if (canReportError_1.canReportError(sink)) {\n                sink.error(err);\n            }\n            else {\n                console.warn(err);\n            }\n        }\n    };\n    Observable.prototype.forEach = function (next, promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var subscription;\n            subscription = _this.subscribe(function (value) {\n                try {\n                    next(value);\n                }\n                catch (err) {\n                    reject(err);\n                    if (subscription) {\n                        subscription.unsubscribe();\n                    }\n                }\n            }, reject, resolve);\n        });\n    };\n    Observable.prototype._subscribe = function (subscriber) {\n        var source = this.source;\n        return source && source.subscribe(subscriber);\n    };\n    Observable.prototype[observable_1.observable] = function () {\n        return this;\n    };\n    Observable.prototype.pipe = function () {\n        var operations = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            operations[_i] = arguments[_i];\n        }\n        if (operations.length === 0) {\n            return this;\n        }\n        return pipe_1.pipeFromArray(operations)(this);\n    };\n    Observable.prototype.toPromise = function (promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var value;\n            _this.subscribe(function (x) { return value = x; }, function (err) { return reject(err); }, function () { return resolve(value); });\n        });\n    };\n    Observable.create = function (subscribe) {\n        return new Observable(subscribe);\n    };\n    return Observable;\n}());\nexports.Observable = Observable;\nfunction getPromiseCtor(promiseCtor) {\n    if (!promiseCtor) {\n        promiseCtor = config_1.config.Promise || Promise;\n    }\n    if (!promiseCtor) {\n        throw new Error('no Promise impl found');\n    }\n    return promiseCtor;\n}\n//# sourceMappingURL=Observable.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.subscribeToArray = function (array) { return function (subscriber) {\n    for (var i = 0, len = array.length; i < len && !subscriber.closed; i++) {\n        subscriber.next(array[i]);\n    }\n    subscriber.complete();\n}; };\n//# sourceMappingURL=subscribeToArray.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction hostReportError(err) {\n    setTimeout(function () { throw err; }, 0);\n}\nexports.hostReportError = hostReportError;\n//# sourceMappingURL=hostReportError.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Observable_1 = require(\"../Observable\");\nvar Subscription_1 = require(\"../Subscription\");\nfunction scheduleArray(input, scheduler) {\n    return new Observable_1.Observable(function (subscriber) {\n        var sub = new Subscription_1.Subscription();\n        var i = 0;\n        sub.add(scheduler.schedule(function () {\n            if (i === input.length) {\n                subscriber.complete();\n                return;\n            }\n            subscriber.next(input[i++]);\n            if (!subscriber.closed) {\n                sub.add(this.schedule());\n            }\n        }));\n        return sub;\n    });\n}\nexports.scheduleArray = scheduleArray;\n//# sourceMappingURL=scheduleArray.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar config_1 = require(\"./config\");\nvar hostReportError_1 = require(\"./util/hostReportError\");\nexports.empty = {\n    closed: true,\n    next: function (value) { },\n    error: function (err) {\n        if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n            throw err;\n        }\n        else {\n            hostReportError_1.hostReportError(err);\n        }\n    },\n    complete: function () { }\n};\n//# sourceMappingURL=Observer.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction isFunction(x) {\n    return typeof x === 'function';\n}\nexports.isFunction = isFunction;\n//# sourceMappingURL=isFunction.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction isPromise(value) {\n    return !!value && typeof value.subscribe !== 'function' && typeof value.then === 'function';\n}\nexports.isPromise = isPromise;\n//# sourceMappingURL=isPromise.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar isScheduler_1 = require(\"../util/isScheduler\");\nvar isArray_1 = require(\"../util/isArray\");\nvar OuterSubscriber_1 = require(\"../OuterSubscriber\");\nvar subscribeToResult_1 = require(\"../util/subscribeToResult\");\nvar fromArray_1 = require(\"./fromArray\");\nvar NONE = {};\nfunction combineLatest() {\n    var observables = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        observables[_i] = arguments[_i];\n    }\n    var resultSelector = null;\n    var scheduler = null;\n    if (isScheduler_1.isScheduler(observables[observables.length - 1])) {\n        scheduler = observables.pop();\n    }\n    if (typeof observables[observables.length - 1] === 'function') {\n        resultSelector = observables.pop();\n    }\n    if (observables.length === 1 && isArray_1.isArray(observables[0])) {\n        observables = observables[0];\n    }\n    return fromArray_1.fromArray(observables, scheduler).lift(new CombineLatestOperator(resultSelector));\n}\nexports.combineLatest = combineLatest;\nvar CombineLatestOperator = (function () {\n    function CombineLatestOperator(resultSelector) {\n        this.resultSelector = resultSelector;\n    }\n    CombineLatestOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new CombineLatestSubscriber(subscriber, this.resultSelector));\n    };\n    return CombineLatestOperator;\n}());\nexports.CombineLatestOperator = CombineLatestOperator;\nvar CombineLatestSubscriber = (function (_super) {\n    __extends(CombineLatestSubscriber, _super);\n    function CombineLatestSubscriber(destination, resultSelector) {\n        var _this = _super.call(this, destination) || this;\n        _this.resultSelector = resultSelector;\n        _this.active = 0;\n        _this.values = [];\n        _this.observables = [];\n        return _this;\n    }\n    CombineLatestSubscriber.prototype._next = function (observable) {\n        this.values.push(NONE);\n        this.observables.push(observable);\n    };\n    CombineLatestSubscriber.prototype._complete = function () {\n        var observables = this.observables;\n        var len = observables.length;\n        if (len === 0) {\n            this.destination.complete();\n        }\n        else {\n            this.active = len;\n            this.toRespond = len;\n            for (var i = 0; i < len; i++) {\n                var observable = observables[i];\n                this.add(subscribeToResult_1.subscribeToResult(this, observable, observable, i));\n            }\n        }\n    };\n    CombineLatestSubscriber.prototype.notifyComplete = function (unused) {\n        if ((this.active -= 1) === 0) {\n            this.destination.complete();\n        }\n    };\n    CombineLatestSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        var values = this.values;\n        var oldVal = values[outerIndex];\n        var toRespond = !this.toRespond\n            ? 0\n            : oldVal === NONE ? --this.toRespond : this.toRespond;\n        values[outerIndex] = innerValue;\n        if (toRespond === 0) {\n            if (this.resultSelector) {\n                this._tryResultSelector(values);\n            }\n            else {\n                this.destination.next(values.slice());\n            }\n        }\n    };\n    CombineLatestSubscriber.prototype._tryResultSelector = function (values) {\n        var result;\n        try {\n            result = this.resultSelector.apply(this, values);\n        }\n        catch (err) {\n            this.destination.error(err);\n            return;\n        }\n        this.destination.next(result);\n    };\n    return CombineLatestSubscriber;\n}(OuterSubscriber_1.OuterSubscriber));\nexports.CombineLatestSubscriber = CombineLatestSubscriber;\n//# sourceMappingURL=combineLatest.js.map"]}